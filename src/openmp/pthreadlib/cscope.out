cscope 15 $HOME/nautilus/src/openmp/pthreadlib               0000141427
	@cleanup.c

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

55 
±e_ş—nup_t
 *

56 
	$±e_pİ_ş—nup
 (
execu‹
)

82 
±e_ş—nup_t
 *
ş—nup
;

84 
ş—nup
 = (
±e_ş—nup_t
 *è
	`±h»ad_g‘¥ecific
 (
±e_ş—nupKey
);

86 ià(
ş—nup
 !ğ
NULL
)

88 ià(
execu‹
 && (
ş—nup
->
routše
 !ğ
NULL
))

91 (*
ş—nup
->
routše
è(ş—nup->
¬g
);

95 
	`±h»ad_£t¥ecific
 (
±e_ş—nupKey
, (*è
ş—nup
->
´ev
);

99  (
ş—nup
);

101 
	}
}

105 
	$±e_push_ş—nup
 (
±e_ş—nup_t
 * 
ş—nup
,

106 
±e_ş—nup_ÿÎback_t
 
routše
, *
¬g
)

147 
ş—nup
->
routše
 =„outine;

148 
ş—nup
->
¬g
 =‡rg;

150 
ş—nup
->
´ev
 = (
±e_ş—nup_t
 *è
	`±h»ad_g‘¥ecific
 (
±e_ş—nupKey
);

152 
	`±h»ad_£t¥ecific
 (
±e_ş—nupKey
, (*è
ş—nup
);

154 
	}
}

	@create.c

44 
	~"nk/±e_o§l.h
"

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

47 
	~<Çutus/Çutus.h
>

50 
	$±h»ad_ü—‹
 (
±h»ad_t
 * 
tid
,

51 cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

52 *(*
¡¬t
è(*), *
¬g
)

91 
±h»ad_t
 
th»ad
;

92 
±e_th»ad_t
 * 

;

93 
±h»ad_©Œ_t
 
a
;

94 
»suÉ
 = 
EAGAIN
;

95 
run
 = 
PTE_TRUE
;

96 
Th»adP¬ms
 *
·rms
 = 
NULL
;

97 
¡ackSize
;

98 
´iÜ™y
 = 0;

99 
±h»ad_t
 
£lf
;

100 
±e_osResuÉ
 
osResuÉ
;

108 ià(
tid
 !ğ
NULL
)

110 
tid
->
x
 = 0;

113 ià(
©Œ
 !ğ
NULL
)

115 
a
 = *
©Œ
;

119 
a
 = 
NULL
;

122 ià((
th»ad
 = 
	`±e_Ãw
 ()).
p
 =ğ
NULL
)

124 
FAIL0
;

127 

 = (
±e_th»ad_t
 *è
th»ad
.
p
;

129 
´iÜ™y
 = 

->
sched_´iÜ™y
;

131 ià((
·rms
 = (
Th»adP¬ms
 *è
	`m®loc
 ( (*·rms))è=ğ
NULL
)

133 
FAIL0
;

136 
·rms
->
tid
 = 
th»ad
;

137 
·rms
->
¡¬t
 = start;

138 
·rms
->
¬g
 =‡rg;

143 ià(
a
 !ğ
NULL
)

145 
¡ackSize
 = 
a
->
¡acksize
;

146 

->
d‘achS‹
 = 
a
->
d‘ach¡©e
;

147 
´iÜ™y
 = 
a
->
·¿m
.
sched_´iÜ™y
;

149 iàĞ(
´iÜ™y
 > 
	`±e_osTh»adG‘MaxPriÜ™y
()) ||

150 (
´iÜ™y
 < 
	`±e_osTh»adG‘MšPriÜ™y
()) )

152 
»suÉ
 = 
EINVAL
;

153 
FAIL0
;

163 ià(
PTHREAD_INHERIT_SCHED
 =ğ
a
->
šh”™sched
)

170 
£lf
 = 
	`±h»ad_£lf
 ();

171 
´iÜ™y
 = ((
±e_th»ad_t
 *è
£lf
.
p
)->
sched_´iÜ™y
;

181 
¡ackSize
 = 
PTHREAD_STACK_MIN
;

185 

->
¡©e
 = 
run
 ? 
PTh»adS‹In™Ÿl
 : 
PTh»adS‹Su¥’ded
;

187 

->
keys
 = 
NULL
;

197 
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&

->
th»adLock
);

199 ià(0 =ğ
»suÉ
)

205 

->
sched_´iÜ™y
 = 
´iÜ™y
;

207 (è
	`±h»ad_mu‹x_uÆock
 (&

->
th»adLock
);

211 
osResuÉ
 = 
	`±e_osTh»adC»©e
(&
±e_th»adS¹
,

212 
¡ackSize
,

213 
´iÜ™y
,

214 
·rms
,

215 &(

->
th»adId
));

217 ià(
osResuÉ
 =ğ
PTE_OS_OK
)

219 
	`±e_osTh»adS¹
(

->
th»adId
);

220 
»suÉ
 = 0;

224 

->
th»adId
 = 0;

225 
»suÉ
 = 
EAGAIN
;

226 
FAIL0
;

239 
FAIL0
:

240 ià(
»suÉ
 != 0)

243 
	`±e_th»adDe¡roy
 (
th»ad
);

244 

 = 
NULL
;

246 ià(
·rms
 !ğ
NULL
)

248 
	`ä“
 (
·rms
);

253 ià(
tid
 !ğ
NULL
)

255 *
tid
 = 
th»ad
;

259  (
»suÉ
);

261 
	}
}

	@global.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

48 
	g±e_´oûssIn™Ÿlized
 = 
PTE_FALSE
;

49 
±e_th»ad_t
 * 
	g±e_th»adReu£Tİ
 = 
PTE_THREAD_REUSE_EMPTY
;

50 
±e_th»ad_t
 * 
	g±e_th»adReu£BÙtom
 = 
PTE_THREAD_REUSE_EMPTY
;

51 
±h»ad_key_t
 
	g±e_£lfTh»adKey
 = 
NULL
;

52 
±h»ad_key_t
 
	g±e_ş—nupKey
 = 
NULL
;

53 
±h»ad_cÚd_t
 
	g±e_cÚd_li¡_h—d
 = 
NULL
;

54 
±h»ad_cÚd_t
 
	g±e_cÚd_li¡_
 = 
NULL
;

56 
	g±e_cÚcu¼’cy
 = 0;

59 
	g±e_ã©u»s
 = 0;

61 
	g±e_smp_sy¡em
 = 
PTE_TRUE
;

66 
±e_osMu‹xHªdË
 
	g±e_th»ad_»u£_lock
;

71 
±e_osMu‹xHªdË
 
	g±e_mu‹x_‹¡_š™_lock
;

77 
±e_osMu‹xHªdË
 
	g±e_cÚd_‹¡_š™_lock
;

83 
±e_osMu‹xHªdË
 
	g±e_rwlock_‹¡_š™_lock
;

89 
±e_osMu‹xHªdË
 
	g±e_¥šlock_‹¡_š™_lock
;

96 
±e_osMu‹xHªdË
 
	g±e_cÚd_li¡_lock
;

	@implement.h

51 #iâdeà
_IMPLEMENT_H


52 
	#_IMPLEMENT_H


	)

54 
	~"nk/±e_o§l.h
"

57 
	~"£m­hÜe.h
"

58 
	~"sched.h
"

68 
	mPTh»adS‹In™Ÿl
 = 0,

69 
	mPTh»adS‹RuÂšg
,

70 
	mPTh»adS‹Su¥’ded
,

71 
	mPTh»adS‹CªûlP’dšg
,

73 
	mPTh»adS‹Cªûlšg
,

76 
	mPTh»adS‹Exû±iÚ
,

78 
	mPTh»adS‹La¡


80 
	tPTh»adS‹
;

83 
±e_th»ad_t_
 
	t±e_th»ad_t
;

85 
	s±e_th»ad_t_


87 
±e_osTh»adHªdË
 
	mth»adId
;

88 
±h»ad_t
 
	m±HªdË
;

89 
±e_th»ad_t
 * 
	m´evReu£
;

90 vŞ©
PTh»adS‹
 
	m¡©e
;

91 *
	mex™Stus
;

92 *
	m·rms
;

93 
	m±E¼no
;

94 
	md‘achS‹
;

95 
±h»ad_mu‹x_t
 
	mth»adLock
;

96 
	msched_´iÜ™y
;

97 
±h»ad_mu‹x_t
 
	mÿnûlLock
;

98 
	mÿnûlS‹
;

99 
	mÿnûlTy³
;

100 
	mÿnûlEv’t
;

101 #ifdeà
PTE_CLEANUP_C


102 
jmp_buf
 
	m¡¬t_m¬k
;

104 
	mim¶ic™
:

106 *
	mkeys
;

107 *
	mÃxtAssoc
;

114 
	#PTE_ATTR_VALID
 ((è0xC4C0FFEE)

	)

116 
	s±h»ad_©Œ_t_


118 
	mv®id
;

119 *
	m¡ackaddr
;

120 
size_t
 
	m¡acksize
;

121 
	md‘ach¡©e
;

122 
sched_·¿m
 
	m·¿m
;

123 
	mšh”™sched
;

124 
	mcÚ‹ÁiÚscİe
;

136 
	s£m_t_


138 
	mv®ue
;

139 
±h»ad_mu‹x_t
 
	mlock
;

140 
±e_osSem­hÜeHªdË
 
	m£m
;

143 
	#PTE_OBJECT_AUTO_INIT
 ((*è-1)

	)

144 
	#PTE_OBJECT_INVALID
 0

	)

146 
	s±h»ad_mu‹x_t_


148 
±e_osSem­hÜeHªdË
 
	mhªdË
;

149 
	mlock_idx
;

156 
	m»cursive_couÁ
;

159 
	mkšd
;

160 
±h»ad_t
 
	mowÃrTh»ad
;

163 
	s±h»ad_mu‹x©Œ_t_


165 
	mpsh¬ed
;

166 
	mkšd
;

186 
	#PTE_SPIN_UNLOCKED
 (1)

	)

187 
	#PTE_SPIN_LOCKED
 (2)

	)

188 
	#PTE_SPIN_USE_MUTEX
 (3)

	)

190 
	s±h»ad_¥šlock_t_


192 
	mš‹¾ock
;

195 
	mıus
;

196 
±h»ad_mu‹x_t
 
	mmu‹x
;

197 } 
	mu
;

200 
	s±h»ad_b¬r›r_t_


202 
	mnCu¼’tB¬r›rHeight
;

203 
	mnIn™ŸlB¬r›rHeight
;

204 
	miS‹p
;

205 
	mpsh¬ed
;

206 
£m_t
 
	m£mB¬r›rB»eched
[2];

209 
	s±h»ad_b¬r›¿‰r_t_


211 
	mpsh¬ed
;

214 
	s±h»ad_key_t_


216 
	mkey
;

217 (*
	mde¡ruùÜ
) (*);

218 
±h»ad_mu‹x_t
 
	mkeyLock
;

219 *
	mth»ads
;

223 
Th»adP¬ms
 
	tTh»adP¬ms
;

224 
Th»adKeyAssoc
 
	tTh»adKeyAssoc
;

226 
	sTh»adP¬ms


228 
±h»ad_t
 
	mtid
;

229 *(*
	m¡¬t
) (*);

230 *
	m¬g
;

233 
	s±h»ad_cÚd_t_


235 
	mnWa™”sBlocked
;

236 
	mnWa™”sGÚe
;

237 
	mnWa™”sToUnblock
;

238 
£m_t
 
	m£mBlockQueue
;

240 
£m_t
 
	m£mBlockLock
;

243 
±h»ad_mu‹x_t
 
	mmtxUnblockLock
;

246 
±h»ad_cÚd_t
 
	mÃxt
;

247 
±h»ad_cÚd_t
 
	m´ev
;

251 
	s±h»ad_cÚd©Œ_t_


253 
	mpsh¬ed
;

256 
	#PTE_RWLOCK_MAGIC
 0xçÿde2

	)

258 
	s±h»ad_rwlock_t_


260 
±h»ad_mu‹x_t
 
	mmtxExşusiveAcûss
;

261 
±h»ad_mu‹x_t
 
	mmtxSh¬edAcûssCom¶‘ed
;

262 
±h»ad_cÚd_t
 
	múdSh¬edAcûssCom¶‘ed
;

263 
	mnSh¬edAcûssCouÁ
;

264 
	mnExşusiveAcûssCouÁ
;

265 
	mnCom¶‘edSh¬edAcûssCouÁ
;

266 
	mnMagic
;

269 
	s±h»ad_rwlock©Œ_t_


271 
	mpsh¬ed
;

277 
	s±e_mcs_node_t_


279 
±e_mcs_node_t_
 **
	mlock
;

280 
±e_mcs_node_t_
 *
	mÃxt
;

281 
	m»adyFÏg
;

283 
	mÃxtFÏg
;

287 
±e_mcs_node_t_
 
	t±e_mcs_loÿl_node_t
;

288 
±e_mcs_node_t_
 *
	t±e_mcs_lock_t
;

291 
	sTh»adKeyAssoc


391 
±e_th»ad_t
 * 
	mth»ad
;

392 
±h»ad_key_t
 
	mkey
;

393 
Th»adKeyAssoc
 *
	mÃxtKey
;

394 
Th»adKeyAssoc
 *
	mÃxtTh»ad
;

395 
Th»adKeyAssoc
 *
	m´evKey
;

396 
Th»adKeyAssoc
 *
	m´evTh»ad
;

405 
	#PTE_EPS_EXIT
 (1)

	)

406 
	#PTE_EPS_CANCEL
 (2)

	)

410 
	#PTE_MAX
(
a
,
b
è(×)<(b)?(b):×))

	)

411 
	#PTE_MIN
(
a
,
b
è(×)>(b)?(b):×))

	)

415 
	#PTE_THREAD_REUSE_EMPTY
 ((
±e_th»ad_t
 *è1)

	)

417 
±e_´oûssIn™Ÿlized
;

418 
±e_th»ad_t
 * 
±e_th»adReu£Tİ
;

419 
±e_th»ad_t
 * 
±e_th»adReu£BÙtom
;

420 
±h»ad_key_t
 
±e_£lfTh»adKey
;

421 
±h»ad_key_t
 
±e_ş—nupKey
;

422 
±h»ad_cÚd_t
 
±e_cÚd_li¡_h—d
;

423 
±h»ad_cÚd_t
 
±e_cÚd_li¡_
;

425 
±e_mu‹x_deçuÉ_kšd
;

427 
±e_cÚcu¼’cy
;

429 
±e_ã©u»s
;

431 
±e_osMu‹xHªdË
 
±e_th»ad_»u£_lock
;

432 
±e_osMu‹xHªdË
 
±e_mu‹x_‹¡_š™_lock
;

433 
±e_osMu‹xHªdË
 
±e_cÚd_li¡_lock
;

434 
±e_osMu‹xHªdË
 
±e_cÚd_‹¡_š™_lock
;

435 
±e_osMu‹xHªdË
 
±e_rwlock_‹¡_š™_lock
;

436 
±e_osMu‹xHªdË
 
±e_¥šlock_‹¡_š™_lock
;

439 #ifdeà
__ılu¥lus


452 
±e_is_©Œ
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
);

454 
±e_cÚd_check_Ãed_š™
 (
±h»ad_cÚd_t
 * 
cÚd
);

455 
±e_mu‹x_check_Ãed_š™
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

456 
±e_rwlock_check_Ãed_š™
 (
±h»ad_rwlock_t
 * 
rwlock
);

457 
±e_¥šlock_check_Ãed_š™
 (
±h»ad_¥šlock_t
 * 
lock
);

459 
±e_´oûssIn™Ÿlize
 ();

461 
±e_´oûssT”mš©e
 ();

463 
±e_th»adDe¡roy
 (
±h»ad_t
 
tid
);

464 
±e_th»adEx™AndDe¡roy
 (
±h»ad_t
 
tid
);

466 
±e_pİ_ş—nup_®l
 (
execu‹
);

468 
±h»ad_t
 
±e_Ãw
 ();

470 
±h»ad_t
 
±e_th»adReu£Pİ
 ();

472 
±e_th»adReu£Push
 (
±h»ad_t
 
th»ad
);

474 
±e_g‘´oûssÜs
 (*
couÁ
);

476 
±e_£‰h»ad´iÜ™y
 (
±h»ad_t
 
th»ad
, 
pŞicy
, 
´iÜ™y
);

478 
±e_rwlock_ÿnûlwrwa™
 (*
¬g
);

481 
±e_th»adS¹
 (*
vth»adP¬ms
, ** 
out
);

483 
±e_ÿÎU£rDe¡royRoutšes
 (
±h»ad_t
 
th»ad
);

485 
±e_tkAssocC»©e
 (
±e_th»ad_t
 * 
th»ad
, 
±h»ad_key_t
 
key
);

487 
±e_tkAssocDe¡roy
 (
Th»adKeyAssoc
 * 
assoc
);

489 
£m_wa™_noÿnûl
 (
£m_t
 * 
£m
);

491 
±e_»lmli£cs
 (cÚ¡ 
time¥ec
 * 
ab¡ime
);

493 
±e_mcs_lock_acquœe
 (
±e_mcs_lock_t
 * 
lock
, 
±e_mcs_loÿl_node_t
 * 
node
);

495 
±e_mcs_lock_»Ëa£
 (
±e_mcs_loÿl_node_t
 * 
node
);

498 
±e_throw
 (
exû±iÚ
);

500 
±e_ÿnûÎabË_wa™
 (
±e_osSem­hÜeHªdË
 
£mHªdË
, * 
timeout
);

502 
	#PTE_ATOMIC_EXCHANGE
 
±e_osAtomicExchªge


	)

503 
	#PTE_ATOMIC_EXCHANGE_ADD
 
±e_osAtomicExchªgeAdd


	)

504 
	#PTE_ATOMIC_COMPARE_EXCHANGE
 
±e_osAtomicCom·»Exchªge


	)

505 
	#PTE_ATOMIC_DECREMENT
 
±e_osAtomicDeüem’t


	)

506 
	#PTE_ATOMIC_INCREMENT
 
±e_osAtomicInüem’t


	)

508 
±e_th»ad_d‘ach_Å
();

509 
±e_th»ad_d‘ach_ªd_ex™_Å
();

512 #ifdeà
__ılu¥lus


	@need_errno.h

16 #iâdeà
_INC_ERRNO


17 
	#_INC_ERRNO


	)

19 #ifdeà 
__ılu¥lus


28 
”ºo
;

32 
	#EPERM
 1

	)

33 
	#ENOENT
 2

	)

34 
	#ESRCH
 3

	)

35 
	#EINTR
 4

	)

36 
	#EIO
 5

	)

37 
	#ENXIO
 6

	)

38 
	#E2BIG
 7

	)

39 
	#ENOEXEC
 8

	)

40 
	#EBADF
 9

	)

41 
	#ECHILD
 10

	)

42 
	#EAGAIN
 11

	)

43 
	#ENOMEM
 12

	)

44 
	#EACCES
 13

	)

45 
	#EFAULT
 14

	)

46 
	#EBUSY
 16

	)

47 
	#EEXIST
 17

	)

48 
	#EXDEV
 18

	)

49 
	#ENODEV
 19

	)

50 
	#ENOTDIR
 20

	)

51 
	#EISDIR
 21

	)

52 
	#EINVAL
 22

	)

53 
	#ENFILE
 23

	)

54 
	#EMFILE
 24

	)

55 
	#ENOTTY
 25

	)

56 
	#EFBIG
 27

	)

57 
	#ENOSPC
 28

	)

58 
	#ESPIPE
 29

	)

59 
	#EROFS
 30

	)

60 
	#EMLINK
 31

	)

61 
	#EPIPE
 32

	)

62 
	#EDOM
 33

	)

63 
	#ERANGE
 34

	)

64 
	#EDEADLK
 36

	)

67 #iâdeà
ENAMETOOLONG


68 
	#ENAMETOOLONG
 38

	)

71 
	#ENOLCK
 39

	)

72 
	#ENOSYS
 40

	)

75 #iâdeà
ENOTEMPTY


76 
	#ENOTEMPTY
 41

	)

79 
	#EILSEQ
 42

	)

84 
	#EDEADLOCK
 
EDEADLK


	)

86 #ifdeà 
__ılu¥lus


	@nk/nk_osal.c

2 
	~"±e_ty³s.h
"

3 
	~"±e_o§l.h
"

4 
	~<Çutus/libccom·t.h
>

5 
	~<Çutus/th»ad.h
>

6 
	~<Çutus/scheduËr.h
>

7 
	~<Çutus/£m­hÜe.h
>

9 
	#ERROR
(
fmt
, 
¬gs
...è
	`ERROR_PRINT
("emb±h»ad: " fmt, ##¬gs)

	)

10 
	#DEBUG
(
fmt
, 
¬gs
...è
	`DEBUG_PRINT
("emb±h»ad: " fmt, ##¬gs)

	)

11 
	#INFO
(
fmt
, 
¬gs
...è
	`INFO_PRINT
("emb±h»ad: " fmt, ##¬gs)

	)

14 
	#STATE_UNLOCK
(
a
,
b
è
	`¥š_uÆock_œq_»¡Üe
×,b)

	)

15 
	#STATE_TRY_LOCK
(
a
,
b
è
	`¥š_Œy_lock_œq_§ve
×,b)

	)

16 
	#STATE_LOCK
(
a
è
	`¥š_lock_œq_§ve
×)

	)

18 
	#SEMAPHORE_LOCK_CONF
 
ušt8_t
 
_£m­hÜe_lock_æags


	)

19 
	#SEMAPHORE_LOCK
(
s
è
_£m­hÜe_lock_æags
 = 
	`¥š_lock_œq_§ve
(&(s)->
lock
)

	)

20 
	#SEMAPHORE_TRY_LOCK
(
s
è
	`¥š_Œy_lock_œq_§ve
(&(s)->
lock
,&
_£m­hÜe_lock_æags
)

	)

21 
	#SEMAPHORE_UNLOCK
(
s
è
	`¥š_uÆock_œq_»¡Üe
(&(s)->
lock
, 
_£m­hÜe_lock_æags
)

	)

22 
	#SEMAPHORE_UNIRQ
(
s
è
	`œq_’abË_»¡Üe
(
_£m­hÜe_lock_æags
)

	)

24 
	#poff£tof
(
TYPE
, 
MEMBER
è((
size_t
è&((TYPE *)0)->MEMBER)

	)

25 
	#pcÚš”_of
(
±r
, 
ty³
, 
memb”
) ({ \

26 cÚ¡ 
	`ty³of
Ğ((
ty³
 *)0)->
memb”
 ) *
__m±r
 = (
±r
); \

27 (
ty³
 *)Ğ(*)
__m±r
 - 
	`off£tof
Ñy³,
memb”
è);})

	)

35 
±e_osResuÉ
 
	$±e_osIn™
(){

36  
PTE_OS_OK
;

37 
	}
}

47 
±e_osResuÉ
 
	$±e_osMu‹xC»©e
(
±e_osMu‹xHªdË
 *
pHªdË
){

49 *
pHªdË
 = 
	`m®loc
((
pmu‹x
));

50 
	`¥šlock_š™
((*
pHªdË
)->
lock
);

51 
	`DEBUG
("osMutexCreate\n");

52  
PTE_OS_OK
;

53 
	}
}

62 
±e_osResuÉ
 
	$±e_osMu‹xD–‘e
(
±e_osMu‹xHªdË
 
hªdË
){

63 
	`¥šlock_deš™
(&(
hªdË
->
lock
));

64 
	`DEBUG
("osMutexDelete\n");

65  
PTE_OS_OK
;

66 
	}
}

75 
±e_osResuÉ
 
	$±e_osMu‹xLock
(
±e_osMu‹xHªdË
 
hªdË
){

76 
ªs
= -1;

77 
hªdË
->
æags
 = 
	`STATE_LOCK
(&(hªdË->
lock
));

78 
	`DEBUG
("osMutexLock\n");

79  
PTE_OS_OK
;

81 
	}
}

93 
±e_osResuÉ
 
	$±e_osMu‹xTimedLock
(
±e_osMu‹xHªdË
 
hªdË
, 
timeout
){

94 
¡¬t
 = (è
	`time
(
NULL
);

95 
’d
 = 
¡¬t
;

96 
»s
 = -1;

97  (
’d
-
¡¬t
è<
timeout
 ){

98 
»s
=
	`STATE_TRY_LOCK
(&(
hªdË
->
lock
), &(hªdË->
æags
) );

99 
	`DEBUG
("osMutexTimedLock\n");

100 
’d
 = ()
	`time
(
NULL
);

101 if(
»s
 == 0){

102  
PTE_OS_OK
;

105  
PTE_OS_TIMEOUT
;

106 
	}
}

115 
±e_osResuÉ
 
	$±e_osMu‹xUÆock
(
±e_osMu‹xHªdË
 
hªdË
){

116 
	`STATE_UNLOCK
(&(
hªdË
->
lock
), hªdË->
æags
);

117 
	`DEBUG
("osMutexUnlock\n");

118  
PTE_OS_OK
;

119 
	}
}

135 
±e_osResuÉ
 
	$±e_osTh»adC»©e
(
±e_osTh»adEÁryPošt
 
’ŒyPošt
,

136 
¡ackSize
,

137 
š™ŸlPriÜ™y
,

138 *
¬gv
,

139 
±e_osTh»adHªdË
* 
hªdË
)

143 
±e_osTh»adHªdË
 
hªdËobj
 = 
	`m®loc
((
th»ad_w™h_sigÇl
));

144 
	`mem£t
(
hªdËobj
,0,(
th»ad_w™h_sigÇl
));

145 
»t
 = 
	`nk_th»ad_ü—‹
(
’ŒyPošt
, 
¬gv
, 
NULL
, 
çl£
,(
nk_¡ack_size_t
è
¡ackSize
, &(
hªdËobj
->
tid
),-1);

146 ià(
»t
 != 0){

147 
	`DEBUG
("createƒrrorƒxit\n");

148 
	`nk_th»ad_ex™
(
NULL
);

150 *
hªdË
 = 
hªdËobj
;

151 
nk_th»ad
* 
th»ad
 = (nk_th»ad*è(*
hªdË
)->
tid
;

152 
	`DEBUG
("osTh»adC»©%08x, %ld\n", 
th»ad
,h»ad->
tid
);

154  
PTE_OS_OK
;

155 
	}
}

163 
±e_osResuÉ
 
	$±e_osTh»adS¹
(
±e_osTh»adHªdË
 
hªdË
){

167 
	`nk_th»ad_run
(
hªdË
->
tid
);

168 
	`DEBUG
("osTh»adS¹ %08x\n", 
hªdË
);

170  
PTE_OS_OK
;

171 
	}
}

178 
	$±e_osTh»adEx™
(){

179 
	`DEBUG
("osthread EXIT\n");

180 
	`nk_th»ad_ex™
(
NULL
);

181 
	}
}

191 
±e_osResuÉ
 
	$±e_osTh»adWa™FÜEnd
(
±e_osTh»adHªdË
 
th»adHªdË
){

192 
	`DEBUG
("pte osThread Wait For End\n");

193 
nk_th»ad_t
 *
th»ad
 = (nk_th»ad_t*è&(
th»adHªdË
->
tid
);

194 
Œue
){

195 if(
th»ad
->
¡©us
==
NK_THR_EXITED
){

196  
PTE_OS_OK
;

198 
	`nk_y›ld
();

200 
	}
}

205 
±e_osTh»adHªdË
 
	$±e_osTh»adG‘HªdË
(){

207 
nk_th»ad_t
* 
th‘h»ad
 = 
	`g‘_cur_th»ad
();

208 
	`DEBUG
("osThreadGetHandle\n");

209  (
±e_osTh»adHªdË
è
	`pcÚš”_of
(
th‘h»ad
,
th»ad_w™h_sigÇl
, 
tid
);

211 
	}
}

216 
	$±e_osTh»adG‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
){

218 
	}
}

225 
±e_osResuÉ
 
	$±e_osTh»adS‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
, 
ÃwPriÜ™y
){

226  
PTE_OS_OK
;

228 
	}
}

235 
±e_osResuÉ
 
	$±e_osTh»adD–‘e
(
±e_osTh»adHªdË
 
hªdË
){

236 
	`DEBUG
("osThreadDelete\n");

237 
	`nk_th»ad_de¡roy
(&(
hªdË
->
tid
));

238 
	}
}

245 
±e_osResuÉ
 
	$±e_osTh»adEx™AndD–‘e
(
±e_osTh»adHªdË
 
hªdË
){

248 
	`DEBUG
("osThreadExitDelete\n");

249 
	`nk_th»ad_de¡roy
(&(
hªdË
->
tid
));

250 
	}
}

260 
±e_osResuÉ
 
	$±e_osTh»adCªûl
(
±e_osTh»adHªdË
 
hªdË
){

261 
	`DEBUG
("osThreadCancel \n");

262 
hªdË
->
sigÇl
 = 
NK_THREAD_CANCEL
;

264 
	}
}

274 
±e_osResuÉ
 
	$±e_osTh»adCheckCªûl
(
±e_osTh»adHªdË
 
hªdË
){

275 
nk_th»ad_t
 * 
th‘h»ad
 = (nk_th»ad_t*)&(
hªdË
->
tid
);

276 
	`DEBUG
("osThreadCheckCancel\n");

277 ià(
th‘h»ad
->
¡©us
 ==
NK_THR_EXITED
){

278  
PTE_OS_OK
;

280  
PTE_OS_INTERRUPTED
;

282 
	}
}

287 
	$±e_osTh»adSË•
(
m£cs
){

290 
¡¬t
 = (è
	`time
(
NULL
);

291 
’d
 = 
¡¬t
;

292 
»s
 = -1;

293  (
’d
-
¡¬t
è<
m£cs
 ){

294 
	`nk_y›ld
();

295 
’d
 = ()
	`time
(
NULL
);

298 
	}
}

303 
	$±e_osTh»adG‘MaxPriÜ™y
(){

306 
	}
}

311 
	$±e_osTh»adG‘MšPriÜ™y
(){

313 
	}
}

319 
	$±e_osTh»adG‘DeçuÉPriÜ™y
(){

321 
	}
}

338 
±e_osResuÉ
 
	$±e_osSem­hÜeC»©e
(
š™ŸlV®ue
, 
±e_osSem­hÜeHªdË
 *
pHªdË
){

341 *
pHªdË
 = 
	`nk_£m­hÜe_ü—‹
(
NULL
,
š™ŸlV®ue
,0,NULL);

342 
	`DEBUG
("osSemaphoreCreate\n");

343  
PTE_OS_OK
;

344 
	}
}

353 
±e_osResuÉ
 
	$±e_osSem­hÜeD–‘e
(
±e_osSem­hÜeHªdË
 
hªdË
){

354 
	`nk_£m­hÜe_»Ëa£
(
hªdË
);

355 
	`DEBUG
("osSemaphoreDelete\n");

356  
PTE_OS_OK
;

357 
	}
}

367 
±e_osResuÉ
 
	$±e_osSem­hÜePo¡
(
±e_osSem­hÜeHªdË
 
hªdË
, 
couÁ
){

368 
	`DEBUG
("osSemaphorePost\n");

369 
couÁ
 > 0){

370 
	`nk_£m­hÜe_up
(
hªdË
);

371 
couÁ
--;

373 
	}
}

386 
±e_osResuÉ
 
	$±e_osSem­hÜeP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
){

387 
	`DEBUG
("osSemaphorePend\n");

388 
SEMAPHORE_LOCK_CONF
;

389 if(
pTimeout
 =ğ
NULL
){

390 
	`DEBUG
("osSemaphorePend NULLime\n");

391 
	`SEMAPHORE_LOCK
(
hªdË
);

392 
	`SEMAPHORE_UNIRQ
(
s
);

395  
PTE_OS_OK
;

400 
nk_£m­hÜe
* 
s
 = 
hªdË
;

401 
	`DEBUG
("»Ëa£ sem­hÜw™h‚am%s\n",
s
->
Çme
);

402 
¡¬t
 = (è
	`time
(
NULL
);

403 
’d
 = 
¡¬t
;

404 
»s
 = -1;

405  (
’d
-
¡¬t
è< *
pTimeout
 ){

406 
	`DEBUG
("osSem­hÜeP’d %d \n", 
’d
-
¡¬t
);

407 
»s
 = 
	`SEMAPHORE_TRY_LOCK
(
s
);

408 if(
»s
 == 0){

409 
	`SEMAPHORE_UNIRQ
(
s
);

410  
PTE_OS_OK
;

412 
’d
 = ()
	`time
(
NULL
);

414  
PTE_OS_TIMEOUT
;

416 
	}
}

431 
±e_osResuÉ
 
	$±e_osSem­hÜeCªûÎabËP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
){

432 
nk_th»ad_t
* 
th‘h»ad
ğ
	`g‘_cur_th»ad
();

433 
±e_osTh»adHªdË
 
oshªdË
 = 
	`pcÚš”_of
(
th‘h»ad
, 
th»ad_w™h_sigÇl
, 
tid
);

434 
	`DEBUG
("osSemaphorecancelablepend\n");

435 
SEMAPHORE_LOCK_CONF
;

436 
»s
 = -1;

437 if(
pTimeout
 =ğ
NULL
){

438 
Œue
){

439 if(
oshªdË
->
sigÇl
 =ğ
NK_THREAD_CANCEL
){

440 
	`nk_th»ad_ex™
(
NULL
);

441  
PTE_OS_INTERRUPTED
;

443 
»s
 = 
	`SEMAPHORE_TRY_LOCK
(
hªdË
);

444 if(
»s
 == 0){

445 
	`SEMAPHORE_UNIRQ
(
s
);

446  
PTE_OS_OK
;

448 
	`nk_y›ld
();

451 
nk_£m­hÜe
* 
s
 = 
hªdË
;

452 
	`DEBUG
("»Ëa£ sem­hÜw™h‚am%s\n",
s
->
Çme
);

453 
¡¬t
 = (è
	`time
(
NULL
);

454 
’d
 = 
¡¬t
;

455  (
’d
-
¡¬t
è< *
pTimeout
 ){

456 if(
oshªdË
->
sigÇl
 =ğ
NK_THREAD_CANCEL
){

457  
PTE_OS_INTERRUPTED
;

459 
»s
 = 
	`SEMAPHORE_TRY_LOCK
(
s
);

460 if(
»s
 == 0){

461 
	`SEMAPHORE_UNIRQ
(
s
);

462  
PTE_OS_OK
;

464 
’d
 = ()
	`time
(
NULL
);

466  
PTE_OS_TIMEOUT
;

468 
	}
}

480 
±e_osResuÉ
 
	$±e_osTlsS‘V®ue
(
key
, * 
v®ue
){

481 
	`DEBUG
("pte_osTlsSetvalue\n");

482 
	`nk_s_£t
(
key
, 
v®ue
);

483  
PTE_OS_OK
;

484 
	}
}

496 * 
	$±e_osTlsG‘V®ue
(
key
){

497 
	`DEBUG
("osTlsGetValue\n");

498  
	`nk_s_g‘
(
key
);

499 
	}
}

505 
	$±e_osTlsIn™
(){

507 
	}
}

518 
±e_osResuÉ
 
	$±e_osTlsAÎoc
(*
pKey
){

519 
	`DEBUG
("osTlsAlloc\n");

520 
	`nk_s_key_ü—‹
(
pKey
, 
NULL
);

521  
PTE_OS_OK
;

522 
	}
}

531 
±e_osResuÉ
 
	$±e_osTlsF»e
(
key
){

532 
	`DEBUG
("osTlsFree\n");

533 
	`nk_s_key_d–‘e
(
key
);

534  
PTE_OS_OK
;

535 
	}
}

555 
	$±e_osAtomicExchªge
(*
pT¬g
, 
v®
){

557 
Üigš
 = *
pT¬g
;

558 
	`__©omic_exchªge_n
(
pT¬g
,
v®
,
__ATOMIC_SEQ_CST
);

559 
	`DEBUG
("AtomicEXCHANGE, ORIG %d , NOW %d v® %d„‘ %d\n", 
Üigš
, *
pT¬g
, 
v®
);

560  
Üigš
;

567 
	}
}

586 
	$±e_osAtomicCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
){

587 
	`DEBUG
("AtomicCompareEXCHANGE");

588  
	`__sync_v®_com·»_ªd_sw­
(
pde¡
,
comp
,
exchªge
);

590 
	}
}

606 
	$±e_osAtomicExchªgeAdd
(vŞ©e* 
pde¡
, 
v®ue
){

607 
	`DEBUG
("AtomicEXCHANGEAdd\n");

608  
	`__sync_ãtch_ªd_add
(
pde¡
, 
v®ue
);

610 
	}
}

625 
	$±e_osAtomicDeüem’t
(*
pde¡
){

626 
	`DEBUG
("AtomicDecrement\n" );

627  
	`__sync_ãtch_ªd_sub
(
pde¡
,1);

629 
	}
}

639 
	$±e_osAtomicInüem’t
(*
pde¡
){

640 
	`DEBUG
("AtomicIncrement\n");

641  
	`__sync_ãtch_ªd_add
(
pde¡
,1);

643 
	}
}

646 
	$áime
(
timeb
 *
tb
){

647 
tb
->
time
 = 0;

648 
tb
->
ml™m
 = 0;

649 
tb
->
timezÚe
 = 0;

650 
tb
->
d¡æag
=0;

652 
	}
}

	@nk/pte_generic_osal.h

29 #iâdeà
_GENERIC_OS_SUPPORT_H_


30 
	#_GENERIC_OS_SUPPORT_H_


	)

31 #ifdeà
__ılu¥lus


37 
	e±e_osResuÉ


41 
PTE_OS_OK
 = 0,

44 
PTE_OS_NO_RESOURCES
,

47 
PTE_OS_GENERAL_FAILURE
,

50 
PTE_OS_TIMEOUT
,

53 
PTE_OS_INTERRUPTED
,

56 
PTE_OS_INVALID_PARAM


59 } 
	t±e_osResuÉ
;

65 
±e_osResuÉ
 
±e_osIn™
();

79 
±e_osResuÉ
 
±e_osMu‹xC»©e
(
±e_osMu‹xHªdË
 *
pHªdË
);

88 
±e_osResuÉ
 
±e_osMu‹xD–‘e
(
±e_osMu‹xHªdË
 
hªdË
);

97 
±e_osResuÉ
 
±e_osMu‹xLock
(
±e_osMu‹xHªdË
 
hªdË
);

109 
±e_osResuÉ
 
±e_osMu‹xTimedLock
(
±e_osMu‹xHªdË
 
hªdË
, 
timeoutM£cs
);

118 
±e_osResuÉ
 
±e_osMu‹xUÆock
(
±e_osMu‹xHªdË
 
hªdË
);

141 
±e_osResuÉ
 
±e_osTh»adC»©e
(
±e_osTh»adEÁryPošt
 
’ŒyPošt
,

142 
¡ackSize
,

143 
š™ŸlPriÜ™y
,

144 *
¬gv
,

145 
±e_osTh»adHªdË
* 
µ‹_osTh»adHªdË
);

154 
±e_osResuÉ
 
±e_osTh»adS¹
(
±e_osTh»adHªdË
 
osTh»adHªdË
);

161 
±e_osTh»adEx™
();

171 
±e_osResuÉ
 
±e_osTh»adWa™FÜEnd
(
±e_osTh»adHªdË
 
th»adHªdË
);

176 
±e_osTh»adHªdË
 
±e_osTh»adG‘HªdË
();

181 
±e_osTh»adG‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
);

188 
±e_osResuÉ
 
±e_osTh»adS‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
, 
ÃwPriÜ™y
);

195 
±e_osResuÉ
 
±e_osTh»adD–‘e
(
±e_osTh»adHªdË
 
hªdË
);

202 
±e_osResuÉ
 
±e_osTh»adEx™AndD–‘e
(
±e_osTh»adHªdË
 
hªdË
);

212 
±e_osResuÉ
 
±e_osTh»adCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
);

222 
±e_osResuÉ
 
±e_osTh»adCheckCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
);

227 
±e_osTh»adSË•
(
m£cs
);

232 
±e_osTh»adG‘MaxPriÜ™y
();

237 
±e_osTh»adG‘MšPriÜ™y
();

243 
±e_osTh»adG‘DeçuÉPriÜ™y
();

260 
±e_osResuÉ
 
±e_osSem­hÜeC»©e
(
š™ŸlV®ue
, 
±e_osSem­hÜeHªdË
 *
pHªdË
);

269 
±e_osResuÉ
 
±e_osSem­hÜeD–‘e
(
±e_osSem­hÜeHªdË
 
hªdË
);

279 
±e_osResuÉ
 
±e_osSem­hÜePo¡
(
±e_osSem­hÜeHªdË
 
hªdË
, 
couÁ
);

292 
±e_osResuÉ
 
±e_osSem­hÜeP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
);

307 
±e_osResuÉ
 
±e_osSem­hÜeCªûÎabËP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
);

320 
±e_osResuÉ
 
±e_osTlsS‘V®ue
(
key
, * 
v®ue
);

332 * 
±e_osTlsG‘V®ue
(
key
);

338 
±e_osTlsIn™
();

349 
±e_osResuÉ
 
±e_osTlsAÎoc
(*
pKey
);

358 
±e_osResuÉ
 
±e_osTlsF»e
(
key
);

378 
±e_osAtomicExchªge
(*
pT¬g
, 
v®
);

397 
±e_osAtomicCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
);

413 
±e_osAtomicExchªgeAdd
(vŞ©e* 
pde¡
, 
v®ue
);

428 
±e_osAtomicDeüem’t
(*
pde¡
);

438 
±e_osAtomicInüem’t
(*
pde¡
);

441 
timeb
;

443 
áime
(
timeb
 *
tb
);

445 #ifdeà
__ılu¥lus


	@nk/pte_osal.h

1 #iâdeà
_PTE_OSAL_H_


2 
	#_PTE_OSAL_H_


	)

3 
	~"±e_ty³s.h
"

4 
	~"±e_g’”ic_o§l.h
"

5 
	~<Çutus/Çutus.h
>

7 
	#ÿÎoc
(
a
,
b
è
	`m®loc
×*b)

	)

43 #iâdeà
EPERM


44 
	#EPERM
 1

	)

47 #iâdeà
ESRCH


48 
	#ESRCH
 3

	)

51 #iâdeà
EINTR


52 
	#EINTR
 4

	)

55 #iâdeà
EIO


56 
	#EIO
 5

	)

59 #iâdeà
EAGAIN


60 
	#EAGAIN
 11

	)

63 #iâdeà
ENOMEM


64 
	#ENOMEM
 12

	)

67 #iâdeà
EBUSY


68 
	#EBUSY
 16

	)

71 #iâdeà
EINVAL


72 
	#EINVAL
 22

	)

75 #iâdeà
ENOSPC


76 
	#ENOSPC
 28

	)

79 #iâdeà
EDEADLK


80 
	#EDEADLK
 35

	)

83 #iâdeà
ENOSYS


84 
	#ENOSYS
 38

	)

87 #iâdeà
ENOTSUP


88 
	#ENOTSUP
 95

	)

91 #iâdeà
ETIMEDOUT


92 
	#ETIMEDOUT
 116

	)

95 #iâdeà
ENOENT


96 
	#ENOENT
 7

	)

99 #iâdeà
ERANGE


100 
	#ERANGE
 9

	)

	@nk/pte_types.h

3 #iâdeà
PTE_TYPES_H


4 
	#PTE_TYPES_H


	)

5 
	~<Çutus/li¡.h
>

6 
	~<Çutus/£m­hÜe.h
>

7 
	~<Çutus/th»ad.h
>

8 
	~<Çutus/¥šlock.h
>

9 
	~<Çutus/libccom·t.h
>

10 
	spmu‹x
{

11 
¥šlock_t
 
	mlock
;

12 
ušt8_t
 
	mæags
;

15 
	sp£m­hÜe
{

16 
¥šlock_t
 
	mlock
;

17 
	mcouÁ
;

18 
ušt8_t
 
	mæags
;

20 
	sth»ad_w™h_sigÇl
{

21 
nk_th»ad_id_t
 
	mtid
;

22 
ušt8_t
 
	msigÇl
;

25 
pmu‹x
* 
	t±e_osMu‹xHªdË
;

26 
nk_th»ad_fun_t
 
	t±e_osTh»adEÁryPošt
;

27 
th»ad_w™h_sigÇl
* 
	t±e_osTh»adHªdË
;

28 
p£m­hÜe
* 
	t±e_osSem­hÜeHªdË
;

30 
	e_±h»ad_sigÇl
{

31 
	mNK_THREAD_NORM
,

32 
	mNK_THREAD_CANCEL


33 }
	t±h»ad_sigÇl
;

36 
nk_th»ad_fun_t
 
	t±e_osTh»adEÁryPošt
;

37 
	tpid_t
;

38 
	tmode_t
;

45 
	stimeb


47 
time_t
 
	mtime
;

48 
	mml™m
;

49 
	mtimezÚe
;

50 
	md¡æag
;

	@nk_generic_oasl.c

1 #iâdeà
_PT


2 
	~"±e_ß¦.h
"

3 
	~<Çutus/libcom·t.h
>

4 
	~<Çutus/th»ad.h
>

5 
	~<Çutus/£m­hÜe.h
>

6 
	#STATE_UNLOCK
(
a
,
b
è
	`¥š_uÆock_œq_»¡Üe
×,b)

	)

7 
	#STATE_TRY_LOCK
(
a
,
b
è
	`¥š_Œy_lock_œq_§ve
×,b)

	)

8 
	#STATE_LOCK
(
a
,
b
è
	`¥š_lock_œq_§ve
×,b)

	)

10 
	#SEMAPHORE_LOCK_CONF
 
ušt8_t
 
_£m­hÜe_lock_æags


	)

11 
	#SEMAPHORE_LOCK
(
s
è
_£m­hÜe_lock_æags
 = 
	`¥š_lock_œq_§ve
(&(s)->
lock
)

	)

12 
	#SEMAPHORE_TRY_LOCK
(
s
è
	`¥š_Œy_lock_œq_§ve
(&(s)->
lock
,&
_£m­hÜe_lock_æags
)

	)

13 
	#SEMAPHORE_UNLOCK
(
s
è
	`¥š_uÆock_œq_»¡Üe
(&(s)->
lock
, 
_£m­hÜe_lock_æags
)

	)

14 
	#SEMAPHORE_UNIRQ
(
s
è
	`œq_’abË_»¡Üe
(
_£m­hÜe_lock_æags
)

	)

16 
	#poff£tof
(
TYPE
, 
MEMBER
è((
size_t
è&((TYPE *)0)->MEMBER)

	)

17 
	#pcÚš”_of
(
±r
, 
ty³
, 
memb”
) ({ \

18 cÚ¡ 
	`ty³of
Ğ((
ty³
 *)0)->
memb”
 ) *
__m±r
 = (
±r
); \

19 (
ty³
 *)Ğ(*)
__m±r
 - 
	`off£tof
Ñy³,
memb”
è);})

	)

25 
	e±e_osResuÉ


29 
	mPTE_OS_OK
 = 0,

32 
	mPTE_OS_NO_RESOURCES
,

35 
	mPTE_OS_GENERAL_FAILURE
,

38 
	mPTE_OS_TIMEOUT
,

41 
	mPTE_OS_INTERRUPTED
,

44 
	mPTE_OS_INVALID_PARAM


47 } 
	t±e_osResuÉ
;

53 
±e_osResuÉ
 
	$±e_osIn™
(){

54  
PTE_OS_OK
;

55 
	}
}

65 
±e_osResuÉ
 
	$±e_osMu‹xC»©e
(
±e_osMu‹xHªdË
 *
pHªdË
){

67  
PTE_OS_OK
;

68 
	}
}

77 
±e_osResuÉ
 
	$±e_osMu‹xD–‘e
(
±e_osMu‹xHªdË
 
hªdË
){

79  
PTE_OS_OK
;

80 
	}
}

89 
±e_osResuÉ
 
	$±e_osMu‹xLock
(
±e_osMu‹xHªdË
 
hªdË
){

90 
ªs
= -1;

91 
hªdË
->
æags
 = 
	`STATE_LOCK
(&(hªdË->
lock
));

93  
PTE_OS_OK
;

95 
	}
}

107 
±e_osResuÉ
 
	$±e_osMu‹xTimedLock
(
±e_osMu‹xHªdË
 
hªdË
, 
timeoutM£cs
){

108 
¡¬t
 = (è
	`time
();

109 
’d
 = 
¡¬t
;

110 
»s
 = -1;

111  (
’d
-
¡¬t
è<
timeout
 ){

112 
»s
=
	`STATE_TRY_LOCK
(&(
hªdË
->
lock
), &(hªdË->
æags
) );

113 
’d
 = ()
	`time
();

114 if(
»s
 == 0){

115  
PTE_OS_OK
;

118  
PTE_OS_TIMEOUT
;

119 
	}
}

128 
±e_osResuÉ
 
	$±e_osMu‹xUÆock
(
±e_osMu‹xHªdË
 
hªdË
){

129 
	`STATE_UNLOCK
(&(
hªdË
->
lock
), hªdË->
æags
);

130  
PTE_OS_OK
;

131 
	}
}

152 
±e_osResuÉ
 
	$±e_osTh»adC»©e
(
±e_osTh»adEÁryPošt
 
’ŒyPošt
,

153 
¡ackSize
,

154 
š™ŸlPriÜ™y
,

155 *
¬gv
,

156 
±e_osTh»adHªdË
* 
hªdË
){

159 
±e_osTh»adHªdË
 
hªdËobj
 = 
	`m®loc
(());

160 *
hªdË
 = 
hªdËobj
;

161 
	`nk_th»ad_ü—‹
(
’ŒyPošt
, 
NULL
,NULL, 
çl£
,(
nk_¡ack_size_t
è
¡ackSize
, &(
hªdËobj
->
tid
),-1);

162 
»tur
 
PTE_OS_OK
;

163 
	}
}

172 
±e_osResuÉ
 
	$±e_osTh»adS¹
(
±e_osTh»adHªdË
 
hªdË
){

173 
	`nk_th»ad_run
(&(
hªdË
->
tid
));

174  
PTE_OS_OK
;

175 
	}
}

182 
	$±e_osTh»adEx™
(){

183 
	`nk_th»ad_ex™
();

184 
	}
}

194 
±e_osResuÉ
 
	$±e_osTh»adWa™FÜEnd
(
±e_osTh»adHªdË
 
th»adHªdË
){

195 
nk_th»ad_t
 *
th»ad
 = (nk_th»ad_t*è&(
th»adHªdË
->
tid
);

196 
Œue
){

197 if(
th»ad
->
¡©us
==
NK_THR_EXITED
){

198  
PTE_OS_OK
;

200 
	`nk_y›ld
();

202 
	}
}

207 
±e_osTh»adHªdË
 
	$±e_osTh»adG‘HªdË
(){

209 
nk_th»ad_t
* 
th‘h»ad
 = 
	`g‘_cur_th»ad
();

210  (
±e_osTh»adHªdË
è
	`pcÚš”_of
(
th‘h»ad
,
_th»ad_w™h_sigÇl
, 
tid
);

212 
	}
}

217 
	$±e_osTh»adG‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
){

219 
	}
}

226 
±e_osResuÉ
 
	$±e_osTh»adS‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
, 
ÃwPriÜ™y
){

227  
PTE_OS_OK
;

229 
	}
}

236 
±e_osResuÉ
 
	$±e_osTh»adD–‘e
(
±e_osTh»adHªdË
 
hªdË
){

237 
	`nk_th»ad_de¡roy
(&(
hªdË
->
tid
));

238 
	}
}

245 
±e_osResuÉ
 
	$±e_osTh»adEx™AndD–‘e
(
±e_osTh»adHªdË
 
hªdË
){

248 
	`nk_th»ad_de¡roy
(&(
hªdË
->
tid
));

249 
	}
}

259 
±e_osResuÉ
 
	$±e_osTh»adCªûl
(
±e_osTh»adHªdË
 
hªdË
){

260 
hªdË
->
sšg®
 = 
NK_THREAD_CANCEL
;

262 
	}
}

272 
±e_osResuÉ
 
	$±e_osTh»adCheckCªûl
(
±e_osTh»adHªdË
 
hªdË
){

273 
nk_th»ad_t
 * 
th‘h»ad
 = (nk_th»ad_t*)&(
hªdË
->
tid
);

274 ià(
th‘h»ad
->
¡©us
 ==
NK_THR_EXITED
){

275  
PTE_OS_OK
;

277  
PTE_OS_INTERRUPTED
;

279 
	}
}

284 
	$±e_osTh»adSË•
(
m£cs
){

285 
¡¬t
 = (è
	`time
();

286 
’d
 = 
¡¬t
;

287 
»s
 = -1;

288  (
’d
-
¡¬t
è<
m£cs
 ){

289 
	`nk_y›ld
();

290 
’d
 = ()
	`time
();

292  
PTE_OS_OK
;

294 
	}
}

299 
	$±e_osTh»adG‘MaxPriÜ™y
(){

302 
	}
}

307 
	$±e_osTh»adG‘MšPriÜ™y
(){

309 
	}
}

315 
	$±e_osTh»adG‘DeçuÉPriÜ™y
(){

317 
	}
}

334 
±e_osResuÉ
 
	$±e_osSem­hÜeC»©e
(
š™ŸlV®ue
, 
±e_osSem­hÜeHªdË
 *
pHªdË
){

336 *
pHªdË
 = 
	`nk_£m­hÜe_ü—‹
(
NULL
,
š™ŸlV®ue
,0,NULL);

337  
PTE_OS_OK
;

338 
	}
}

347 
±e_osResuÉ
 
	$±e_osSem­hÜeD–‘e
(
±e_osSem­hÜeHªdË
 
hªdË
){

348 
	`nk_£m­hÜe_»Ëa£
(
hªdË
);

349  
PTE_OS_OK
;

350 
	}
}

360 
±e_osResuÉ
 
	$±e_osSem­hÜePo¡
(
±e_osSem­hÜeHªdË
 
hªdË
, 
couÁ
){

361 
couÁ
 > 0){

362 
	`nk_£m­hÜe_up
(
hªdË
);

364 
	}
}

377 
±e_osResuÉ
 
	$±e_osSem­hÜeP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
){

378 if(
pTimeout
 = 
NULL
){

379 
	`nk_th»ad_ex™
();

382 
nk_£m­hÜe
* 
s
 = 
hªdË
;

383 
SEMAPHORE_LOCK_CONF
;

384 
	`DEBUG
("»Ëa£ sem­hÜw™h‚am%s\n",
s
->
Çme
);

385 
¡¬t
 = (è
	`time
();

386 
’d
 = 
¡¬t
;

387 
»s
 = -1;

388  (
’d
-
¡¬t
è<
m£cs
 ){

389 
»s
 = 
	`SEMAPHORE_TRY_LOCK
(
s
);

390 if(
»s
 == 0){

391  
PTE_OS_OK
;

393 
’d
 = ()
	`time
();

395  
PTE_OS_TIMEOUT
;

397 
	}
}

412 
±e_osResuÉ
 
	$±e_osSem­hÜeCªûÎabËP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
){

413 
nk_th»ad_t
* 
th‘h»ad
ğ
	`g‘_cur_th»ad
();

414 
±e_osTh»adHªdË
 
hªdË
 = 
	`pcÚš”_of
(
th‘»ad
, 
th»ad_w™h_sigÇl
, 
tid
);

416 
pTimeout
 =ğ
NULL
){

417 if(
hªdË
->
sigÇl
 =ğ
NK_THREAD_CANCEL
){

418  
PTE_OS_INTERRUPTE
;

420 
	`nk_y›ld
();

423 
nk_£m­hÜe
* 
s
 = 
hªdË
;

424 
SEMAPHORE_LOCK_CONF
;

425 
	`DEBUG
("»Ëa£ sem­hÜw™h‚am%s\n",
s
->
Çme
);

426 
¡¬t
 = (è
	`time
();

427 
’d
 = 
¡¬t
;

428 
»s
 = -1;

429  (
’d
-
¡¬t
è<
m£cs
 ){

430 if(
hªdË
->
sigÇl
 =ğ
NK_THREAD_CANCEL
){

431  
PTE_OS_INTERRUPTE
;

433 
»s
 = 
	`SEMAPHORE_TRY_LOCK
(
s
);

434 if(
»s
 == 0){

435  
PTE_OS_OK
;

437 
’d
 = ()
	`time
();

439  
PTE_OS_TIMEOUT
;

441 
	}
}

453 
±e_osResuÉ
 
	$±e_osTlsS‘V®ue
(
key
, * 
v®ue
){

454 
	`nk_s_£t
(
key
, 
v®ue
);

455  
PTE_OS_OK
;

456 
	}
}

468 * 
	$±e_osTlsG‘V®ue
(
key
){

469  
	`nk_s_g‘
(
key
);

470 
	}
}

476 
	$±e_osTlsIn™
(){

478 
	}
}

489 
±e_osResuÉ
 
	$±e_osTlsAÎoc
(*
pKey
){

490 
	`nk_s_key_ü—‹
(
pKey
, 
NULL
);

491  
PTE_OS_OK
;

492 
	}
}

501 
±e_osResuÉ
 
	$±e_osTlsF»e
(
key
){

502 
	`nk_s_key_d–‘e
(
key
);

503  
PTE_OS_OK
;

504 
	}
}

524 
	$±e_osAtomicExchªge
(*
pT¬g
, 
v®
){

525  ()(*(
	`xchg64
(&
pT¬g
, &
v®
)));

526 
	}
}

545 
	$±e_osAtomicCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
){

546  
	`©omic_cmpsw­
(
pde¡
, 
comp
, 
exchªge
);

547 
	}
}

563 
	$±e_osAtomicExchªgeAdd
(vŞ©e* 
pde¡
, 
v®ue
){

564  
	`©omic_add
(
pde¡
, 
v®ue
);

565 
	}
}

580 
	$±e_osAtomicDeüem’t
(*
pde¡
){

581  
	`©omic_dec
(
pde¡
);

582 
	}
}

592 
	$±e_osAtomicInüem’t
(*
pde¡
){

593  
	`©omic_šc
(
pde¡
);

594 
	}
}

597 
	$áime
(
timeb
 *
tb
){

598 
tb
->
time
 = 0;

599 
tb
->
ml™m
 = 0;

600 
tb
->
timezÚe
 = 0;

601 
tb
->
d¡æag
=0;

603 
	}
}

	@omptest.c

1 
	~<Çutus/Çutus.h
>

2 
	~<Çutus/sh–l.h
>

3 
	~<Çutus/libccom·t.h
>

4 #iâdeà
NAUT_CONFIG_DEBUG_GPUDEV


5 #undeà
DEBUG_PRINT


6 
	#DEBUG_PRINT
(
fmt
, 
¬gs
...)

	)

9 
	#ERROR
(
fmt
, 
¬gs
...è
	`ERROR_PRINT
("om±e¡: " fmt, ##¬gs)

	)

10 
	#DEBUG
(
fmt
, 
¬gs
...è
	`DEBUG_PRINT
("om±e¡: " fmt, ##¬gs)

	)

11 
	#INFO
(
fmt
, 
¬gs
...è
	`INFO_PRINT
("om±e¡: " fmt, ##¬gs)

	)

17 
	#MAXN
 100

	)

18 
	gN
;

19 
	g´ocs
;

22 vŞ©
	gA
[
MAXN
][MAXN], 
	gB
[MAXN], 
	gX
[MAXN];

27 
gauss
();

33 
	$š™Ÿlize_šputs
() {

34 
row
, 
cŞ
;

36 
	`´štf
("\nInitializing...\n");

37 
cŞ
 = 0; cŞ < 
N
; col++) {

38 
row
 = 0;„ow < 
N
;„ow++) {

39 
A
[
row
][
cŞ
] = () (col+row);

41 
B
[
cŞ
] = ()(col);

42 
X
[
cŞ
] = 0.0;

45 
	}
}

48 
	$´št_šputs
() {

49 
row
, 
cŞ
;

51 ià(
N
 < 100) {

52 
	`´štf
("\nA =\n\t");

53 
row
 = 0;„ow < 
N
;„ow++) {

54 
cŞ
 = 0; cŞ < 
N
; col++) {

55 
	`´štf
("%5.2f%s", 
A
[
row
][
cŞ
], (cŞ < 
N
-1) ? ", " : ";\n\t");

58 
	`´štf
("\nB = [");

59 
cŞ
 = 0; cŞ < 
N
; col++) {

60 
	`´štf
("%5.2f%s", 
B
[
cŞ
], (cŞ < 
N
-1) ? "; " : "]\n");

63 
	}
}

66 
	$gauss
() {

67 
nÜm
, 
row
, 
cŞ
;

69 
muÉl›r
;

72 
	`´štf
("Computing using omp.\n");

76 #´agm¨
omp
 
·¿Î–
 
	`´iv©e
(
cŞ
, 
row
, 
muÉl›r
è
	`num_th»ads
(
´ocs
)

77 
nÜm
 = 0;‚Üm < 
N
 - 1;‚orm++) {

79 
num
 = 
N
 - 
nÜm
;

82 #´agm¨
omp
 
	`scheduË
(
dyÇmic
)

83 
row
 = 
nÜm
 + 1;„ow < 
N
;„ow++) {

85 
muÉl›r
 = 
A
[
row
][
nÜm
] / A[norm][norm];

87 
cŞ
 = 
nÜm
; cŞ < 
N
; col++) {

88 
A
[
row
][
cŞ
] -ğA[
nÜm
][cŞ] * 
muÉl›r
;

90 
B
[
row
] -ğB[
nÜm
] * 
muÉl›r
;

98 
row
 = 
N
 - 1;„ow >= 0;„ow--) {

99 
X
[
row
] = 
B
[row];

100 
cŞ
 = 
N
-1; cŞ > 
row
; col--) {

101 
X
[
row
] -ğ
A
[row][
cŞ
] * X[col];

103 
X
[
row
] /ğ
A
[row][row];

105 
	}
}

109 
	$hªdË_om±e¡
 (* 
buf
, * 
´iv
)

111 
N
 = 3;

112 
´ocs
 = 3;

113 
A
[0][0] = 4; A[0][1] = -3; A[0][2] = 1;

114 
A
[1][0] = -2; A[1][1] = 1; A[1][2] = -3;

115 
A
[2][0] = 1; A[2][1] = -1; A[2][2] = 2;

116 
B
[0] = -8; B[1] = -4; B[2] = 2;

117 
	`´št_šputs
();

118 
	`gauss
();

119 
	`´št_šputs
();

122 
	}
}

125 
sh–l_cmd_im¶
 
	gom±e¡_im¶
 = {

126 .
cmd
 = "omptest",

127 .
	gh–p_¡r
 = "openmpest",

128 .
	ghªdËr
 = 
hªdË_om±e¡
,

130 
nk_»gi¡”_sh–l_cmd
(
om±e¡_im¶
);

	@pte_callUserDestroyRoutines.c

48 
	~<Çutus/Çutus.h
>

49 
	~"±h»ad.h
"

50 
	~"im¶em’t.h
"

52 
	~"nk/±e_o§l.h
"

54 #ifdeà
__ılu¥lus


55 
	~<exû±iÚ
>

56 
usšg
 
	g¡d
::
‹rmš©e
;

60 
	$±e_ÿÎU£rDe¡royRoutšes
 (
±h»ad_t
 
th»ad
)

78 
Th»adKeyAssoc
 * 
assoc
;

80 ià(
th»ad
.
p
 !ğ
NULL
)

82 
assocsRemaššg
;

83 
™”©iÚs
 = 0;

84 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
th»ad
.
p
;

94 
assocsRemaššg
 = 0;

95 
™”©iÚs
++;

97 (è
	`±h»ad_mu‹x_lock
(&(
¥
->
th»adLock
));

106 
¥
->
ÃxtAssoc
 = sp->
keys
;

107 (è
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

111 * 
v®ue
;

112 
±h»ad_key_t
 
k
;

113 (*
de¡ruùÜ
) (*);

120 (è
	`±h»ad_mu‹x_lock
(&(
¥
->
th»adLock
));

122 ià((
assoc
 = (
Th»adKeyAssoc
 *)
¥
->
ÃxtAssoc
è=ğ
NULL
)

125 
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

140 ià(
	`±h»ad_mu‹x_Œylock
(&(
assoc
->
key
->
keyLock
)è=ğ
EBUSY
)

142 
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

143 
	`±e_osTh»adSË•
(1);

155 
¥
->
ÃxtAssoc
 = 
assoc
->
ÃxtKey
;

164 
k
 = 
assoc
->
key
;

165 
de¡ruùÜ
 = 
k
->destructor;

166 
v®ue
 = 
	`±e_osTlsG‘V®ue
(
k
->
key
);

167 
	`±e_osTlsS‘V®ue
 (
k
->
key
, 
NULL
);

170 ià(
v®ue
 !ğ
NULL
 && 
™”©iÚs
 <ğ
PTHREAD_DESTRUCTOR_ITERATIONS
)

179 (è
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

180 (è
	`±h»ad_mu‹x_uÆock
(&(
k
->
keyLock
));

182 
assocsRemaššg
++;

184 #ifdeà
__ılu¥lus


186 
Œy


191 
	`de¡ruùÜ
 (
v®ue
);

193 
	`ÿtch
 (...)

204 
	`‹rmš©e
 ();

212 
	`de¡ruùÜ
 (
v®ue
);

223 
	`±e_tkAssocDe¡roy
 (
assoc
);

224 (è
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

225 (è
	`±h»ad_mu‹x_uÆock
(&(
k
->
keyLock
));

229 
assocsRemaššg
);

231 
	}
}

	@pte_cancellable_wait.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"£m­hÜe.h
"

49 
	~"im¶em’t.h
"

52 
	$±e_ÿnûÎabË_wa™
 (
±e_osSem­hÜeHªdË
 
£mHªdË
, * 
timeout
)

54 
»suÉ
 = 
EINVAL
;

55 
±e_osResuÉ
 
osResuÉ
;

56 
ÿnûlEÇbËd
 = 0;

57 
±h»ad_t
 
£lf
;

58 
±e_th»ad_t
 * 
¥
;

60 
£lf
 = 
	`±h»ad_£lf
();

61 
¥
 = (
±e_th»ad_t
 *è
£lf
.
p
;

63 ià(
¥
 !ğ
NULL
)

68 ià(
¥
->
ÿnûlS‹
 =ğ
PTHREAD_CANCEL_ENABLE
)

70 
ÿnûlEÇbËd
 = 1;

75 ià(
ÿnûlEÇbËd
)

77 
osResuÉ
 = 
	`±e_osSem­hÜeCªûÎabËP’d
(
£mHªdË
, 
timeout
);

81 
osResuÉ
 = 
	`±e_osSem­hÜeP’d
(
£mHªdË
, 
timeout
);

84 
osResuÉ
)

86 
PTE_OS_OK
:

88 
»suÉ
 = 0;

92 
PTE_OS_TIMEOUT
:

94 
»suÉ
 = 
ETIMEDOUT
;

98 
PTE_OS_INTERRUPTED
:

100 ià(
¥
 !ğ
NULL
)

106 (è
	`±h»ad_mu‹x_lock
 (&
¥
->
ÿnûlLock
);

107 ià(
¥
->
¡©e
 < 
PTh»adS‹Cªûlšg
)

109 
¥
->
¡©e
 = 
PTh»adS‹Cªûlšg
;

110 
¥
->
ÿnûlS‹
 = 
PTHREAD_CANCEL_DISABLE
;

111 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

112 
	`±e_throw
 (
PTE_EPS_CANCEL
);

116 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

123 
»suÉ
 = 
EINVAL
;

129  (
»suÉ
);

131 
	}
}

	@pte_cond_check_need_init.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

49 
	$±e_cÚd_check_Ãed_š™
 (
±h»ad_cÚd_t
 * 
cÚd
)

51 
»suÉ
 = 0;

76 
	`±e_osMu‹xLock
 (
±e_cÚd_‹¡_š™_lock
);

85 ià(*
cÚd
 =ğ
PTHREAD_COND_INITIALIZER
)

87 
»suÉ
 = 
	`±h»ad_cÚd_š™
 (
cÚd
, 
NULL
);

89 ià(*
cÚd
 =ğ
NULL
)

96 
»suÉ
 = 
EINVAL
;

100 
	`±e_osMu‹xUÆock
(
±e_cÚd_‹¡_š™_lock
);

102  
»suÉ
;

103 
	}
}

	@pte_detach.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±e_th»ad_d‘ach_commÚ
 (
th»adShouldEx™
)

49 ià(
±e_´oûssIn™Ÿlized
)

55 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
	`±h»ad_g‘¥ecific
 (
±e_£lfTh»adKey
);

57 ià(
¥
 !ğ
NULL
)

60 
	`±e_ÿÎU£rDe¡royRoutšes
 (
¥
->
±HªdË
);

62 (è
	`±h»ad_mu‹x_lock
 (&
¥
->
ÿnûlLock
);

63 
¥
->
¡©e
 = 
PTh»adS‹La¡
;

69 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

71 ià(
¥
->
d‘achS‹
 =ğ
PTHREAD_CREATE_DETACHED
)

73 ià(
th»adShouldEx™
)

75 
	`±e_th»adEx™AndDe¡roy
 (
¥
->
±HªdË
);

79 
	`±e_th»adDe¡roy
 (
¥
->
±HªdË
);

86 ià(
th»adShouldEx™
)

88 
	`±e_osTh»adEx™
();

95 
	}
}

97 
	$±e_th»ad_d‘ach_ªd_ex™_Å
()

99  
	`±e_th»ad_d‘ach_commÚ
(1);

100 
	}
}

102 
	$±e_th»ad_d‘ach_Å
()

104  
	`±e_th»ad_d‘ach_commÚ
(0);

105 
	}
}

	@pte_generic_osal.h

29 #iâdeà
_GENERIC_OS_SUPPORT_H_


30 
	#_GENERIC_OS_SUPPORT_H_


	)

31 #ifdeà
__ılu¥lus


37 
	e±e_osResuÉ


41 
PTE_OS_OK
 = 0,

44 
PTE_OS_NO_RESOURCES
,

47 
PTE_OS_GENERAL_FAILURE
,

50 
PTE_OS_TIMEOUT
,

53 
PTE_OS_INTERRUPTED
,

56 
PTE_OS_INVALID_PARAM


59 } 
	t±e_osResuÉ
;

65 
±e_osResuÉ
 
±e_osIn™
();

79 
±e_osResuÉ
 
±e_osMu‹xC»©e
(
±e_osMu‹xHªdË
 *
pHªdË
);

88 
±e_osResuÉ
 
±e_osMu‹xD–‘e
(
±e_osMu‹xHªdË
 
hªdË
);

97 
±e_osResuÉ
 
±e_osMu‹xLock
(
±e_osMu‹xHªdË
 
hªdË
);

109 
±e_osResuÉ
 
±e_osMu‹xTimedLock
(
±e_osMu‹xHªdË
 
hªdË
, 
timeoutM£cs
);

118 
±e_osResuÉ
 
±e_osMu‹xUÆock
(
±e_osMu‹xHªdË
 
hªdË
);

123 (*
±e_osTh»adEÁryPošt
)(*
	t·¿ms
);

140 
±e_osResuÉ
 
±e_osTh»adC»©e
(
±e_osTh»adEÁryPošt
 
’ŒyPošt
,

141 
¡ackSize
,

142 
š™ŸlPriÜ™y
,

143 *
¬gv
,

144 
±e_osTh»adHªdË
* 
µ‹_osTh»adHªdË
);

153 
±e_osResuÉ
 
±e_osTh»adS¹
(
±e_osTh»adHªdË
 
osTh»adHªdË
);

160 
±e_osTh»adEx™
();

170 
±e_osResuÉ
 
±e_osTh»adWa™FÜEnd
(
±e_osTh»adHªdË
 
th»adHªdË
);

175 
±e_osTh»adHªdË
 
±e_osTh»adG‘HªdË
();

180 
±e_osTh»adG‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
);

187 
±e_osResuÉ
 
±e_osTh»adS‘PriÜ™y
(
±e_osTh»adHªdË
 
th»adHªdË
, 
ÃwPriÜ™y
);

194 
±e_osResuÉ
 
±e_osTh»adD–‘e
(
±e_osTh»adHªdË
 
hªdË
);

201 
±e_osResuÉ
 
±e_osTh»adEx™AndD–‘e
(
±e_osTh»adHªdË
 
hªdË
);

211 
±e_osResuÉ
 
±e_osTh»adCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
);

221 
±e_osResuÉ
 
±e_osTh»adCheckCªûl
(
±e_osTh»adHªdË
 
th»adHªdË
);

226 
±e_osTh»adSË•
(
m£cs
);

231 
±e_osTh»adG‘MaxPriÜ™y
();

236 
±e_osTh»adG‘MšPriÜ™y
();

242 
±e_osTh»adG‘DeçuÉPriÜ™y
();

259 
±e_osResuÉ
 
±e_osSem­hÜeC»©e
(
š™ŸlV®ue
, 
±e_osSem­hÜeHªdË
 *
pHªdË
);

268 
±e_osResuÉ
 
±e_osSem­hÜeD–‘e
(
±e_osSem­hÜeHªdË
 
hªdË
);

278 
±e_osResuÉ
 
±e_osSem­hÜePo¡
(
±e_osSem­hÜeHªdË
 
hªdË
, 
couÁ
);

291 
±e_osResuÉ
 
±e_osSem­hÜeP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
);

306 
±e_osResuÉ
 
±e_osSem­hÜeCªûÎabËP’d
(
±e_osSem­hÜeHªdË
 
hªdË
, *
pTimeout
);

319 
±e_osResuÉ
 
±e_osTlsS‘V®ue
(
key
, * 
v®ue
);

331 * 
±e_osTlsG‘V®ue
(
key
);

337 
±e_osTlsIn™
();

348 
±e_osResuÉ
 
±e_osTlsAÎoc
(*
pKey
);

357 
±e_osResuÉ
 
±e_osTlsF»e
(
key
);

377 
±e_osAtomicExchªge
(*
pT¬g
, 
v®
);

396 
±e_osAtomicCom·»Exchªge
(*
pde¡
, 
exchªge
, 
comp
);

412 
±e_osAtomicExchªgeAdd
(vŞ©e* 
pde¡
, 
v®ue
);

427 
±e_osAtomicDeüem’t
(*
pde¡
);

437 
±e_osAtomicInüem’t
(*
pde¡
);

440 
timeb
;

442 
áime
(
timeb
 *
tb
);

444 #ifdeà
__ılu¥lus


	@pte_getprocessors.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

62 
	$±e_g‘´oûssÜs
 (*
couÁ
)

64 
»suÉ
 = 0;

66 *
couÁ
 = 1;

68  (
»suÉ
);

69 
	}
}

	@pte_is_attr.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±e_is_©Œ
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
)

51  (
©Œ
 =ğ
NULL
 ||

52 *
©Œ
 =ğ
NULL
 || (*©Œ)->
v®id
 !ğ
PTE_ATTR_VALID
);

53 
	}
}

	@pte_mutex_check_need_init.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

48 
±h»ad_mu‹x©Œ_t_
 
	g±e_»cursive_mu‹x©Œ_s
 =

50 
PTHREAD_PROCESS_PRIVATE
, 
PTHREAD_MUTEX_RECURSIVE


52 
±h»ad_mu‹x©Œ_t_
 
	g±e_”rÜcheck_mu‹x©Œ_s
 =

54 
PTHREAD_PROCESS_PRIVATE
, 
PTHREAD_MUTEX_ERRORCHECK


56 
±h»ad_mu‹x©Œ_t
 
	g±e_»cursive_mu‹x©Œ
 = &
±e_»cursive_mu‹x©Œ_s
;

57 
±h»ad_mu‹x©Œ_t
 
	g±e_”rÜcheck_mu‹x©Œ
 = &
±e_”rÜcheck_mu‹x©Œ_s
;

61 
	$±e_mu‹x_check_Ãed_š™
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

63 
»suÉ
 = 0;

64 
±h»ad_mu‹x_t
 
mtx
;

89 
	`±e_osMu‹xLock
 (
±e_mu‹x_‹¡_š™_lock
);

99 
mtx
 = *
mu‹x
;

101 ià(
mtx
 =ğ
PTHREAD_MUTEX_INITIALIZER
)

103 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (
mu‹x
, 
NULL
);

105 ià(
mtx
 =ğ
PTHREAD_RECURSIVE_MUTEX_INITIALIZER
)

107 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (
mu‹x
, &
±e_»cursive_mu‹x©Œ
);

109 ià(
mtx
 =ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

111 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (
mu‹x
, &
±e_”rÜcheck_mu‹x©Œ
);

113 ià(
mtx
 =ğ
NULL
)

120 
»suÉ
 = 
EINVAL
;

123 
	`±e_osMu‹xUÆock
(
±e_mu‹x_‹¡_š™_lock
);

125  (
»suÉ
);

126 
	}
}

	@pte_new.c

46 
	~<Çutus/Çutus.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

52 
±h»ad_t


53 
	$±e_Ãw
 ()

55 
±h»ad_t
 
t
;

56 
±h»ad_t
 
n
 = {
NULL
, 0};

57 
±e_th»ad_t
 * 

;

62 
t
 = 
	`±e_th»adReu£Pİ
 ();

64 ià(
NULL
 !ğ
t
.
p
)

66 

 = (
±e_th»ad_t
 *è
t
.
p
;

71 

 = (
±e_th»ad_t
 *è
	`ÿÎoc
 (1, (pte_thread_t));

73 ià(

 =ğ
NULL
)

75  
n
;

79 
t
.
p
 = 

->
±HªdË
.p =p;

80 
t
.
x
 = 

->
±HªdË
.x = 0;

84 

->
sched_´iÜ™y
 = 
	`±e_osTh»adG‘MšPriÜ™y
();

86 

->
d‘achS‹
 = 
PTHREAD_CREATE_JOINABLE
;

87 

->
ÿnûlS‹
 = 
PTHREAD_CANCEL_ENABLE
;

88 

->
ÿnûlTy³
 = 
PTHREAD_CANCEL_DEFERRED
;

89 

->
ÿnûlLock
 = 
PTHREAD_MUTEX_INITIALIZER
;

90 

->
th»adLock
 = 
PTHREAD_MUTEX_INITIALIZER
;

92  
t
;

94 
	}
}

	@pte_relmillisecs.c

43 
	~"nk/±e_o§l.h
"

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

48 
	tšt64_t
;

51 
	$±e_»lmli£cs
 (cÚ¡ 
time¥ec
 * 
ab¡ime
)

53 cÚ¡ 
NANOSEC_PER_MILLISEC
 = 1000000;

54 cÚ¡ 
MILLISEC_PER_SEC
 = 1000;

55 
mli£cÚds
;

56 
tmpAbsMli£cÚds
;

57 
tmpCu¼Mli£cÚds
;

58 
timeb
 
cu¼SysTime
;

71 
tmpAbsMli£cÚds
 = (
št64_t
)
ab¡ime
->
tv_£c
 * 
MILLISEC_PER_SEC
;

72 
tmpAbsMli£cÚds
 +ğ((
št64_t
)
ab¡ime
->
tv_n£c
 + (
NANOSEC_PER_MILLISEC
/2)) / NANOSEC_PER_MILLISEC;

76 
	`_áime
(&
cu¼SysTime
);

78 
tmpCu¼Mli£cÚds
 = (
št64_t
è
cu¼SysTime
.
time
 * 
MILLISEC_PER_SEC
;

79 
tmpCu¼Mli£cÚds
 +ğ(
št64_t
è
cu¼SysTime
.
ml™m
;

81 ià(
tmpAbsMli£cÚds
 > 
tmpCu¼Mli£cÚds
)

83 
mli£cÚds
 = (è(
tmpAbsMli£cÚds
 - 
tmpCu¼Mli£cÚds
);

84 ià(
mli£cÚds
 == 0xFFFFFFFF)

87 
mli£cÚds
--;

93 
mli£cÚds
 = 0;

96  
mli£cÚds
;

97 
	}
}

	@pte_reuse.c

47 
	~<Çutus/Çutus.h
>

48 
	~<Çutus/Çut_¡ršg.h
>

49 
	~"±h»ad.h
"

50 
	~"im¶em’t.h
"

86 
±h»ad_t


87 
	$±e_th»adReu£Pİ
 ()

89 
±h»ad_t
 
t
 = {
NULL
, 0};

92 
	`±e_osMu‹xLock
 (
±e_th»ad_»u£_lock
);

94 ià(
PTE_THREAD_REUSE_EMPTY
 !ğ
±e_th»adReu£Tİ
)

96 
±e_th»ad_t
 * 

;

98 

 = 
±e_th»adReu£Tİ
;

100 
±e_th»adReu£Tİ
 = 

->
´evReu£
;

102 ià(
PTE_THREAD_REUSE_EMPTY
 =ğ
±e_th»adReu£Tİ
)

104 
±e_th»adReu£BÙtom
 = 
PTE_THREAD_REUSE_EMPTY
;

107 

->
´evReu£
 = 
NULL
;

109 
t
 = 

->
±HªdË
;

112 
	`±e_osMu‹xUÆock
(
±e_th»ad_»u£_lock
);

114  
t
;

116 
	}
}

125 
	$±e_th»adReu£Push
 (
±h»ad_t
 
th»ad
)

127 
±e_th»ad_t
 * 

 = (±e_th»ad_ˆ*è
th»ad
.
p
;

128 
±h»ad_t
 
t
;

131 
	`±e_osMu‹xLock
 (
±e_th»ad_»u£_lock
);

133 
t
 = 

->
±HªdË
;

134 
	`mem£t
(

, 0, (
±e_th»ad_t
));

137 

->
±HªdË
 = 
t
;

140 #ifdeà
PTE_THREAD_ID_REUSE_INCREMENT


141 

->
±HªdË
.
x
 +ğ
PTE_THREAD_ID_REUSE_INCREMENT
;

143 

->
±HªdË
.
x
++;

146 

->
´evReu£
 = 
PTE_THREAD_REUSE_EMPTY
;

148 ià(
PTE_THREAD_REUSE_EMPTY
 !ğ
±e_th»adReu£BÙtom
)

150 
±e_th»adReu£BÙtom
->
´evReu£
 = 

;

154 
±e_th»adReu£Tİ
 = 

;

157 
±e_th»adReu£BÙtom
 = 

;

159 
	`±e_osMu‹xUÆock
(
±e_th»ad_»u£_lock
);

160 
	}
}

	@pte_rwlock_cancelwrwait.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±e_rwlock_ÿnûlwrwa™
 (*
¬g
)

49 
±h»ad_rwlock_t
 
rwl
 = (±h»ad_rwlock_tè
¬g
;

51 
rwl
->
nSh¬edAcûssCouÁ
 = -rwl->
nCom¶‘edSh¬edAcûssCouÁ
;

52 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

54 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

55 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

56 
	}
}

	@pte_rwlock_check_need_init.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

48 
	$±e_rwlock_check_Ãed_š™
 (
±h»ad_rwlock_t
 * 
rwlock
)

50 
»suÉ
 = 0;

75 
	`±e_osMu‹xLock
 (
±e_rwlock_‹¡_š™_lock
);

85 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

87 
»suÉ
 = 
	`±h»ad_rwlock_š™
 (
rwlock
, 
NULL
);

89 ià(*
rwlock
 =ğ
NULL
)

96 
»suÉ
 = 
EINVAL
;

99 
	`±e_osMu‹xUÆock
(
±e_rwlock_‹¡_š™_lock
);

101  
»suÉ
;

102 
	}
}

	@pte_spinlock_check_need_init.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±e_¥šlock_check_Ãed_š™
 (
±h»ad_¥šlock_t
 * 
lock
)

50 
»suÉ
 = 0;

62 
	`±e_osMu‹xLock
 (
±e_¥šlock_‹¡_š™_lock
);

72 ià(*
lock
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

74 
»suÉ
 = 
	`±h»ad_¥š_š™
 (
lock
, 
PTHREAD_PROCESS_PRIVATE
);

76 ià(*
lock
 =ğ
NULL
)

83 
»suÉ
 = 
EINVAL
;

86 
	`±e_osMu‹xUÆock
(
±e_¥šlock_‹¡_š™_lock
);

88  (
»suÉ
);

89 
	}
}

	@pte_threadDestroy.c

47 
	~<Çutus/Çutus.h
>

48 
	~<Çutus/Çut_¡ršg.h
>

49 
	~"±h»ad.h
"

50 
	~"im¶em’t.h
"

55 
	$±e_th»adDe¡royCommÚ
 (
±h»ad_t
 
th»ad
, 
shouldTh»adEx™
)

57 
±e_th»ad_t
 * 

 = (±e_th»ad_ˆ*è
th»ad
.
p
;

58 
±e_th»ad_t
 
th»adCİy
;

60 ià(

 !ğ
NULL
)

65 
	`memıy
 (&
th»adCİy
, 

,  (threadCopy));

71 
	`±e_th»adReu£Push
 (
th»ad
);

73 (è
	`±h»ad_mu‹x_de¡roy
(&
th»adCİy
.
ÿnûlLock
);

74 (è
	`±h»ad_mu‹x_de¡roy
(&
th»adCİy
.
th»adLock
);

76 ià(
th»adCİy
.
th»adId
 != 0)

78 ià(
shouldTh»adEx™
)

80 
	`±e_osTh»adEx™AndD–‘e
(
th»adCİy
.
th»adId
);

84 
	`±e_osTh»adD–‘e
(
th»adCİy
.
th»adId
);

91 
	}
}

93 
	$±e_th»adDe¡roy
 (
±h»ad_t
 
th»ad
)

95 
	`±e_th»adDe¡royCommÚ
(
th»ad
,0);

96 
	}
}

98 
	$±e_th»adEx™AndDe¡roy
 (
±h»ad_t
 
th»ad
)

100 
	`±e_th»adDe¡royCommÚ
(
th»ad
,1);

101 
	}
}

	@pte_threadStart.c

47 
	~<Çutus/Çutus.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

51 #ià
defšed
(
PTE_CLEANUP_CXX
)

53 #ià
defšed
(
__GNUC__
) && __GNUC__ < 3

54 
	~<Ãw
>

56 
	~<Ãw
>

57 
usšg


58 
	g¡d
::
‹rmš©e_hªdËr
;

59 
usšg


60 
	g¡d
::
‹rmš©e
;

61 
usšg


62 
	g¡d
::
£t_‹rmš©e
;

65 
‹rmš©e_hªdËr
 
	t‹rmš©e_funùiÚ
;

67 
‹rmš©e_funùiÚ
 
	g±e_ŞdT”mš©e
;

70 
	$±e_‹rmš©e
 ()

72 
	`£t_‹rmš©e
 (
±e_ŞdT”mš©e
);

73 (è
	`±e_th»ad_d‘ach_Å
();

75 
	}
}

79 
	$±e_th»adS¹
 (*
vth»adP¬ms
, ** 
out
)

81 
Th»adP¬ms
 * 
th»adP¬ms
 = (Th»adP¬m *è
vth»adP¬ms
;

82 
±h»ad_t
 
£lf
;

83 
±e_th»ad_t
 * 
¥
;

84 *(*
¡¬t
) (*);

85 * 
¬g
;

87 #ifdeà
PTE_CLEANUP_C


88 
	~<Çutus/£tjmp.h
>

89 
£tjmp_rc
;

92 * 
¡©us
 = (*) 0;

94 
£lf
 = 
th»adP¬ms
->
tid
;

95 
¥
 = (
±e_th»ad_t
 *è
£lf
.
p
;

96 
¡¬t
 = 
th»adP¬ms
->start;

97 
¬g
 = 
th»adP¬ms
->arg;

100 
	`±h»ad_£t¥ecific
 (
±e_£lfTh»adKey
, 
¥
);

102 
¥
->
¡©e
 = 
PTh»adS‹RuÂšg
;

104 #ifdeà
PTE_CLEANUP_C


107 
£tjmp_rc
 = 
	`£tjmp
 (
¥
->
¡¬t_m¬k
);

110 ià(0 =ğ
£tjmp_rc
)

116 
¥
->
ex™Stus
 = 
¡©us
 = (*
¡¬t
è(
¬g
);

120 
£tjmp_rc
)

122 
PTE_EPS_CANCEL
:

123 
¡©us
 = 
¥
->
ex™Stus
 = 
PTHREAD_CANCELED
;

125 
PTE_EPS_EXIT
:

126 
¡©us
 = 
¥
->
ex™Stus
;

129 
¡©us
 = 
¥
->
ex™Stus
 = 
PTHREAD_CANCELED
;

136 #ifdeà
PTE_CLEANUP_CXX


138 
±e_ŞdT”mš©e
 = 
	`£t_‹rmš©e
 (&
±e_‹rmš©e
);

140 
Œy


147 
Œy


149 
¡©us
 = 
¥
->
ex™Stus
 = (*
¡¬t
è(
¬g
);

151 
	`ÿtch
 (
±e_exû±iÚ
 &)

156 
throw
;

158 
	`ÿtch
 (...)

169 
‹rmš©e_funùiÚ


170 
‹rm_func
 = 
	`£t_‹rmš©e
 (0);

171 
	`£t_‹rmš©e
 (
‹rm_func
);

173 ià(
‹rm_func
 != 0)

175 
	`‹rm_func
 ();

178 
throw
;

181 
	`ÿtch
 (
±e_exû±iÚ_ÿnûl
 &)

186 
¡©us
 = 
¥
->
ex™Stus
 = 
PTHREAD_CANCELED
;

188 
	`ÿtch
 (
±e_exû±iÚ_ex™
 &)

193 
¡©us
 = 
¥
->
ex™Stus
;

195 
	`ÿtch
 (...)

202 
¡©us
 = 
¥
->
ex™Stus
 = 
PTHREAD_CANCELED
;

203 (è
	`±h»ad_mu‹x_lock
 (&
¥
->
ÿnûlLock
);

204 
¥
->
¡©e
 = 
PTh»adS‹Exû±iÚ
;

205 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

206 (è
	`±e_th»ad_d‘ach_Å
();

207 (è
	`£t_‹rmš©e
 (
±e_ŞdT”mš©e
);

208 
throw
;

215 (è
	`£t_‹rmš©e
 (
±e_ŞdT”mš©e
);

219 #”rÜ 
ERROR
 [
__FILE__
, 
lše
 
__LINE__
]: 
CËªup
 
ty³
 
undefšed
.

237 (è
	`±e_th»ad_d‘ach_ªd_ex™_Å
 ();

245  (è
¡©us
;

247 
	}
}

	@pte_throw.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

58 
	$±e_throw
 (
exû±iÚ
)

64 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
	`±h»ad_g‘¥ecific
 (
±e_£lfTh»adKey
);

67 ià(
exû±iÚ
 !ğ
PTE_EPS_CANCEL
 &&ƒxû±iÚ !ğ
PTE_EPS_EXIT
)

70 
	`ex™
 (1);

73 ià(
NULL
 =ğ
¥
 || sp->
im¶ic™
)

81 
ex™Code
 = 0;

83 
exû±iÚ
)

85 
PTE_EPS_CANCEL
:

86 
ex™Code
 = (è
PTHREAD_CANCELED
;

88 
PTE_EPS_EXIT
:

89 
ex™Code
 = (è
¥
->
ex™Stus
;;

93 
	`±e_th»ad_d‘ach_ªd_ex™_Å
 ();

99 #ifdeà
PTE_CLEANUP_C


101 
	`±e_pİ_ş—nup_®l
 (1);

102 
	`lÚgjmp
 (
¥
->
¡¬t_m¬k
, 
exû±iÚ
);

106 #ifdeà
PTE_CLEANUP_CXX


108 
exû±iÚ
)

110 
PTE_EPS_CANCEL
:

111 
throw
 
	`±e_exû±iÚ_ÿnûl
 ();

113 
PTE_EPS_EXIT
:

114 
throw
 
	`±e_exû±iÚ_ex™
 ();

120 #”rÜ 
ERROR
 [
__FILE__
, 
lše
 
__LINE__
]: 
CËªup
 
ty³
 
undefšed
.

127 
	}
}

131 
	$±e_pİ_ş—nup_®l
 (
execu‹
)

133 
NULL
 !ğ
	`±e_pİ_ş—nup
 (
execu‹
))

136 
	}
}

140 
	$±e_g‘_exû±iÚ_£rviûs_code
 ()

142  (è
NULL
;

143 
	}
}

	@pte_tkAssocCreate.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±e_tkAssocC»©e
 (
±e_th»ad_t
 * 
¥
, 
±h»ad_key_t
 
key
)

84 
Th»adKeyAssoc
 *
assoc
;

93 
assoc
 = (
Th»adKeyAssoc
 *è
	`ÿÎoc
 (1,  (*assoc));

95 ià(
assoc
 =ğ
NULL
)

97  
ENOMEM
;

100 
assoc
->
th»ad
 = 
¥
;

101 
assoc
->
key
 = key;

106 
assoc
->
´evTh»ad
 = 
NULL
;

107 
assoc
->
ÃxtTh»ad
 = (
Th»adKeyAssoc
 *è
key
->
th»ads
;

108 ià(
assoc
->
ÃxtTh»ad
 !ğ
NULL
)

110 
assoc
->
ÃxtTh»ad
->
´evTh»ad
 =‡ssoc;

112 
key
->
th»ads
 = (*è
assoc
;

117 
assoc
->
´evKey
 = 
NULL
;

118 
assoc
->
ÃxtKey
 = (
Th»adKeyAssoc
 *è
¥
->
keys
;

119 ià(
assoc
->
ÃxtKey
 !ğ
NULL
)

121 
assoc
->
ÃxtKey
->
´evKey
 =‡ssoc;

123 
¥
->
keys
 = (*è
assoc
;

127 
	}
}

	@pte_tkAssocDestroy.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±e_tkAssocDe¡roy
 (
Th»adKeyAssoc
 * 
assoc
)

72 ià(
assoc
 !ğ
NULL
)

74 
Th»adKeyAssoc
 * 
´ev
, * 
Ãxt
;

77 
´ev
 = 
assoc
->
´evKey
;

78 
Ãxt
 = 
assoc
->
ÃxtKey
;

79 ià(
´ev
 !ğ
NULL
)

81 
´ev
->
ÃxtKey
 = 
Ãxt
;

83 ià(
Ãxt
 !ğ
NULL
)

85 
Ãxt
->
´evKey
 = 
´ev
;

88 ià(
assoc
->
th»ad
->
keys
 ==‡ssoc)

91 
assoc
->
th»ad
->
keys
 = 
Ãxt
;

93 ià(
assoc
->
th»ad
->
ÃxtAssoc
 ==‡ssoc)

99 
assoc
->
th»ad
->
ÃxtAssoc
 = 
Ãxt
;

103 
´ev
 = 
assoc
->
´evTh»ad
;

104 
Ãxt
 = 
assoc
->
ÃxtTh»ad
;

105 ià(
´ev
 !ğ
NULL
)

107 
´ev
->
ÃxtTh»ad
 = 
Ãxt
;

109 ià(
Ãxt
 !ğ
NULL
)

111 
Ãxt
->
´evTh»ad
 = 
´ev
;

114 ià(
assoc
->
key
->
th»ads
 ==‡ssoc)

117 
assoc
->
key
->
th»ads
 = 
Ãxt
;

120 
	`ä“
 (
assoc
);

123 
	}
}

	@pthread.h

44 #ià!
defšed
Ğ
PTHREAD_H
 )

45 
	#PTHREAD_H


	)

47 
	~"nk/±e_ty³s.h
"

49 
	~"sched.h
"

51 
	#PTE_VERSION
 2,8,0,0

	)

52 
	#PTE_VERSION_STRING
 "2, 8, 0, 0\0"

	)

76 #ià!
defšed
Ğ
PTE_CLEANUP_CXX
 ) && !defšedĞ
PTE_CLEANUP_C
 )

77 
	#PTE_CLEANUP_C


	)

80 #undeà
PTE_LEVEL


82 #ià
defšed
(
_POSIX_SOURCE
)

83 
	#PTE_LEVEL
 0

	)

87 #ià
defšed
(
_POSIX_C_SOURCE
) && _POSIX_C_SOURCE >= 199309

88 #undeà
PTE_LEVEL


89 
	#PTE_LEVEL
 1

	)

93 #ià
defšed
(
INCLUDE_NP
)

94 #undeà
PTE_LEVEL


95 
	#PTE_LEVEL
 2

	)

99 
	#PTE_LEVEL_MAX
 3

	)

101 #ià!
defšed
(
PTE_LEVEL
)

102 
	#PTE_LEVEL
 
PTE_LEVEL_MAX


	)

181 
	~<Çutus/£tjmp.h
>

182 
	~<lim™s.h
>

189 
	mPTE_FALSE
 = 0,

190 
	mPTE_TRUE
 = (! 
PTE_FALSE
)

284 #undeà
_POSIX_THREADS


285 
	#_POSIX_THREADS
 200112L

	)

287 #undeà
_POSIX_READER_WRITER_LOCKS


288 
	#_POSIX_READER_WRITER_LOCKS
 200112L

	)

290 #undeà
_POSIX_SPIN_LOCKS


291 
	#_POSIX_SPIN_LOCKS
 200112L

	)

293 #undeà
_POSIX_BARRIERS


294 
	#_POSIX_BARRIERS
 200112L

	)

296 #undeà
_POSIX_THREAD_SAFE_FUNCTIONS


297 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200112L

	)

299 #undeà
_POSIX_THREAD_ATTR_STACKSIZE


300 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200112L

	)

305 #undeà
_POSIX_THREAD_ATTR_STACKADDR


306 
	#_POSIX_THREAD_ATTR_STACKADDR
 -1

	)

308 #undeà
_POSIX_THREAD_PRIO_INHERIT


309 
	#_POSIX_THREAD_PRIO_INHERIT
 -1

	)

311 #undeà
_POSIX_THREAD_PRIO_PROTECT


312 
	#_POSIX_THREAD_PRIO_PROTECT
 -1

	)

315 #undeà
_POSIX_THREAD_PRIORITY_SCHEDULING


316 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 -1

	)

318 #undeà
_POSIX_THREAD_PROCESS_SHARED


319 
	#_POSIX_THREAD_PROCESS_SHARED
 -1

	)

354 #undeà
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


355 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

357 #undeà
PTHREAD_DESTRUCTOR_ITERATIONS


358 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

360 #undeà
_POSIX_THREAD_KEYS_MAX


361 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

363 #undeà
PTHREAD_KEYS_MAX


364 
	#PTHREAD_KEYS_MAX
 
_POSIX_THREAD_KEYS_MAX


	)

366 #undeà
PTHREAD_STACK_MIN


367 
	#PTHREAD_STACK_MIN
 0

	)

369 #undeà
_POSIX_THREAD_THREADS_MAX


370 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

373 #undeà
PTHREAD_THREADS_MAX


374 
	#PTHREAD_THREADS_MAX
 2019

	)

376 #undeà
_POSIX_SEM_NSEMS_MAX


377 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

380 #undeà
SEM_NSEMS_MAX


381 
	#SEM_NSEMS_MAX
 1024

	)

383 #undeà
_POSIX_SEM_VALUE_MAX


384 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

386 #undeà
SEM_VALUE_MAX


387 
	#SEM_VALUE_MAX
 
INT_MAX


	)

397 * 
	mp
;

398 
	mx
;

401 } 
	t±e_hªdË_t
;

403 
±e_hªdË_t
 
	t±h»ad_t
;

404 
±h»ad_©Œ_t_
 * 
	t±h»ad_©Œ_t
;

405 
±h»ad_Úû_t_
 
	t±h»ad_Úû_t
;

406 
±h»ad_key_t_
 * 
	t±h»ad_key_t
;

407 
±h»ad_mu‹x_t_
 * 
	t±h»ad_mu‹x_t
;

408 
±h»ad_mu‹x©Œ_t_
 * 
	t±h»ad_mu‹x©Œ_t
;

409 
±h»ad_cÚd_t_
 * 
	t±h»ad_cÚd_t
;

410 
±h»ad_cÚd©Œ_t_
 * 
	t±h»ad_cÚd©Œ_t
;

411 
±h»ad_rwlock_t_
 * 
	t±h»ad_rwlock_t
;

412 
±h»ad_rwlock©Œ_t_
 * 
	t±h»ad_rwlock©Œ_t
;

413 
±h»ad_¥šlock_t_
 * 
	t±h»ad_¥šlock_t
;

414 
±h»ad_b¬r›r_t_
 * 
	t±h»ad_b¬r›r_t
;

415 
±h»ad_b¬r›¿‰r_t_
 * 
	t±h»ad_b¬r›¿‰r_t
;

430 
	mPTHREAD_CREATE_JOINABLE
 = 0,

431 
	mPTHREAD_CREATE_DETACHED
 = 1,

436 
	mPTHREAD_INHERIT_SCHED
 = 0,

437 
	mPTHREAD_EXPLICIT_SCHED
 = 1,

442 
	mPTHREAD_SCOPE_PROCESS
 = 0,

443 
	mPTHREAD_SCOPE_SYSTEM
 = 1,

444 
	mPTHREAD_SCOPE_PROCESS_VFPU
 = 2,

449 
	mPTHREAD_CANCEL_ENABLE
 = 0,

450 
	mPTHREAD_CANCEL_DISABLE
 = 1,

455 
	mPTHREAD_CANCEL_ASYNCHRONOUS
 = 0,

456 
	mPTHREAD_CANCEL_DEFERRED
 = 1,

462 
	mPTHREAD_PROCESS_PRIVATE
 = 0,

463 
	mPTHREAD_PROCESS_SHARED
 = 1,

468 
	mPTHREAD_BARRIER_SERIAL_THREAD
 = -1

478 
	#PTHREAD_CANCELED
 ((*è-1)

	)

488 
	#PTHREAD_ONCE_INIT
 { 
PTE_FALSE
, 0, 0, 0}

	)

490 
	s±h»ad_Úû_t_


492 
	m¡©e
;

493 * 
	m£m­hÜe
;

494 
	mnumSem­hÜeU£rs
;

495 
	mdÚe
;

509 
	#PTHREAD_MUTEX_INITIALIZER
 ((
±h»ad_mu‹x_t
è-1)

	)

510 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER
 ((
±h»ad_mu‹x_t
è-2)

	)

511 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
 ((
±h»ad_mu‹x_t
è-3)

	)

516 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 
PTHREAD_RECURSIVE_MUTEX_INITIALIZER


	)

517 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER


	)

519 
	#PTHREAD_COND_INITIALIZER
 ((
±h»ad_cÚd_t
è-1)

	)

521 
	#PTHREAD_RWLOCK_INITIALIZER
 ((
±h»ad_rwlock_t
è-1)

	)

523 
	#PTHREAD_SPINLOCK_INITIALIZER
 ((
±h»ad_¥šlock_t
è-1)

	)

532 
	mPTHREAD_MUTEX_FAST_NP
,

533 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

534 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

535 
	mPTHREAD_MUTEX_TIMED_NP
 = 
PTHREAD_MUTEX_FAST_NP
,

536 
	mPTHREAD_MUTEX_ADAPTIVE_NP
 = 
PTHREAD_MUTEX_FAST_NP
,

538 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_FAST_NP
,

539 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

540 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

541 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


545 
±e_ş—nup_t
 
	t±e_ş—nup_t
;

547 (* 
	t±e_ş—nup_ÿÎback_t
)(*);

549 
	s±e_ş—nup_t


551 
±e_ş—nup_ÿÎback_t
 
routše
;

552 *
¬g
;

553 
±e_ş—nup_t
 *
´ev
;

556 #ifdeà
PTE_CLEANUP_C


562 
	#±h»ad_ş—nup_push
Ğ
_rout
, 
_¬g
 ) \

564 
±e_ş—nup_t
 
_ş—nup
; \

566 
	`±e_push_ş—nup
Ğ&
_ş—nup
, (
±e_ş—nup_ÿÎback_t
è(
_rout
), (
_¬g
) ); \

567 

	)

568 
	#±h»ad_ş—nup_pİ
Ğ
_execu‹
 ) \

569 (è
	`±e_pİ_ş—nup
Ğ
_execu‹
 ); \

570 
	}

	)
}

574 #ifdeà
PTE_CLEANUP_CXX


581 şas 
	cPTh»adCËªup


595 
±e_ş—nup_ÿÎback_t
 
	mş—nUpRout
;

596 * 
	mobj
;

597 
	mexecu‹It
;

599 
	mpublic
:

600 
	$PTh»adCËªup
() :

601 
	`ş—nUpRout
( 0 ),

602 
	`obj
( 0 ),

603 
	$execu‹It
( 0 )

610 
	$PTh»adCËªup
(

611 
±e_ş—nup_ÿÎback_t
 
routše
,

612 * 
¬g
 ) :

613 
	`ş—nUpRout
Ğ
routše
 ),

614 
	`obj
Ğ
¬g
 ),

615 
	$execu‹It
( 1 )

620 
	}
}

622 ~
	$PTh»adCËªup
()

624 iàĞ
execu‹It
 )

626 (è(*
ş—nUpRout
)Ğ
obj
 );

628 
	}
}

630 
	$execu‹
Ğ
exec
 )

632 
execu‹It
 = 
exec
;

633 
	}
}

642 
	#±h»ad_ş—nup_push
Ğ
_rout
, 
_¬g
 ) \

644 
PTh»adCËªup
 
	`ş—nup
((
±e_ş—nup_ÿÎback_t
)(
_rout
), \

645 (*è(
_¬g
è);

	)

647 
	#±h»ad_ş—nup_pİ
Ğ
_execu‹
 ) \

648 
ş—nup
.
	`execu‹
Ğ
_execu‹
 ); \

649 }

	)

653 #”rÜ 
ERROR
 [
__FILE__
, 
lše
 
__LINE__
]: 
CËªup
 
ty³
 
undefšed
.

667 
±h»ad_š™
 ();

668 
±h»ad_‹rmš©e
 ();

673 
±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 * 
©Œ
);

675 
±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 * 
©Œ
);

677 
±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

678 *
d‘ach¡©e
);

680 
±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

681 **
¡ackaddr
);

683 
±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

684 
size_t
 * 
¡acksize
);

685 
±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

686 **
¡ackaddr
,

687 
size_t
 *
¡acksize
);

688 
±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 * 
©Œ
,

689 
d‘ach¡©e
);

691 
±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 * 
©Œ
,

692 *
¡ackaddr
);

694 
±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 * 
©Œ
,

695 
size_t
 
¡acksize
);

697 
±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
©Œ
,

698 
sched_·¿m
 *
·¿m
);

700 
±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
©Œ
,

701 cÚ¡ 
sched_·¿m
 *
·¿m
);

703 
±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *,

706 
±h»ad_©Œ_g‘schedpŞicy
 (
±h»ad_©Œ_t
 *,

709 
±h»ad_©Œ_£tšh”™sched
(
±h»ad_©Œ_t
 * 
©Œ
,

710 
šh”™sched
);

712 
±h»ad_©Œ_g‘šh”™sched
(
±h»ad_©Œ_t
 * 
©Œ
,

713 * 
šh”™sched
);

715 
±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *,

718 
±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *,

724 
±h»ad_ü—‹
 (
±h»ad_t
 * 
tid
,

725 cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

726 *(*
¡¬t
) (*),

727 *
¬g
);

729 
±h»ad_d‘ach
 (
±h»ad_t
 
tid
);

731 
±h»ad_equ®
 (
±h»ad_t
 
t1
,

732 
±h»ad_t
 
t2
);

734 
±h»ad_ex™
 (*
v®ue_±r
);

736 
±h»ad_još
 (
±h»ad_t
 
th»ad
,

737 **
v®ue_±r
);

739 
±h»ad_t
 
±h»ad_£lf
 ();

742 
±h»ad_g‘©Œ_Å
(
±h»ad_t
 
th»ad
, 
±h»ad_©Œ_t
 * 
©Œ
);

744 
±h»ad_ÿnûl
 (
±h»ad_t
 
th»ad
);

746 
±h»ad_£tÿnûl¡©e
 (
¡©e
,

747 *
Şd¡©e
);

749 
±h»ad_£tÿnûÉy³
 (
ty³
,

750 *
Şdty³
);

752 
±h»ad_‹¡ÿnûl
 ();

754 
±h»ad_Úû
 (
±h»ad_Úû_t
 * 
Úû_cÚŒŞ
,

755 (*
š™_routše
) ());

757 #ià
PTE_LEVEL
 >ğ
PTE_LEVEL_MAX


758 
±e_ş—nup_t
 * 
	`±e_pİ_ş—nup
 (
execu‹
);

760 
	`±e_push_ş—nup
 (
±e_ş—nup_t
 * 
ş—nup
,

761 (*
routše
) (*),

762 *
¬g
);

768 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 * 
key
,

769 (*
de¡ruùÜ
) (*));

771 
	`±h»ad_key_d–‘e
 (
±h»ad_key_t
 
key
);

773 
	`±h»ad_£t¥ecific
 (
±h»ad_key_t
 
key
,

774 cÚ¡ *
v®ue
);

776 * 
	`±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
key
);

782 
	`±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
);

784 
	`±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
);

786 
	`±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t


787 * 
©Œ
,

788 *
psh¬ed
);

790 
	`±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
,

791 
psh¬ed
);

793 
	`±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, 
kšd
);

794 
	`±h»ad_mu‹x©Œ_g‘ty³
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, *
kšd
);

799 
	`±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
);

801 
	`±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
);

803 
	`±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t


804 * 
©Œ
,

805 *
psh¬ed
);

807 
	`±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
,

808 
psh¬ed
);

813 
	`±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 * 
mu‹x
,

814 cÚ¡ 
±h»ad_mu‹x©Œ_t
 * 
©Œ
);

816 
	`±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

818 
	`±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

820 
	`±h»ad_mu‹x_timedlock
(
±h»ad_mu‹x_t
 *
mu‹x
,

821 cÚ¡ 
time¥ec
 *
ab¡ime
);

823 
	`±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

825 
	`±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 * 
mu‹x
);

830 
	`±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 * 
lock
, 
psh¬ed
);

832 
	`±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 * 
lock
);

834 
	`±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 * 
lock
);

836 
	`±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 * 
lock
);

838 
	`±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 * 
lock
);

843 
	`±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
,

844 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 * 
©Œ
,

845 
couÁ
);

847 
	`±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
);

849 
	`±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
);

854 
	`±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
);

856 
	`±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
);

858 
	`±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 * 
©Œ
,

859 *
psh¬ed
);

861 
	`±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
,

862 
psh¬ed
);

867 
	`±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 * 
cÚd
,

868 cÚ¡ 
±h»ad_cÚd©Œ_t
 * 
©Œ
);

870 
	`±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 * 
cÚd
);

872 
	`±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 * 
cÚd
,

873 
±h»ad_mu‹x_t
 * 
mu‹x
);

875 
	`±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 * 
cÚd
,

876 
±h»ad_mu‹x_t
 * 
mu‹x
,

877 cÚ¡ 
time¥ec
 *
ab¡ime
);

879 
	`±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 * 
cÚd
);

881 
	`±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 * 
cÚd
);

886 
	`±h»ad_£tsched·¿m
 (
±h»ad_t
 
th»ad
,

887 
pŞicy
,

888 cÚ¡ 
sched_·¿m
 *
·¿m
);

890 
	`±h»ad_g‘sched·¿m
 (
±h»ad_t
 
th»ad
,

891 *
pŞicy
,

892 
sched_·¿m
 *
·¿m
);

894 
	`±h»ad_£tcÚcu¼’cy
 ();

896 
	`±h»ad_g‘cÚcu¼’cy
 ();

901 
	`±h»ad_rwlock_š™
(
±h»ad_rwlock_t
 *
lock
,

902 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
©Œ
);

904 
	`±h»ad_rwlock_de¡roy
(
±h»ad_rwlock_t
 *
lock
);

906 
	`±h»ad_rwlock_Œyrdlock
(
±h»ad_rwlock_t
 *);

908 
	`±h»ad_rwlock_Œyw¾ock
(
±h»ad_rwlock_t
 *);

910 
	`±h»ad_rwlock_rdlock
(
±h»ad_rwlock_t
 *
lock
);

912 
	`±h»ad_rwlock_timedrdlock
(
±h»ad_rwlock_t
 *
lock
,

913 cÚ¡ 
time¥ec
 *
ab¡ime
);

915 
	`±h»ad_rwlock_w¾ock
(
±h»ad_rwlock_t
 *
lock
);

917 
	`±h»ad_rwlock_timedw¾ock
(
±h»ad_rwlock_t
 *
lock
,

918 cÚ¡ 
time¥ec
 *
ab¡ime
);

920 
	`±h»ad_rwlock_uÆock
(
±h»ad_rwlock_t
 *
lock
);

922 
	`±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
);

924 
	`±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
);

926 
	`±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 * 
©Œ
,

927 *
psh¬ed
);

929 
	`±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
,

930 
psh¬ed
);

932 #ià
PTE_LEVEL
 >ğ
PTE_LEVEL_MAX
 - 1

938 
	`±h»ad_kl
(
±h»ad_t
 
th»ad
, 
sig
);

947 
	`±h»ad_mu‹x©Œ_£tkšd_Å
(
±h»ad_mu‹x©Œ_t
 * 
©Œ
,

948 
kšd
);

949 
	`±h»ad_mu‹x©Œ_g‘kšd_Å
(
±h»ad_mu‹x©Œ_t
 * 
©Œ
,

950 *
kšd
);

955 
	`±h»ad_d–ay_Å
 (
time¥ec
 * 
š‹rv®
);

956 
	`±h»ad_num_´oûssÜs_Å
();

966 * 
	`±h»ad_timechªge_hªdËr_Å
(*);

970 #ià
PTE_LEVEL
 >ğ
PTE_LEVEL_MAX


979 
	#_áime
 
áime


	)

980 
	#_timeb
 
timeb


	)

982 #ifdeà
__ılu¥lus


987 şas 
	c±e_exû±iÚ
 {};

988 şas 
	c±e_exû±iÚ_ÿnûl
 : 
public
 
±e_exû±iÚ
 {};

989 şas 
	c±e_exû±iÚ_ex™
 : 
public
 
±e_exû±iÚ
 {};

994 #ifdeà
PTE_CXX_EXCEPTIONS


1000 
	#ÿtch
Ğ
E
 ) \

1001 
	`ÿtch
Ğ
±e_exû±iÚ
 & ) { 
throw
; 
	}
} \

1002 
	`ÿtch
Ğ
E
 )

	)

1006 #undeà
PTE_LEVEL


1007 #undeà
PTE_LEVEL_MAX


	@pthread_attr_destroy.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 * 
©Œ
)

75 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

77  
EINVAL
;

83 (*
©Œ
)->
v®id
 = 0;

84 
	`ä“
 (*
©Œ
);

85 *
©Œ
 = 
NULL
;

88 
	}
}

	@pthread_attr_getdetachstate.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, *
d‘ach¡©e
)

85 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
d‘ach¡©e
 =ğ
NULL
)

87 *
d‘ach¡©e
 = 
PTHREAD_CREATE_DETACHED
;

88  
EINVAL
;

91 *
d‘ach¡©e
 = (*
©Œ
)->detachstate;

93 
	}
}

	@pthread_attr_getinheritsched.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_©Œ_g‘šh”™sched
 (
±h»ad_©Œ_t
 * 
©Œ
, *
šh”™sched
)

50 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
šh”™sched
 =ğ
NULL
)

52  
EINVAL
;

55 *
šh”™sched
 = (*
©Œ
)->inheritsched;

57 
	}
}

	@pthread_attr_getschedparam.c

46 
	~<Çutus/Çutus.h
>

47 
	~<Çutus/Çut_¡ršg.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

50 
	~"sched.h
"

53 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
,

54 
sched_·¿m
 *
·¿m
)

56 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
·¿m
 =ğ
NULL
)

58  
EINVAL
;

61 
	`memıy
 (
·¿m
, &(*
©Œ
)->param,  (*param));

63 
	}
}

	@pthread_attr_getschedpolicy.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_©Œ_g‘schedpŞicy
 (
±h»ad_©Œ_t
 * 
©Œ
, *
pŞicy
)

50 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
pŞicy
 =ğ
NULL
)

52  
EINVAL
;

59 ià(
pŞicy
 <ğ(*è
SCHED_MAX
)

61  
EINVAL
;

64 *
pŞicy
 = 
SCHED_OTHER
;

67 
	}
}

	@pthread_attr_getscope.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, *
cÚ‹ÁiÚscİe
)

50 #ifdeà
_POSIX_THREAD_PRIORITY_SCHEDULING


51 *
cÚ‹ÁiÚscİe
 = (*
©Œ
)->contentionscope;

54  
ENOSYS
;

56 
	}
}

	@pthread_attr_getstack.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, **
¡ackaddr
, 
size_t
 *
¡acksize
)

50 
addr
 = 
	`±h»ad_©Œ_g‘¡ackaddr
(
©Œ
, 
¡ackaddr
);

51 
size
 = 
	`±h»ad_©Œ_g‘¡acksize
(
©Œ
,
¡acksize
);

52 ià(
addr
 =ğ
size
 == 0){

56 
	}
}

	@pthread_attr_getstackaddr.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, **
¡ackaddr
)

84 #ià
	`defšed
Ğ
_POSIX_THREAD_ATTR_STACKADDR
 )

86 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

88  
EINVAL
;

91 *
¡ackaddr
 = (*
©Œ
)->stackaddr;

96  
ENOSYS
;

99 
	}
}

	@pthread_attr_getstacksize.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 * 
©Œ
, 
size_t
 * 
¡acksize
)

85 #ifdeà
_POSIX_THREAD_ATTR_STACKSIZE


87 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

89  
EINVAL
;

93 *
¡acksize
 = (*
©Œ
)->stacksize;

98  
ENOSYS
;

102 
	}
}

	@pthread_attr_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 * 
©Œ
)

77 
±h»ad_©Œ_t
 
©Œ_»suÉ
;

79 ià(
©Œ
 =ğ
NULL
)

82  
EINVAL
;

85 
©Œ_»suÉ
 = (
±h»ad_©Œ_t
è
	`m®loc
 ( (*attr_result));

87 ià(
©Œ_»suÉ
 =ğ
NULL
)

89  
ENOMEM
;

92 #ifdeà
_POSIX_THREAD_ATTR_STACKSIZE


96 
©Œ_»suÉ
->
¡acksize
 = 0;

99 #ifdeà
_POSIX_THREAD_ATTR_STACKADDR


101 
©Œ_»suÉ
->
¡ackaddr
 = 
NULL
;

104 
©Œ_»suÉ
->
d‘ach¡©e
 = 
PTHREAD_CREATE_JOINABLE
;

111 
©Œ_»suÉ
->
·¿m
.
sched_´iÜ™y
 = 
	`±e_osTh»adG‘DeçuÉPriÜ™y
();

112 
©Œ_»suÉ
->
šh”™sched
 = 
PTHREAD_EXPLICIT_SCHED
;

113 
©Œ_»suÉ
->
cÚ‹ÁiÚscİe
 = 
PTHREAD_SCOPE_SYSTEM
;

115 
©Œ_»suÉ
->
v®id
 = 
PTE_ATTR_VALID
;

117 *
©Œ
 = 
©Œ_»suÉ
;

120 
	}
}

	@pthread_attr_setdetachstate.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 * 
©Œ
, 
d‘ach¡©e
)

84 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

86  
EINVAL
;

89 ià(
d‘ach¡©e
 !ğ
PTHREAD_CREATE_JOINABLE
 &&

90 
d‘ach¡©e
 !ğ
PTHREAD_CREATE_DETACHED
)

92  
EINVAL
;

95 (*
©Œ
)->
d‘ach¡©e
 = detachstate;

97 
	}
}

	@pthread_attr_setinheritsched.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 * 
©Œ
, 
šh”™sched
)

50 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

52  
EINVAL
;

55 ià(
PTHREAD_INHERIT_SCHED
 !ğ
šh”™sched


56 && 
PTHREAD_EXPLICIT_SCHED
 !ğ
šh”™sched
)

58  
EINVAL
;

61 (*
©Œ
)->
šh”™sched
 = inheritsched;

63 
	}
}

	@pthread_attr_setschedparam.c

46 
	~<Çutus/Çutus.h
>

47 
	~<Çutus/Çut_¡ršg.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

50 
	~"sched.h
"

53 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 * 
©Œ
,

54 cÚ¡ 
sched_·¿m
 *
·¿m
)

56 
´iÜ™y
;

58 ià(
	`±e_is_©Œ
 (
©Œ
è!ğ0 || 
·¿m
 =ğ
NULL
)

60  
EINVAL
;

63 
´iÜ™y
 = 
·¿m
->
sched_´iÜ™y
;

66 ià(
´iÜ™y
 < 
	`sched_g‘_´iÜ™y_mš
 (
SCHED_OTHER
) ||

67 
´iÜ™y
 > 
	`sched_g‘_´iÜ™y_max
 (
SCHED_OTHER
))

69  
EINVAL
;

72 
	`memıy
 (&(*
©Œ
)->
·¿m
,…aram,  (*param));

74 
	}
}

	@pthread_attr_setschedpolicy.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 * 
©Œ
, 
pŞicy
)

50 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

52  
EINVAL
;

55 ià(
pŞicy
 !ğ
SCHED_OTHER
)

57  
ENOTSUP
;

61 
	}
}

	@pthread_attr_setscope.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 * 
©Œ
, 
cÚ‹ÁiÚscİe
)

50 #ifdeà
_POSIX_THREAD_PRIORITY_SCHEDULING


51 
cÚ‹ÁiÚscİe
)

53 
PTHREAD_SCOPE_SYSTEM
:

54 (*
©Œ
)->
cÚ‹ÁiÚscİe
 = contentionscope;

56 
PTHREAD_SCOPE_PROCESS
:

57  
ENOTSUP
;

59  
EINVAL
;

62  
ENOSYS
;

64 
	}
}

	@pthread_attr_setstackaddr.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 * 
©Œ
, *
¡ackaddr
)

88 #ià
	`defšed
Ğ
_POSIX_THREAD_ATTR_STACKADDR
 )

90 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

92  
EINVAL
;

95 (*
©Œ
)->
¡ackaddr
 = stackaddr;

100  
ENOSYS
;

103 
	}
}

	@pthread_attr_setstacksize.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 * 
©Œ
, 
size_t
 
¡acksize
)

89 #ifdeà
_POSIX_THREAD_ATTR_STACKSIZE


91 #ià
PTHREAD_STACK_MIN
 > 0

94 ià(
¡acksize
 < 
PTHREAD_STACK_MIN
)

96  
EINVAL
;

101 ià(
	`±e_is_©Œ
 (
©Œ
) != 0)

103  
EINVAL
;

107 (*
©Œ
)->
¡acksize
 = stacksize;

112  
ENOSYS
;

116 
	}
}

	@pthread_barrier_destroy.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
)

53 
»suÉ
 = 0;

54 
±h»ad_b¬r›r_t
 
b
;

56 ià(
b¬r›r
 =ğ
NULL
 || *b¬r›¸=ğ(
±h»ad_b¬r›r_t
è
PTE_OBJECT_INVALID
)

58  
EINVAL
;

61 
b
 = *
b¬r›r
;

62 *
b¬r›r
 = 
NULL
;

64 ià(0 =ğ(
»suÉ
 = 
	`£m_de¡roy
 (&(
b
->
£mB¬r›rB»eched
[0]))))

66 ià(0 =ğ(
»suÉ
 = 
	`£m_de¡roy
 (&(
b
->
£mB¬r›rB»eched
[1]))))

68 
	`ä“
(
b
);

72 (è
	`£m_š™
 (&(
b
->
£mB¬r›rB»eched
[0]), b->
psh¬ed
, 0);

75 *
b¬r›r
 = 
b
;

76  (
»suÉ
);

77 
	}
}

	@pthread_barrier_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
,

52 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 * 
©Œ
, 
couÁ
)

54 
±h»ad_b¬r›r_t
 
b
;

56 ià(
b¬r›r
 =ğ
NULL
 || 
couÁ
 == 0)

58  
EINVAL
;

61 ià(
NULL
 !ğ(
b
 = (
±h»ad_b¬r›r_t
è
	`ÿÎoc
 (1,  (*b))))

63 
b
->
psh¬ed
 = (
©Œ
 !ğ
NULL
 && *attr != NULL

64 ? (*
©Œ
)->
psh¬ed
 : 
PTHREAD_PROCESS_PRIVATE
);

66 
b
->
nCu¼’tB¬r›rHeight
 = b->
nIn™ŸlB¬r›rHeight
 = 
couÁ
;

67 
b
->
iS‹p
 = 0;

77 ià(0 =ğ
	`£m_š™
 (&(
b
->
£mB¬r›rB»eched
[0]), b->
psh¬ed
, 0))

79 ià(0 =ğ
	`£m_š™
 (&(
b
->
£mB¬r›rB»eched
[1]), b->
psh¬ed
, 0))

81 *
b¬r›r
 = 
b
;

84 (è
	`£m_de¡roy
 (&(
b
->
£mB¬r›rB»eched
[0]));

88 
	`ä“
(
b
);

91  
ENOMEM
;

92 
	}
}

	@pthread_barrier_wait.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 * 
b¬r›r
)

50 
»suÉ
;

51 
¡•
;

52 
±h»ad_b¬r›r_t
 
b
;

54 ià(
b¬r›r
 =ğ
NULL
 || *b¬r›¸=ğ(
±h»ad_b¬r›r_t
è
PTE_OBJECT_INVALID
)

56  
EINVAL
;

59 
b
 = *
b¬r›r
;

60 
¡•
 = 
b
->
iS‹p
;

62 ià(0 =ğ
	`PTE_ATOMIC_DECREMENT
 ((*è&(
b
->
nCu¼’tB¬r›rHeight
)))

65 
b
->
nCu¼’tB¬r›rHeight
 = b->
nIn™ŸlB¬r›rHeight
;

76 
»suÉ
 = (
b
->
nIn™ŸlB¬r›rHeight
 > 1

77 ? 
	`£m_po¡_muÉË
 (&(
b
->
£mB¬r›rB»eched
[
¡•
]),

78 
b
->
nIn™ŸlB¬r›rHeight
 - 1) : 0);

85 
»suÉ
 = 
	`£m_wa™
 (&(
b
->
£mB¬r›rB»eched
[
¡•
]));

93 ià(0 =ğ
»suÉ
)

95 
»suÉ
 = (
¡•
 ==

96 
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (& (
b
->
iS‹p
),(1L - 
¡•
),step) ?

97 
PTHREAD_BARRIER_SERIAL_THREAD
 : 0);

100  (
»suÉ
);

101 
	}
}

	@pthread_barrierattr_destroy.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
)

77 
»suÉ
 = 0;

79 ià(
©Œ
 =ğ
NULL
 || *attr == NULL)

81 
»suÉ
 = 
EINVAL
;

85 
±h»ad_b¬r›¿‰r_t
 
ba
 = *
©Œ
;

87 *
©Œ
 = 
NULL
;

88 
	`ä“
 (
ba
);

91  (
»suÉ
);

92 
	}
}

	@pthread_barrierattr_getpshared.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 * 
©Œ
,

49 *
psh¬ed
)

88 
»suÉ
;

90 ià((
©Œ
 !ğ
NULL
 && *©Œ !ğNULLè&& (
psh¬ed
 != NULL))

92 *
psh¬ed
 = (*
©Œ
)->pshared;

93 
»suÉ
 = 0;

97 
»suÉ
 = 
EINVAL
;

100  (
»suÉ
);

101 
	}
}

	@pthread_barrierattr_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
)

77 
±h»ad_b¬r›¿‰r_t
 
ba
;

78 
»suÉ
 = 0;

80 
ba
 = (
±h»ad_b¬r›¿‰r_t
è
	`ÿÎoc
 (1,  (*ba));

82 ià(
ba
 =ğ
NULL
)

84 
»suÉ
 = 
ENOMEM
;

88 
ba
->
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

91 *
©Œ
 = 
ba
;

93  (
»suÉ
);

94 
	}
}

	@pthread_barrierattr_setpshared.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 * 
©Œ
, 
psh¬ed
)

90 
»suÉ
;

92 ià((
©Œ
 !ğ
NULL
 && *attr != NULL) &&

93 ((
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
) ||

94 (
psh¬ed
 =ğ
PTHREAD_PROCESS_PRIVATE
)))

96 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

99 #ià!
	`defšed
Ğ
_POSIX_THREAD_PROCESS_SHARED
 )

101 
»suÉ
 = 
ENOSYS
;

102 
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

106 
»suÉ
 = 0;

113 
»suÉ
 = 0;

116 (*
©Œ
)->
psh¬ed
 =…shared;

120 
»suÉ
 = 
EINVAL
;

123  (
»suÉ
);

125 
	}
}

	@pthread_cancel.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

47 
	~<Çutus/Çutus.h
>

49 
	$±h»ad_ÿnûl
 (
±h»ad_t
 
th»ad
)

72 
»suÉ
;

73 
ÿnûl_£lf
;

74 
±h»ad_t
 
£lf
;

75 
±e_th»ad_t
 * 

;

77 
»suÉ
 = 
	`±h»ad_kl
 (
th»ad
, 0);

79 ià(0 !ğ
»suÉ
)

81  
»suÉ
;

84 ià((
£lf
 = 
	`±h»ad_£lf
 ()).
p
 =ğ
NULL
)

86  
ENOMEM
;

103 
ÿnûl_£lf
 = 
	`±h»ad_equ®
 (
th»ad
, 
£lf
);

105 

 = (
±e_th»ad_t
 *è
th»ad
.
p
;

110 (è
	`±h»ad_mu‹x_lock
 (&

->
ÿnûlLock
);

112 ià(

->
ÿnûlTy³
 =ğ
PTHREAD_CANCEL_ASYNCHRONOUS


113 && 

->
ÿnûlS‹
 =ğ
PTHREAD_CANCEL_ENABLE


114 && 

->
¡©e
 < 
PTh»adS‹Cªûlšg
)

116 ià(
ÿnûl_£lf
)

118 

->
¡©e
 = 
PTh»adS‹Cªûlšg
;

119 

->
ÿnûlS‹
 = 
PTHREAD_CANCEL_DISABLE
;

121 (è
	`±h»ad_mu‹x_uÆock
 (&

->
ÿnûlLock
);

122 
	`±e_throw
 (
PTE_EPS_CANCEL
);

145 (è
	`±h»ad_mu‹x_uÆock
 (&

->
ÿnûlLock
);

147 
»suÉ
 = 
EPERM
;

156 ià(

->
¡©e
 < 
PTh»adS‹CªûlP’dšg
)

158 

->
¡©e
 = 
PTh»adS‹CªûlP’dšg
;

160 ià(
	`±e_osTh»adCªûl
(

->
th»adId
è!ğ
PTE_OS_OK
)

162 
»suÉ
 = 
ESRCH
;

165 ià(

->
¡©e
 >ğ
PTh»adS‹Cªûlšg
)

167 
»suÉ
 = 
ESRCH
;

170 (è
	`±h»ad_mu‹x_uÆock
 (&

->
ÿnûlLock
);

173  (
»suÉ
);

174 
	}
}

	@pthread_cond_destroy.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 * 
cÚd
)

125 
±h»ad_cÚd_t
 
cv
;

126 
»suÉ
 = 0, 
»suÉ1
 = 0, 
»suÉ2
 = 0;

131 ià(
cÚd
 =ğ
NULL
 || *cond == NULL)

133  
EINVAL
;

136 ià(*
cÚd
 !ğ
PTHREAD_COND_INITIALIZER
)

139 
	`±e_osMu‹xLock
 (
±e_cÚd_li¡_lock
);

141 
cv
 = *
cÚd
;

148 ià(
	`£m_wa™
 (&(
cv
->
£mBlockLock
)) != 0)

150  
”ºo
;

158 ià((
»suÉ
 = 
	`±h»ad_mu‹x_Œylock
 (&(
cv
->
mtxUnblockLock
))) != 0)

160 (è
	`£m_po¡
 (&(
cv
->
£mBlockLock
));

161  
»suÉ
;

167 ià(
cv
->
nWa™”sBlocked
 > cv->
nWa™”sGÚe
)

169 ià(
	`£m_po¡
 (&(
cv
->
£mBlockLock
)) != 0)

171 
»suÉ
 = 
”ºo
;

173 
»suÉ1
 = 
	`±h»ad_mu‹x_uÆock
 (&(
cv
->
mtxUnblockLock
));

174 
»suÉ2
 = 
EBUSY
;

181 *
cÚd
 = 
NULL
;

183 ià(
	`£m_de¡roy
 (&(
cv
->
£mBlockLock
)) != 0)

185 
»suÉ
 = 
”ºo
;

187 ià(
	`£m_de¡roy
 (&(
cv
->
£mBlockQueue
)) != 0)

189 
»suÉ1
 = 
”ºo
;

191 ià((
»suÉ2
 = 
	`±h»ad_mu‹x_uÆock
 (&(
cv
->
mtxUnblockLock
))) == 0)

193 
»suÉ2
 = 
	`±h»ad_mu‹x_de¡roy
 (&(
cv
->
mtxUnblockLock
));

198 ià(
±e_cÚd_li¡_h—d
 =ğ
cv
)

200 
±e_cÚd_li¡_h—d
 = 
cv
->
Ãxt
;

204 
cv
->
´ev
->
Ãxt
 = cv->next;

207 ià(
±e_cÚd_li¡_
 =ğ
cv
)

209 
±e_cÚd_li¡_
 = 
cv
->
´ev
;

213 
cv
->
Ãxt
->
´ev
 = cv->prev;

215 
	`ä“
(
cv
);

219 
	`±e_osMu‹xUÆock
(
±e_cÚd_li¡_lock
);

228 
	`±e_osMu‹xLock
 (
±e_cÚd_‹¡_š™_lock
);

233 ià(*
cÚd
 =ğ
PTHREAD_COND_INITIALIZER
)

241 *
cÚd
 = 
NULL
;

249 
»suÉ
 = 
EBUSY
;

252 
	`±e_osMu‹xUÆock
(
±e_cÚd_‹¡_š™_lock
);

255  ((
»suÉ
 !ğ0è?„esuÉ : ((
»suÉ1
 !ğ0è?„esuÉ1 : 
»suÉ2
));

256 
	}
}

	@pthread_cond_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

51 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 * 
cÚd
, cÚ¡ 
±h»ad_cÚd©Œ_t
 * 
©Œ
)

79 
»suÉ
;

80 
±h»ad_cÚd_t
 
cv
 = 
NULL
;

82 ià(
cÚd
 =ğ
NULL
)

84  
EINVAL
;

87 ià((
©Œ
 !ğ
NULL
 && *attr != NULL) &&

88 ((*
©Œ
)->
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
))

94 
»suÉ
 = 
ENOSYS
;

95 
DONE
;

98 
cv
 = (
±h»ad_cÚd_t
è
	`ÿÎoc
 (1,  (*cv));

100 ià(
cv
 =ğ
NULL
)

102 
»suÉ
 = 
ENOMEM
;

103 
DONE
;

106 
cv
->
nWa™”sBlocked
 = 0;

107 
cv
->
nWa™”sToUnblock
 = 0;

108 
cv
->
nWa™”sGÚe
 = 0;

110 ià(
	`£m_š™
 (&(
cv
->
£mBlockLock
), 0, 1) != 0)

112 
»suÉ
 = 
”ºo
;

113 
FAIL0
;

116 ià(
	`£m_š™
 (&(
cv
->
£mBlockQueue
), 0, 0) != 0)

118 
»suÉ
 = 
”ºo
;

119 
FAIL1
;

122 ià((
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (&(
cv
->
mtxUnblockLock
), 0)) != 0)

124 
FAIL2
;

127 
»suÉ
 = 0;

129 
DONE
;

136 
FAIL2
:

137 (è
	`£m_de¡roy
 (&(
cv
->
£mBlockQueue
));

139 
FAIL1
:

140 (è
	`£m_de¡roy
 (&(
cv
->
£mBlockLock
));

142 
FAIL0
:

143 
	`ä“
(
cv
);

145 
cv
 = 
NULL
;

147 
DONE
:

148 ià(0 =ğ
»suÉ
)

151 
	`±e_osMu‹xLock
 (
±e_cÚd_li¡_lock
);

153 
cv
->
Ãxt
 = 
NULL
;

154 
cv
->
´ev
 = 
±e_cÚd_li¡_
;

156 ià(
±e_cÚd_li¡_
 !ğ
NULL
)

158 
±e_cÚd_li¡_
->
Ãxt
 = 
cv
;

161 
±e_cÚd_li¡_
 = 
cv
;

163 ià(
±e_cÚd_li¡_h—d
 =ğ
NULL
)

165 
±e_cÚd_li¡_h—d
 = 
cv
;

168 
	`±e_osMu‹xUÆock
(
±e_cÚd_li¡_lock
);

171 *
cÚd
 = 
cv
;

173  
»suÉ
;

175 
	}
}

	@pthread_cond_signal.c

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

52 
	$±e_cÚd_unblock
 (
±h»ad_cÚd_t
 * 
cÚd
, 
unblockAÎ
)

73 
»suÉ
;

74 
±h»ad_cÚd_t
 
cv
;

75 
nSigÇlsToIssue
;

77 ià(
cÚd
 =ğ
NULL
 || *cond == NULL)

79  
EINVAL
;

82 
cv
 = *
cÚd
;

88 ià(
cv
 =ğ
PTHREAD_COND_INITIALIZER
)

93 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
cv
->
mtxUnblockLock
))) != 0)

95  
»suÉ
;

98 ià(0 !ğ
cv
->
nWa™”sToUnblock
)

100 ià(0 =ğ
cv
->
nWa™”sBlocked
)

102  
	`±h»ad_mu‹x_uÆock
 (&(
cv
->
mtxUnblockLock
));

104 ià(
unblockAÎ
)

106 
cv
->
nWa™”sToUnblock
 +ğ(
nSigÇlsToIssue
 = cv->
nWa™”sBlocked
);

107 
cv
->
nWa™”sBlocked
 = 0;

111 
nSigÇlsToIssue
 = 1;

112 
cv
->
nWa™”sToUnblock
++;

113 
cv
->
nWa™”sBlocked
--;

116 ià(
cv
->
nWa™”sBlocked
 > cv->
nWa™”sGÚe
)

120 ià(
	`£m_wa™
 (&(
cv
->
£mBlockLock
)) != 0)

122 
»suÉ
 = 
”ºo
;

123 (è
	`±h»ad_mu‹x_uÆock
 (&(
cv
->
mtxUnblockLock
));

124  
»suÉ
;

126 ià(0 !ğ
cv
->
nWa™”sGÚe
)

128 
cv
->
nWa™”sBlocked
 -ğcv->
nWa™”sGÚe
;

129 
cv
->
nWa™”sGÚe
 = 0;

131 ià(
unblockAÎ
)

133 
nSigÇlsToIssue
 = 
cv
->
nWa™”sToUnblock
 = cv->
nWa™”sBlocked
;

134 
cv
->
nWa™”sBlocked
 = 0;

138 
nSigÇlsToIssue
 = 
cv
->
nWa™”sToUnblock
 = 1;

139 
cv
->
nWa™”sBlocked
--;

144  
	`±h»ad_mu‹x_uÆock
 (&(
cv
->
mtxUnblockLock
));

147 ià((
»suÉ
 = 
	`±h»ad_mu‹x_uÆock
 (&(
cv
->
mtxUnblockLock
))) == 0)

149 ià(
	`£m_po¡_muÉË
 (&(
cv
->
£mBlockQueue
), 
nSigÇlsToIssue
) != 0)

151 
»suÉ
 = 
”ºo
;

155  
»suÉ
;

157 
	}
}

160 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 * 
cÚd
)

197  (
	`±e_cÚd_unblock
 (
cÚd
, 0));

199 
	}
}

202 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 * 
cÚd
)

236  (
	`±e_cÚd_unblock
 (
cÚd
, 
PTE_TRUE
));

238 
	}
}

	@pthread_cond_wait.c

267 
	~"±h»ad.h
"

268 
	~"im¶em’t.h
"

276 
±h»ad_mu‹x_t
 *
	mmu‹xPŒ
;

277 
±h»ad_cÚd_t
 
	mcv
;

278 *
	m»suÉPŒ
;

279 } 
	t±e_cÚd_wa™_ş—nup_¬gs_t
;

282 
	$±e_cÚd_wa™_ş—nup
 (*
¬gs
)

284 
±e_cÚd_wa™_ş—nup_¬gs_t
 *
ş—nup_¬gs
 =

285 (
±e_cÚd_wa™_ş—nup_¬gs_t
 *è
¬gs
;

286 
±h»ad_cÚd_t
 
cv
 = 
ş—nup_¬gs
->cv;

287 *
»suÉPŒ
 = 
ş—nup_¬gs
->resultPtr;

288 
nSigÇlsWasLeá
;

289 
»suÉ
;

297 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
cv
->
mtxUnblockLock
))) != 0)

299 *
»suÉPŒ
 = 
»suÉ
;

303 ià(0 !ğ(
nSigÇlsWasLeá
 = 
cv
->
nWa™”sToUnblock
))

305 --(
cv
->
nWa™”sToUnblock
);

307 ià(
INT_MAX
 / 2 =ğ++(
cv
->
nWa™”sGÚe
))

311 ià(
	`£m_wa™
 (&(
cv
->
£mBlockLock
)) != 0)

313 *
»suÉPŒ
 = 
”ºo
;

321 
cv
->
nWa™”sBlocked
 -ğcv->
nWa™”sGÚe
;

322 ià(
	`£m_po¡
 (&(
cv
->
£mBlockLock
)) != 0)

324 *
»suÉPŒ
 = 
”ºo
;

332 
cv
->
nWa™”sGÚe
 = 0;

335 ià((
»suÉ
 = 
	`±h»ad_mu‹x_uÆock
 (&(
cv
->
mtxUnblockLock
))) != 0)

337 *
»suÉPŒ
 = 
»suÉ
;

341 ià(1 =ğ
nSigÇlsWasLeá
)

343 ià(
	`£m_po¡
 (&(
cv
->
£mBlockLock
)) != 0)

345 *
»suÉPŒ
 = 
”ºo
;

354 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (
ş—nup_¬gs
->
mu‹xPŒ
)) != 0)

356 *
»suÉPŒ
 = 
»suÉ
;

358 
	}
}

361 
	$±e_cÚd_timedwa™
 (
±h»ad_cÚd_t
 * 
cÚd
,

362 
±h»ad_mu‹x_t
 * 
mu‹x
, cÚ¡ 
time¥ec
 *
ab¡ime
)

364 
»suÉ
 = 0;

365 
±h»ad_cÚd_t
 
cv
;

366 
±e_cÚd_wa™_ş—nup_¬gs_t
 
ş—nup_¬gs
;

368 ià(
cÚd
 =ğ
NULL
 || *cond == NULL)

370  
EINVAL
;

379 ià(*
cÚd
 =ğ
PTHREAD_COND_INITIALIZER
)

381 
»suÉ
 = 
	`±e_cÚd_check_Ãed_š™
 (
cÚd
);

384 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

386  
»suÉ
;

389 
cv
 = *
cÚd
;

392 ià(
	`£m_wa™
 (&(
cv
->
£mBlockLock
)) != 0)

394  
”ºo
;

397 ++(
cv
->
nWa™”sBlocked
);

399 ià(
	`£m_po¡
 (&(
cv
->
£mBlockLock
)) != 0)

401  
”ºo
;

407 
ş—nup_¬gs
.
mu‹xPŒ
 = 
mu‹x
;

408 
ş—nup_¬gs
.
cv
 = cv;

409 
ş—nup_¬gs
.
»suÉPŒ
 = &
»suÉ
;

411 
	`±h»ad_ş—nup_push
 (
±e_cÚd_wa™_ş—nup
, (*è&
ş—nup_¬gs
);

416 ià((
»suÉ
 = 
	`±h»ad_mu‹x_uÆock
 (
mu‹x
)) == 0)

434 ià(
	`£m_timedwa™
 (&(
cv
->
£mBlockQueue
), 
ab¡ime
) != 0)

436 
»suÉ
 = 
”ºo
;

444 
	`±h»ad_ş—nup_pİ
 (1);

449  
»suÉ
;

451 
	}
}

455 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 * 
cÚd
, 
±h»ad_mu‹x_t
 * 
mu‹x
)

507  (
	`±e_cÚd_timedwa™
 (
cÚd
, 
mu‹x
, 
NULL
));

509 
	}
}

513 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 * 
cÚd
,

514 
±h»ad_mu‹x_t
 * 
mu‹x
,

515 cÚ¡ 
time¥ec
 *
ab¡ime
)

561 ià(
ab¡ime
 =ğ
NULL
)

563  
EINVAL
;

566  (
	`±e_cÚd_timedwa™
 (
cÚd
, 
mu‹x
, 
ab¡ime
));

568 
	}
}

	@pthread_condattr_destroy.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
)

79 
»suÉ
 = 0;

81 ià(
©Œ
 =ğ
NULL
 || *attr == NULL)

83 
»suÉ
 = 
EINVAL
;

87 
	`ä“
(*
©Œ
);

90 *
©Œ
 = 
NULL
;

91 
»suÉ
 = 0;

94  
»suÉ
;

96 
	}
}

	@pthread_condattr_getpshared.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

49 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 * 
©Œ
, *
psh¬ed
)

89 
»suÉ
;

91 ià((
©Œ
 !ğ
NULL
 && *©Œ !ğNULLè&& (
psh¬ed
 != NULL))

93 *
psh¬ed
 = (*
©Œ
)->pshared;

94 
»suÉ
 = 0;

98 
»suÉ
 = 
EINVAL
;

101  
»suÉ
;

103 
	}
}

	@pthread_condattr_init.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
)

82 
±h»ad_cÚd©Œ_t
 
©Œ_»suÉ
;

83 
»suÉ
 = 0;

85 
©Œ_»suÉ
 = (
±h»ad_cÚd©Œ_t
è
	`ÿÎoc
 (1,  (*attr_result));

87 ià(
©Œ_»suÉ
 =ğ
NULL
)

89 
»suÉ
 = 
ENOMEM
;

92 *
©Œ
 = 
©Œ_»suÉ
;

94  
»suÉ
;

96 
	}
}

	@pthread_condattr_setpshared.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

49 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 * 
©Œ
, 
psh¬ed
)

91 
»suÉ
;

93 ià((
©Œ
 !ğ
NULL
 && *attr != NULL)

94 && ((
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

95 || (
psh¬ed
 =ğ
PTHREAD_PROCESS_PRIVATE
)))

97 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

100 #ià!
	`defšed
Ğ
_POSIX_THREAD_PROCESS_SHARED
 )

101 
»suÉ
 = 
ENOSYS
;

102 
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

104 
»suÉ
 = 0;

111 
»suÉ
 = 0;

114 (*
©Œ
)->
psh¬ed
 =…shared;

118 
»suÉ
 = 
EINVAL
;

121  
»suÉ
;

123 
	}
}

	@pthread_delay_np.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

91 
	$±h»ad_d–ay_Å
 (
time¥ec
 *
š‹rv®
)

93 
wa™_time
;

94 
£cs_š_mli£cs
;

95 
mli£cs
;

96 
±h»ad_t
 
£lf
;

97 
±e_th»ad_t
 * 
¥
;

99 ià(
š‹rv®
 =ğ
NULL
)

101  
EINVAL
;

104 ià(
š‹rv®
->
tv_£c
 =ğ0L && iÁ”v®->
tv_n£c
 == 0L)

106 
	`±h»ad_‹¡ÿnûl
 ();

107 
	`±e_osTh»adSË•
 (1);

108 
	`±h»ad_‹¡ÿnûl
 ();

113 
£cs_š_mli£cs
 = 
š‹rv®
->
tv_£c
 * 1000L;

116 
mli£cs
 = (
š‹rv®
->
tv_n£c
 + 999999L) / 1000000L;

118 
wa™_time
 = 
£cs_š_mli£cs
 + 
mli£cs
;

120 ià(
NULL
 =ğ(
£lf
 = 
	`±h»ad_£lf
 ()).
p
)

122  
ENOMEM
;

125 
¥
 = (
±e_th»ad_t
 *è
£lf
.
p
;

127 ià(
¥
->
ÿnûlS‹
 =ğ
PTHREAD_CANCEL_ENABLE
)

129 
±e_osResuÉ
 
ÿnûlStus
;

134 
ÿnûlStus
 = 
	`±e_osTh»adCheckCªûl
(
¥
->
th»adId
);

136 ià(
ÿnûlStus
 =ğ
PTE_OS_INTERRUPTED
)

141 (è
	`±h»ad_mu‹x_lock
 (&
¥
->
ÿnûlLock
);

142 ià(
¥
->
¡©e
 < 
PTh»adS‹Cªûlšg
)

144 
¥
->
¡©e
 = 
PTh»adS‹Cªûlšg
;

145 
¥
->
ÿnûlS‹
 = 
PTHREAD_CANCEL_DISABLE
;

146 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

148 
	`±e_throw
 (
PTE_EPS_CANCEL
);

151 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

152  
ESRCH
;

154 ià(
ÿnûlStus
 !ğ
PTE_OS_OK
)

156  
EINVAL
;

162 
	`±e_osTh»adSË•
 (
wa™_time
);

166 
	}
}

	@pthread_detach.c

44 
	~"nk/±e_o§l.h
"

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_d‘ach
 (
±h»ad_t
 
th»ad
)

76 
»suÉ
;

77 
de¡royIt
 = 
PTE_FALSE
;

78 
±e_th»ad_t
 * 

 = (±e_th»ad_ˆ*è
th»ad
.
p
;

81 
	`±e_osMu‹xLock
 (
±e_th»ad_»u£_lock
);

83 ià(
NULL
 =ğ



84 || 
th»ad
.
x
 !ğ

->
±HªdË
.x)

86 
»suÉ
 = 
ESRCH
;

88 ià(
PTHREAD_CREATE_DETACHED
 =ğ

->
d‘achS‹
)

90 
»suÉ
 = 
EINVAL
;

99 
»suÉ
 = 0;

101 ià(
	`±h»ad_mu‹x_lock
 (&

->
ÿnûlLock
) == 0)

103 ià(

->
¡©e
 !ğ
PTh»adS‹La¡
)

105 

->
d‘achS‹
 = 
PTHREAD_CREATE_DETACHED
;

107 ià(

->
d‘achS‹
 !ğ
PTHREAD_CREATE_DETACHED
)

112 
de¡royIt
 = 
PTE_TRUE
;

114 (è
	`±h»ad_mu‹x_uÆock
 (&

->
ÿnûlLock
);

119 
»suÉ
 = 
ESRCH
;

123 
	`±e_osMu‹xUÆock
(
±e_th»ad_»u£_lock
);

125 ià(
»suÉ
 == 0)

129 ià(
de¡royIt
)

134 
	`±e_osTh»adWa™FÜEnd
(

->
th»adId
);

136 
	`±e_th»adDe¡roy
 (
th»ad
);

140  (
»suÉ
);

142 
	}
}

	@pthread_equal.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_equ®
 (
±h»ad_t
 
t1
,…th»ad_ˆ
t2
)

72 
»suÉ
;

78 
»suÉ
 = ( 
t1
.
p
 =ğ
t2
.°&&1.
x
 ==2.x );

80  (
»suÉ
);

82 
	}
}

	@pthread_exit.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

48 
	$±h»ad_ex™
 (*
v®ue_±r
)

71 
±e_th»ad_t
 * 
¥
;

77 
¥
 = (
±e_th»ad_t
 *è
	`±h»ad_g‘¥ecific
 (
±e_£lfTh»adKey
);

79 ià(
NULL
 =ğ
¥
)

90 
	`±e_osTh»adEx™
();

95 
¥
->
ex™Stus
 = 
v®ue_±r
;

97 
	`±e_throw
 (
PTE_EPS_EXIT
);

101 
	}
}

	@pthread_getattr_np.c

1 
	~"±h»ad.h
"

2 
	~"im¶em’t.h
"

6 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
th»ad
 ,
±h»ad_©Œ_t
 * 
©Œ
)

11 
	}
}

	@pthread_getconcurrency.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_g‘cÚcu¼’cy
 ()

50  
±e_cÚcu¼’cy
;

51 
	}
}

	@pthread_getschedparam.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
th»ad
, *
pŞicy
,

49 
sched_·¿m
 *
·¿m
)

51 
»suÉ
;

54 
»suÉ
 = 
	`±h»ad_kl
 (
th»ad
, 0);

55 ià(0 !ğ
»suÉ
)

57  
»suÉ
;

64 ià(
pŞicy
 <ğ(*è
SCHED_MAX
 || 
·¿m
 =ğ
NULL
)

66  
EINVAL
;

70 *
pŞicy
 = 
SCHED_OTHER
;

78 
·¿m
->
sched_´iÜ™y
 = ((
±e_th»ad_t
 *)
th»ad
.
p
)->sched_priority;

81 
	}
}

	@pthread_getspecific.c

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
key
)

74 * 
±r
;

76 ià(
key
 =ğ
NULL
)

78 
±r
 = 
NULL
;

82 
±r
 = 
	`±e_osTlsG‘V®ue
 (
key
->key);

85  
±r
;

86 
	}
}

	@pthread_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

49 
	$±h»ad_š™
()

52 ià(
±e_´oûssIn™Ÿlized
)

61  
PTE_TRUE
;

64 
±e_´oûssIn™Ÿlized
 = 
PTE_TRUE
;

67 
	`±e_osIn™
();

72 ià((
	`±h»ad_key_ü—‹
 (&
±e_£lfTh»adKey
, 
NULL
) != 0) ||

73 (
	`±h»ad_key_ü—‹
 (&
±e_ş—nupKey
, 
NULL
) != 0))

75 
	`±h»ad_‹rmš©e
();

81 
	`±e_osMu‹xC»©e
 (&
±e_th»ad_»u£_lock
);

82 
	`±e_osMu‹xC»©e
 (&
±e_mu‹x_‹¡_š™_lock
);

83 
	`±e_osMu‹xC»©e
 (&
±e_cÚd_li¡_lock
);

84 
	`±e_osMu‹xC»©e
 (&
±e_cÚd_‹¡_š™_lock
);

85 
	`±e_osMu‹xC»©e
 (&
±e_rwlock_‹¡_š™_lock
);

86 
	`±e_osMu‹xC»©e
 (&
±e_¥šlock_‹¡_š™_lock
);

89  (
±e_´oûssIn™Ÿlized
);

91 
	}
}

	@pthread_join.c

44 
	~"nk/±e_o§l.h
"

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

52 
	$±h»ad_još
 (
±h»ad_t
 
th»ad
, **
v®ue_±r
)

86 
»suÉ
;

87 
±h»ad_t
 
£lf
;

88 
±e_th»ad_t
 * 

 = (±e_th»ad_ˆ*è
th»ad
.
p
;

91 
	`±e_osMu‹xLock
 (
±e_th»ad_»u£_lock
);

93 ià(
NULL
 =ğ



94 || 
th»ad
.
x
 !ğ

->
±HªdË
.x)

96 
»suÉ
 = 
ESRCH
;

98 ià(
PTHREAD_CREATE_DETACHED
 =ğ

->
d‘achS‹
)

100 
»suÉ
 = 
EINVAL
;

104 
»suÉ
 = 0;

107 
	`±e_osMu‹xUÆock
(
±e_th»ad_»u£_lock
);

109 ià(
»suÉ
 == 0)

114 
£lf
 = 
	`±h»ad_£lf
();

116 ià(
NULL
 =ğ
£lf
.
p
)

118 
»suÉ
 = 
ENOENT
;

120 ià(
	`±h»ad_equ®
 (
£lf
, 
th»ad
))

122 
»suÉ
 = 
EDEADLK
;

134 
»suÉ
 = 
	`±e_osTh»adWa™FÜEnd
(

->
th»adId
);

136 ià(
PTE_OS_OK
 =ğ
»suÉ
)

138 ià(
v®ue_±r
 !ğ
NULL
)

140 *
v®ue_±r
 = 

->
ex™Stus
;

148 
»suÉ
 = 
	`±h»ad_d‘ach
 (
th»ad
);

150 ià(
»suÉ
 =ğ
PTE_OS_INTERRUPTED
)

153 
»suÉ
 = 0;

157 
»suÉ
 = 
ESRCH
;

162  (
»suÉ
);

164 
	}
}

	@pthread_key_create.c

44 
	~<Çutus/Çutus.h
>

45 
	~"nk/±e_o§l.h
"

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±h»ad_key_ü—‹
 (
±h»ad_key_t
 * 
key
, (*
de¡ruùÜ
) (*))

83 
»suÉ
 = 0;

84 
±h»ad_key_t
 
Ãwkey
;

86 ià((
Ãwkey
 = (
±h»ad_key_t
è
	`ÿÎoc
 (1,  (*Ãwkey))è=ğ
NULL
)

88 
»suÉ
 = 
ENOMEM
;

92 
±e_osResuÉ
 
osResuÉ
 = 
	`±e_osTlsAÎoc
(&(
Ãwkey
->
key
));

94 ià(
osResuÉ
 !ğ
PTE_OS_OK
)

96 
»suÉ
 = 
EAGAIN
;

98 
	`ä“
 (
Ãwkey
);

99 
Ãwkey
 = 
NULL
;

101 ià(
de¡ruùÜ
 !ğ
NULL
)

110 
Ãwkey
->
keyLock
 = 
PTHREAD_MUTEX_INITIALIZER
;

111 
Ãwkey
->
de¡ruùÜ
 = destructor;

116 *
key
 = 
Ãwkey
;

118  (
»suÉ
);

119 
	}
}

	@pthread_key_delete.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

52 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
key
)

79 
»suÉ
 = 0;

81 ià(
key
 !ğ
NULL
)

83 ià(
key
->
th»ads
 !ğ
NULL
 &&

84 
key
->
de¡ruùÜ
 !ğ
NULL
 &&

85 
	`±h»ad_mu‹x_lock
 (&(
key
->
keyLock
)) == 0)

87 
Th»adKeyAssoc
 *
assoc
;

96 (
assoc
 = (
Th»adKeyAssoc
 *è
key
->
th»ads
è!ğ
NULL
)

98 
±e_th»ad_t
 * 
th»ad
 = 
assoc
->thread;

100 ià(
assoc
 =ğ
NULL
)

106 ià(
	`±h»ad_mu‹x_lock
 (&(
th»ad
->
th»adLock
)) == 0)

114 
	`±e_tkAssocDe¡roy
 (
assoc
);

115 (è
	`±h»ad_mu‹x_uÆock
 (&(
th»ad
->
th»adLock
));

120 
	`±e_tkAssocDe¡roy
 (
assoc
);

123 
	`±h»ad_mu‹x_uÆock
 (&(
key
->
keyLock
));

126 
	`±e_osTlsF»e
 (
key
->key);

127 ià(
key
->
de¡ruùÜ
 !ğ
NULL
)

130 
EBUSY
 =ğ(
»suÉ
 = 
	`±h»ad_mu‹x_de¡roy
 (&(
key
->
keyLock
))))

132 
	`±e_osTh»adSË•
(1);

136 
	`ä“
 (
key
);

139  (
»suÉ
);

140 
	}
}

	@pthread_kill.c

46 
	~<Çutus/Çutus.h
>

47 
	~<Çutus/Çut_¡ršg.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

52 
	$±h»ad_kl
 (
±h»ad_t
 
th»ad
, 
sig
)

81 
»suÉ
 = 0;

82 
±e_th»ad_t
 * 

;

85 
	`±e_osMu‹xLock
 (
±e_th»ad_»u£_lock
);

87 

 = (
±e_th»ad_t
 *è
th»ad
.
p
;

89 ià(
NULL
 =ğ



90 || 
th»ad
.
x
 !ğ

->
±HªdË
.x

91 || 0 =ğ

->
th»adId
)

93 
»suÉ
 = 
ESRCH
;

96 
	`±e_osMu‹xUÆock
(
±e_th»ad_»u£_lock
);

98 ià(0 =ğ
»suÉ
 && 0 !ğ
sig
)

103 
»suÉ
 = 
EINVAL
;

106  
»suÉ
;

108 
	}
}

	@pthread_mutex_destroy.c

46 
	~<Çutus/Çutus.h
>

47 
	~<Çutus/Çut_¡ršg.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

53 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

55 
»suÉ
 = 0;

56 
±h»ad_mu‹x_t
 
mx
;

65 ià(*
mu‹x
 < 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

67 
mx
 = *
mu‹x
;

69 
»suÉ
 = 
	`±h»ad_mu‹x_Œylock
 (&
mx
);

75 ià(
»suÉ
 == 0)

77 ià(
mx
->
kšd
 !ğ
PTHREAD_MUTEX_RECURSIVE
 || 1 =ğmx->
»cursive_couÁ
)

90 *
mu‹x
 = 
NULL
;

92 
»suÉ
 = 
	`±h»ad_mu‹x_uÆock
 (&
mx
);

94 ià(
»suÉ
 == 0)

96 
	`±e_osSem­hÜeD–‘e
(
mx
->
hªdË
);

98 
	`ä“
(
mx
);

106 *
mu‹x
 = 
mx
;

114 
mx
->
»cursive_couÁ
--;

115 
»suÉ
 = 
EBUSY
;

125 
	`±e_osMu‹xLock
 (
±e_mu‹x_‹¡_š™_lock
);

131 ià(*
mu‹x
 >ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

139 *
mu‹x
 = 
NULL
;

147 
»suÉ
 = 
EBUSY
;

150 
	`±e_osMu‹xUÆock
(
±e_mu‹x_‹¡_š™_lock
);

154  (
»suÉ
);

155 
	}
}

	@pthread_mutex_init.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	#ERROR
(
fmt
, 
¬gs
...è
	`ERROR_PRINT
("emb±h»ad: " fmt, ##¬gs)

	)

51 
	#DEBUG
(
fmt
, 
¬gs
...)

	)

52 
	#INFO
(
fmt
, 
¬gs
...è
	`INFO_PRINT
("emb±h»ad: " fmt, ##¬gs)

	)

54 
	#DEBUG
(
fmt
, 
¬gs
...)

	)

55 #ifdeà
NAUT_CONFIG_OPENMP_RT_DEBUG


56 #undeà
DEBUG


57 
	#DEBUG
(
fmt
, 
¬gs
...è
	`DEBUG_PRINT
("emb±h»ad: " fmt, ##¬gs)

	)

61 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 * 
mu‹x
, cÚ¡ 
±h»ad_mu‹x©Œ_t
 * 
©Œ
)

63 
»suÉ
 = 0;

64 
±h»ad_mu‹x_t
 
mx
;

67 ià(
mu‹x
 =ğ
NULL
)

69  
EINVAL
;

72 
mx
 = (
±h»ad_mu‹x_t
è
	`ÿÎoc
 (1,  (*mx));

73 
	`mem£t
(
mx
, 0, 1*(*mx));

74 ià(
mx
 =ğ
NULL
)

76 
»suÉ
 = 
ENOMEM
;

80 
mx
->
lock_idx
 = 0;

81 
mx
->
»cursive_couÁ
 = 0;

82 
	`DEBUG
("©Œ‡dd¸%08x\n", 
©Œ
);

83 
	`DEBUG
("©Œ kšd %08x\n", *
©Œ
);

85 
mx
->
kšd
 = 
PTHREAD_MUTEX_DEFAULT
;

88 ? 
PTHREAD_MUTEX_DEFAULT
 : (*
©Œ
)->
kšd
);

89 
	`DEBUG
("pass mxkind\n");

90 
mx
->
owÃrTh»ad
.
p
 = 
NULL
;

92 
	`±e_osSem­hÜeC»©e
(0,&
mx
->
hªdË
);

96 *
mu‹x
 = 
mx
;

98  (
»suÉ
);

99 
	}
}

	@pthread_mutex_lock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

48 
	#DEBUG
(
fmt
, 
¬gs
...)

	)

50 
	#DEBUG
(
fmt
, 
¬gs
...)

	)

51 #ifdeà
NAUT_CONFIG_OPENMP_RT_DEBUG


52 #undeà
DEBUG


53 
	#DEBUG
(
fmt
, 
¬gs
...è
	`DEBUG_PRINT
("mu‹x_lock: " fmt, ##¬gs)

	)

57 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

59 
»suÉ
 = 0;

60 
±h»ad_mu‹x_t
 
mx
;

65 ià(*
mu‹x
 =ğ
NULL
)

67  
EINVAL
;

76 ià(*
mu‹x
 >ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

78 ià((
»suÉ
 = 
	`±e_mu‹x_check_Ãed_š™
 (
mu‹x
)) != 0)

80  (
»suÉ
);

85 
mx
 = *
mu‹x
;

88 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_NORMAL
)

90 ià(
	`PTE_ATOMIC_EXCHANGE
(

91 &
mx
->
lock_idx
,

94 
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,-1) != 0)

96 ià(
	`±e_osSem­hÜeP’d
(
mx
->
hªdË
,
NULL
è!ğ
PTE_OS_OK
)

98 
»suÉ
 = 
EINVAL
;

106 
±h»ad_t
 
£lf
 = 
	`±h»ad_£lf
();

108 ià(
	`PTE_ATOMIC_COMPARE_EXCHANGE
(&
mx
->
lock_idx
,1,0) == 0)

110 
mx
->
»cursive_couÁ
 = 1;

111 
mx
->
owÃrTh»ad
 = 
£lf
;

115 ià(
	`±h»ad_equ®
 (
mx
->
owÃrTh»ad
, 
£lf
))

117 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_RECURSIVE
)

119 
mx
->
»cursive_couÁ
++;

123 
»suÉ
 = 
EDEADLK
;

128 
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,-1) != 0)

130 ià(
	`±e_osSem­hÜeP’d
(
mx
->
hªdË
,
NULL
è!ğ
PTE_OS_OK
)

132 
»suÉ
 = 
EINVAL
;

137 ià(0 =ğ
»suÉ
)

139 
mx
->
»cursive_couÁ
 = 1;

140 
mx
->
owÃrTh»ad
 = 
£lf
;

146 
	`DEBUG
("mx :%d, mu‹x:%d \n", 
mx
->
lock_idx
, (*
mu‹x
)->lock_idx);

148  (
»suÉ
);

149 
	}
}

	@pthread_mutex_timedlock.c

43 
	~"nk/±e_o§l.h
"

47 
	~<Çutus/Çutus.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

53 
	$±e_timed_ev’twa™
 (
±e_osSem­hÜeHªdË
 
ev’t
, cÚ¡ 
time¥ec
 *
ab¡ime
)

77 
mli£cÚds
;

78 
±e_osResuÉ
 
¡©us
;

79 
»tv®
;

81 ià(
ab¡ime
 =ğ
NULL
)

83 
¡©us
 = 
	`±e_osSem­hÜeP’d
(
ev’t
, 
NULL
);

90 
mli£cÚds
 = 
	`±e_»lmli£cs
 (
ab¡ime
);

92 
¡©us
 = 
	`±e_osSem­hÜeP’d
(
ev’t
, &
mli£cÚds
);

96 ià(
¡©us
 =ğ
PTE_OS_TIMEOUT
)

98 
»tv®
 = 
ETIMEDOUT
;

102 
»tv®
 = 0;

105  
»tv®
;

107 
	}
}

111 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 * 
mu‹x
,

112 cÚ¡ 
time¥ec
 *
ab¡ime
)

114 
»suÉ
;

115 
±h»ad_mu‹x_t
 
mx
;

127 ià(*
mu‹x
 >ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

129 ià((
»suÉ
 = 
	`±e_mu‹x_check_Ãed_š™
 (
mu‹x
)) != 0)

131  (
»suÉ
);

135 
mx
 = *
mu‹x
;

137 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_NORMAL
)

139 ià(
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,1) != 0)

141 
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,-1) != 0)

143 ià(0 !ğ(
»suÉ
 = 
	`±e_timed_ev’twa™
 (
mx
->
hªdË
, 
ab¡ime
)))

145  
»suÉ
;

152 
±h»ad_t
 
£lf
 = 
	`±h»ad_£lf
();

154 ià(
	`PTE_ATOMIC_COMPARE_EXCHANGE
(&
mx
->
lock_idx
,1,0) == 0)

156 
mx
->
»cursive_couÁ
 = 1;

157 
mx
->
owÃrTh»ad
 = 
£lf
;

161 ià(
	`±h»ad_equ®
 (
mx
->
owÃrTh»ad
, 
£lf
))

163 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_RECURSIVE
)

165 
mx
->
»cursive_couÁ
++;

169  
EDEADLK
;

174 
	`PTE_ATOMIC_EXCHANGE
(&
mx
->
lock_idx
,-1) != 0)

176 ià(0 !ğ(
»suÉ
 = 
	`±e_timed_ev’twa™
 (
mx
->
hªdË
, 
ab¡ime
)))

178  
»suÉ
;

182 
mx
->
»cursive_couÁ
 = 1;

183 
mx
->
owÃrTh»ad
 = 
£lf
;

189 
	}
}

	@pthread_mutex_trylock.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

50 
»suÉ
 = 0;

51 
±h»ad_mu‹x_t
 
mx
;

63 ià(*
mu‹x
 >ğ
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

65 ià((
»suÉ
 = 
	`±e_mu‹x_check_Ãed_š™
 (
mu‹x
)) != 0)

67  (
»suÉ
);

71 
mx
 = *
mu‹x
;

73 ià(0 =ğ
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (&
mx
->
lock_idx
,1,0))

75 ià(
mx
->
kšd
 !ğ
PTHREAD_MUTEX_NORMAL
)

77 
mx
->
»cursive_couÁ
 = 1;

78 
mx
->
owÃrTh»ad
 = 
	`±h»ad_£lf
 ();

83 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_RECURSIVE
 &&

84 
	`±h»ad_equ®
 (
mx
->
owÃrTh»ad
, 
	`±h»ad_£lf
 ()))

86 
mx
->
»cursive_couÁ
++;

90 
»suÉ
 = 
EBUSY
;

94  (
»suÉ
);

95 
	}
}

	@pthread_mutex_unlock.c

43 
	~"nk/±e_o§l.h
"

47 
	~<Çutus/Çutus.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

52 
	#TEST_IE
 
IÁ”lockedExchªge


	)

55 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 * 
mu‹x
)

57 
»suÉ
 = 0;

58 
±h»ad_mu‹x_t
 
mx
;

64 
mx
 = *
mu‹x
;

74 ià(
mx
 < 
PTHREAD_ERRORCHECK_MUTEX_INITIALIZER
)

76 ià(
mx
->
kšd
 =ğ
PTHREAD_MUTEX_NORMAL
)

78 
idx
;

80 
idx
 = 
	`PTE_ATOMIC_EXCHANGE
 (&
mx
->
lock_idx
,0);

81 ià(
idx
 != 0)

83 ià(
idx
 < 0)

88 ià(
	`±e_osSem­hÜePo¡
(
mx
->
hªdË
,1è!ğ
PTE_OS_OK
)

90 
»suÉ
 = 
EINVAL
;

99 
»suÉ
 = 
EPERM
;

104 ià(
	`±h»ad_equ®
 (
mx
->
owÃrTh»ad
, 
	`±h»ad_£lf
 ()))

106 ià(
mx
->
kšd
 !ğ
PTHREAD_MUTEX_RECURSIVE


107 || 0 =ğ--
mx
->
»cursive_couÁ
)

109 
mx
->
owÃrTh»ad
.
p
 = 
NULL
;

111 ià(
	`PTE_ATOMIC_EXCHANGE
 (&
mx
->
lock_idx
,0) < 0)

113 ià(
	`±e_osSem­hÜePo¡
(
mx
->
hªdË
,1è!ğ
PTE_OS_OK
)

115 
»suÉ
 = 
EINVAL
;

123 
»suÉ
 = 
EPERM
;

129 
»suÉ
 = 
EINVAL
;

132  (
»suÉ
);

133 
	}
}

	@pthread_mutexattr_destroy.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
)

76 
»suÉ
 = 0;

78 ià(
©Œ
 =ğ
NULL
 || *attr == NULL)

80 
»suÉ
 = 
EINVAL
;

84 
±h»ad_mu‹x©Œ_t
 
ma
 = *
©Œ
;

86 *
©Œ
 = 
NULL
;

87 
	`ä“
 (
ma
);

90  (
»suÉ
);

91 
	}
}

	@pthread_mutexattr_getkind_np.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±h»ad_mu‹x©Œ_g‘kšd_Å
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, *
kšd
)

49  
	`±h»ad_mu‹x©Œ_g‘ty³
 (
©Œ
, 
kšd
);

50 
	}
}

	@pthread_mutexattr_getpshared.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 * 
©Œ
, *
psh¬ed
)

87 
»suÉ
;

89 ià((
©Œ
 !ğ
NULL
 && *©Œ !ğNULLè&& (
psh¬ed
 != NULL))

91 *
psh¬ed
 = (*
©Œ
)->pshared;

92 
»suÉ
 = 0;

96 
»suÉ
 = 
EINVAL
;

99  (
»suÉ
);

101 
	}
}

	@pthread_mutexattr_gettype.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x©Œ_g‘ty³
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, *
kšd
)

50 
»suÉ
 = 0;

52 ià(
©Œ
 !ğ
NULL
 && *©Œ !ğNULL && 
kšd
 != NULL)

54 *
kšd
 = (*
©Œ
)->kind;

58 
»suÉ
 = 
EINVAL
;

61  (
»suÉ
);

62 
	}
}

	@pthread_mutexattr_init.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
)

76 
»suÉ
 = 0;

77 
±h»ad_mu‹x©Œ_t
 
ma
;

79 
ma
 = (
±h»ad_mu‹x©Œ_t
è
	`ÿÎoc
 (1,  (*ma));

81 ià(
ma
 =ğ
NULL
)

83 
»suÉ
 = 
ENOMEM
;

87 
ma
->
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

88 
ma
->
kšd
 = 
PTHREAD_MUTEX_DEFAULT
;

91 *
©Œ
 = 
ma
;

93  (
»suÉ
);

94 
	}
}

	@pthread_mutexattr_setkind_np.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

47 
	$±h»ad_mu‹x©Œ_£tkšd_Å
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, 
kšd
)

49  
	`±h»ad_mu‹x©Œ_£‰y³
 (
©Œ
, 
kšd
);

50 
	}
}

	@pthread_mutexattr_setpshared.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, 
psh¬ed
)

90 
»suÉ
;

92 ià((
©Œ
 !ğ
NULL
 && *attr != NULL) &&

93 ((
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
) ||

94 (
psh¬ed
 =ğ
PTHREAD_PROCESS_PRIVATE
)))

96 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

99 #ià!
	`defšed
Ğ
_POSIX_THREAD_PROCESS_SHARED
 )

101 
»suÉ
 = 
ENOSYS
;

102 
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

106 
»suÉ
 = 0;

113 
»suÉ
 = 0;

116 (*
©Œ
)->
psh¬ed
 =…shared;

120 
»suÉ
 = 
EINVAL
;

123  (
»suÉ
);

125 
	}
}

	@pthread_mutexattr_settype.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 * 
©Œ
, 
kšd
)

127 
»suÉ
 = 0;

129 ià((
©Œ
 !ğ
NULL
 && *attr != NULL))

131 
kšd
)

133 
PTHREAD_MUTEX_FAST_NP
:

134 
PTHREAD_MUTEX_RECURSIVE_NP
:

135 
PTHREAD_MUTEX_ERRORCHECK_NP
:

136 (*
©Œ
)->
kšd
 = kind;

139 
»suÉ
 = 
EINVAL
;

145 
»suÉ
 = 
EINVAL
;

148  (
»suÉ
);

149 
	}
}

	@pthread_num_processors_np.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

52 
	$±h»ad_num_´oûssÜs_Å
 ()

54 
couÁ
;

56 ià(
	`±e_g‘´oûssÜs
 (&
couÁ
) != 0)

58 
couÁ
 = 1;

61  (
couÁ
);

62 
	}
}

	@pthread_once.c

43 
	~"nk/±e_o§l.h
"

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

47 
	#PTE_ONCE_STARTED
 1

	)

48 
	#PTE_ONCE_INIT
 0

	)

49 
	#PTE_ONCE_DONE
 2

	)

52 
	$±e_Úû_š™_routše_ş—nup
(* 
¬g
)

54 
±h»ad_Úû_t
 * 
Úû_cÚŒŞ
 = (±h»ad_Úû_ˆ*è
¬g
;

56 (è
	`PTE_ATOMIC_EXCHANGE
(&
Úû_cÚŒŞ
->
¡©e
,
PTE_ONCE_INIT
);

58 ià(
	`PTE_ATOMIC_EXCHANGE_ADD
((*)&
Úû_cÚŒŞ
->
£m­hÜe
, 0L))

60 
	`±e_osSem­hÜePo¡
((
±e_osSem­hÜeHªdË
è
Úû_cÚŒŞ
->
£m­hÜe
, 1);

62 
	}
}

65 
	$±h»ad_Úû
 (
±h»ad_Úû_t
 * 
Úû_cÚŒŞ
, (*
š™_routše
) ())

103 
»suÉ
;

104 
¡©e
;

105 
±e_osSem­hÜeHªdË
 
£ma
;

107 ià(
Úû_cÚŒŞ
 =ğ
NULL
 || 
š™_routše
 == NULL)

109 
»suÉ
 = 
EINVAL
;

110 
FAIL0
;

114 
»suÉ
 = 0;

117 (
¡©e
 =

118 
	`PTE_ATOMIC_COMPARE_EXCHANGE
(&
Úû_cÚŒŞ
->
¡©e
,

119 
PTE_ONCE_STARTED
,

120 
PTE_ONCE_INIT
))

121 !ğ
PTE_ONCE_DONE
)

123 ià(
PTE_ONCE_INIT
 =ğ
¡©e
)

127 
	`±h»ad_ş—nup_push
(
±e_Úû_š™_routše_ş—nup
, (*è
Úû_cÚŒŞ
);

128 (*
š™_routše
)();

129 
	`±h»ad_ş—nup_pİ
(0);

131 (è
	`PTE_ATOMIC_EXCHANGE
(&
Úû_cÚŒŞ
->
¡©e
,
PTE_ONCE_DONE
);

137 ià(
	`PTE_ATOMIC_EXCHANGE_ADD
((*)&
Úû_cÚŒŞ
->
£m­hÜe
, 0L))

139 
	`±e_osSem­hÜePo¡
((
±e_osSem­hÜeHªdË
è
Úû_cÚŒŞ
->
£m­hÜe
,Úû_cÚŒŞ->
numSem­hÜeU£rs
);

144 
	`PTE_ATOMIC_INCREMENT
(&
Úû_cÚŒŞ
->
numSem­hÜeU£rs
);

146 ià(!
	`PTE_ATOMIC_EXCHANGE_ADD
((*)&
Úû_cÚŒŞ
->
£m­hÜe
, 0L))

148 
	`±e_osSem­hÜeC»©e
(0, (
±e_osSem­hÜeHªdË
*è&
£ma
);

150 ià(
	`PTE_ATOMIC_COMPARE_EXCHANGE
((*è&
Úû_cÚŒŞ
->
£m­hÜe
,

151 (è
£ma
,

154 
	`±e_osSem­hÜeD–‘e
((
±e_osSem­hÜeHªdË
)
£ma
);

162 ià(
	`PTE_ATOMIC_EXCHANGE_ADD
(&
Úû_cÚŒŞ
->
¡©e
, 0Lè=ğ
PTE_ONCE_STARTED
)

164 
	`±e_osSem­hÜeP’d
((
±e_osSem­hÜeHªdË
è
Úû_cÚŒŞ
->
£m­hÜe
,
NULL
);

167 ià(0 =ğ
	`PTE_ATOMIC_DECREMENT
(&
Úû_cÚŒŞ
->
numSem­hÜeU£rs
))

170 ià((
£ma
 =

171 (
±e_osSem­hÜeHªdË
è
	`PTE_ATOMIC_EXCHANGE
((*è&
Úû_cÚŒŞ
->
£m­hÜe
,0)))

173 
	`±e_osSem­hÜeD–‘e
(
£ma
);

184 
FAIL0
:

185  (
»suÉ
);

186 
	}
}

	@pthread_rwlock_destroy.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

51 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 * 
rwlock
)

53 
±h»ad_rwlock_t
 
rwl
;

54 
»suÉ
 = 0, 
»suÉ1
 = 0, 
»suÉ2
 = 0;

56 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

58  
EINVAL
;

61 ià(*
rwlock
 !ğ
PTHREAD_RWLOCK_INITIALIZER
)

63 
rwl
 = *
rwlock
;

65 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

67  
EINVAL
;

70 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

72  
»suÉ
;

75 ià((
»suÉ
 =

76 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

78 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

79  
»suÉ
;

86 ià(
rwl
->
nExşusiveAcûssCouÁ
 > 0

87 || 
rwl
->
nSh¬edAcûssCouÁ
 >„wl->
nCom¶‘edSh¬edAcûssCouÁ
)

89 
»suÉ
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

90 
»suÉ1
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

91 
»suÉ2
 = 
EBUSY
;

95 
rwl
->
nMagic
 = 0;

97 ià((
»suÉ
 =

98 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

100 
	`±h»ad_mu‹x_uÆock
 (&
rwl
->
mtxExşusiveAcûss
);

101  
»suÉ
;

104 ià((
»suÉ
 =

105 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

107  
»suÉ
;

110 *
rwlock
 = 
NULL
;

111 
»suÉ
 = 
	`±h»ad_cÚd_de¡roy
 (&(
rwl
->
údSh¬edAcûssCom¶‘ed
));

112 
»suÉ1
 = 
	`±h»ad_mu‹x_de¡roy
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

113 
»suÉ2
 = 
	`±h»ad_mu‹x_de¡roy
 (&(
rwl
->
mtxExşusiveAcûss
));

114 
	`ä“
 (
rwl
);

123 
	`±e_osMu‹xLock
 (
±e_rwlock_‹¡_š™_lock
);

128 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

136 *
rwlock
 = 
NULL
;

144 
»suÉ
 = 
EBUSY
;

147 
	`±e_osMu‹xUÆock
(
±e_rwlock_‹¡_š™_lock
);

151  ((
»suÉ
 !ğ0è?„esuÉ : ((
»suÉ1
 !ğ0è?„esuÉ1 : 
»suÉ2
));

152 
	}
}

	@pthread_rwlock_init.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

51 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 * 
rwlock
,

52 cÚ¡ 
±h»ad_rwlock©Œ_t
 * 
©Œ
)

54 
»suÉ
;

55 
±h»ad_rwlock_t
 
rwl
 = 0;

57 ià(
rwlock
 =ğ
NULL
)

59  
EINVAL
;

62 ià(
©Œ
 !ğ
NULL
 && *attr != NULL)

64 
»suÉ
 = 
EINVAL
;

65 
DONE
;

68 
rwl
 = (
±h»ad_rwlock_t
è
	`ÿÎoc
 (1,  (*rwl));

70 ià(
rwl
 =ğ
NULL
)

72 
»suÉ
 = 
ENOMEM
;

73 
DONE
;

76 
rwl
->
nSh¬edAcûssCouÁ
 = 0;

77 
rwl
->
nExşusiveAcûssCouÁ
 = 0;

78 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

80 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (&
rwl
->
mtxExşusiveAcûss
, 
NULL
);

81 ià(
»suÉ
 != 0)

83 
FAIL0
;

86 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (&
rwl
->
mtxSh¬edAcûssCom¶‘ed
, 
NULL
);

87 ià(
»suÉ
 != 0)

89 
FAIL1
;

92 
»suÉ
 = 
	`±h»ad_cÚd_š™
 (&
rwl
->
údSh¬edAcûssCom¶‘ed
, 
NULL
);

93 ià(
»suÉ
 != 0)

95 
FAIL2
;

98 
rwl
->
nMagic
 = 
PTE_RWLOCK_MAGIC
;

100 
»suÉ
 = 0;

101 
DONE
;

103 
FAIL2
:

104 (è
	`±h»ad_mu‹x_de¡roy
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

106 
FAIL1
:

107 (è
	`±h»ad_mu‹x_de¡roy
 (&(
rwl
->
mtxExşusiveAcûss
));

109 
FAIL0
:

110 
	`ä“
(
rwl
)

112 
rwl
 = 
NULL
;

114 
DONE
:

115 *
rwlock
 = 
rwl
;

117  
»suÉ
;

118 
	}
}

	@pthread_rwlock_rdlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  
EINVAL
;

66 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

70 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

72  
»suÉ
;

76 
rwl
 = *
rwlock
;

78 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

80  
EINVAL
;

83 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

85  
»suÉ
;

88 ià(++
rwl
->
nSh¬edAcûssCouÁ
 =ğ
INT_MAX
)

90 ià((
»suÉ
 =

91 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

93 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

94  
»suÉ
;

97 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

98 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

100 ià((
»suÉ
 =

101 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

103 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

104  
»suÉ
;

108  (
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
)));

109 
	}
}

	@pthread_rwlock_timedrdlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 * 
rwlock
,

51 cÚ¡ 
time¥ec
 *
ab¡ime
)

53 
»suÉ
;

54 
±h»ad_rwlock_t
 
rwl
;

56 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

58  
EINVAL
;

67 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

69 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

71 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

73  
»suÉ
;

77 
rwl
 = *
rwlock
;

79 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

81  
EINVAL
;

84 ià((
»suÉ
 =

85 
	`±h»ad_mu‹x_timedlock
 (&(
rwl
->
mtxExşusiveAcûss
), 
ab¡ime
)) != 0)

87  
»suÉ
;

90 ià(++
rwl
->
nSh¬edAcûssCouÁ
 =ğ
INT_MAX
)

92 ià((
»suÉ
 =

93 
	`±h»ad_mu‹x_timedlock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
),

94 
ab¡ime
)) != 0)

96 ià(
»suÉ
 =ğ
ETIMEDOUT
)

98 ++
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
;

100 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

101  
»suÉ
;

104 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

105 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

107 ià((
»suÉ
 =

108 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

110 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

111  
»suÉ
;

115  (
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
)));

116 
	}
}

	@pthread_rwlock_timedwrlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 * 
rwlock
,

51 cÚ¡ 
time¥ec
 *
ab¡ime
)

53 
»suÉ
;

54 
±h»ad_rwlock_t
 
rwl
;

56 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

58  
EINVAL
;

67 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

69 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

71 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

73  
»suÉ
;

77 
rwl
 = *
rwlock
;

79 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

81  
EINVAL
;

84 ià((
»suÉ
 =

85 
	`±h»ad_mu‹x_timedlock
 (&(
rwl
->
mtxExşusiveAcûss
), 
ab¡ime
)) != 0)

87  
»suÉ
;

90 ià((
»suÉ
 =

91 
	`±h»ad_mu‹x_timedlock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
),

92 
ab¡ime
)) != 0)

94 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

95  
»suÉ
;

98 ià(
rwl
->
nExşusiveAcûssCouÁ
 == 0)

100 ià(
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 > 0)

102 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

103 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

106 ià(
rwl
->
nSh¬edAcûssCouÁ
 > 0)

108 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = -rwl->
nSh¬edAcûssCouÁ
;

114 
	`±h»ad_ş—nup_push
 (
±e_rwlock_ÿnûlwrwa™
, (*è
rwl
);

118 
»suÉ
 =

119 
	`±h»ad_cÚd_timedwa™
 (&(
rwl
->
údSh¬edAcûssCom¶‘ed
),

120 &(
rwl
->
mtxSh¬edAcûssCom¶‘ed
),

121 
ab¡ime
);

123 
»suÉ
 =ğ0 && 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 < 0);

125 
	`±h»ad_ş—nup_pİ
 ((
»suÉ
 != 0) ? 1 : 0);

127 ià(
»suÉ
 == 0)

129 
rwl
->
nSh¬edAcûssCouÁ
 = 0;

134 ià(
»suÉ
 == 0)

136 
rwl
->
nExşusiveAcûssCouÁ
++;

139  
»suÉ
;

140 
	}
}

	@pthread_rwlock_tryrdlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  
EINVAL
;

66 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

70 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

72  
»suÉ
;

76 
rwl
 = *
rwlock
;

78 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

80  
EINVAL
;

83 ià((
»suÉ
 = 
	`±h»ad_mu‹x_Œylock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

85  
»suÉ
;

88 ià(++
rwl
->
nSh¬edAcûssCouÁ
 =ğ
INT_MAX
)

90 ià((
»suÉ
 =

91 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

93 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

94  
»suÉ
;

97 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

98 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

100 ià((
»suÉ
 =

101 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

103 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

104  
»suÉ
;

108  (
	`±h»ad_mu‹x_uÆock
 (&
rwl
->
mtxExşusiveAcûss
));

109 
	}
}

	@pthread_rwlock_trywrlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
, 
»suÉ1
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  
EINVAL
;

66 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

70 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

72  
»suÉ
;

76 
rwl
 = *
rwlock
;

78 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

80  
EINVAL
;

83 ià((
»suÉ
 = 
	`±h»ad_mu‹x_Œylock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

85  
»suÉ
;

88 ià((
»suÉ
 =

89 
	`±h»ad_mu‹x_Œylock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

91 
»suÉ1
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

92  ((
»suÉ1
 !ğ0è?„esuÉ1 : 
»suÉ
);

95 ià(
rwl
->
nExşusiveAcûssCouÁ
 == 0)

97 ià(
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 > 0)

99 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

100 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

103 ià(
rwl
->
nSh¬edAcûssCouÁ
 > 0)

105 ià((
»suÉ
 =

106 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

108 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

109  
»suÉ
;

112 ià((
»suÉ
 =

113 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
))) == 0)

115 
»suÉ
 = 
EBUSY
;

120 
rwl
->
nExşusiveAcûssCouÁ
 = 1;

125 
»suÉ
 = 
EBUSY
;

128  
»suÉ
;

129 
	}
}

	@pthread_rwlock_unlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
, 
»suÉ1
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  (
EINVAL
);

60 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
rwl
 = *
rwlock
;

70 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

72  
EINVAL
;

75 ià(
rwl
->
nExşusiveAcûssCouÁ
 == 0)

77 ià((
»suÉ
 =

78 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

80  
»suÉ
;

83 ià(++
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 == 0)

85 
»suÉ
 = 
	`±h»ad_cÚd_sigÇl
 (&(
rwl
->
údSh¬edAcûssCom¶‘ed
));

88 
»suÉ1
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

92 
rwl
->
nExşusiveAcûssCouÁ
--;

94 
»suÉ
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

95 
»suÉ1
 = 
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

99  ((
»suÉ
 !ğ0è?„esuÉ : 
»suÉ1
);

100 
	}
}

	@pthread_rwlock_wrlock.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 * 
rwlock
)

52 
»suÉ
;

53 
±h»ad_rwlock_t
 
rwl
;

55 ià(
rwlock
 =ğ
NULL
 || *rwlock == NULL)

57  
EINVAL
;

66 ià(*
rwlock
 =ğ
PTHREAD_RWLOCK_INITIALIZER
)

68 
»suÉ
 = 
	`±e_rwlock_check_Ãed_š™
 (
rwlock
);

70 ià(
»suÉ
 !ğ0 &&„esuÉ !ğ
EBUSY
)

72  
»suÉ
;

76 
rwl
 = *
rwlock
;

78 ià(
rwl
->
nMagic
 !ğ
PTE_RWLOCK_MAGIC
)

80  
EINVAL
;

83 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxExşusiveAcûss
))) != 0)

85  
»suÉ
;

88 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&(
rwl
->
mtxSh¬edAcûssCom¶‘ed
))) != 0)

90 (è
	`±h»ad_mu‹x_uÆock
 (&(
rwl
->
mtxExşusiveAcûss
));

91  
»suÉ
;

94 ià(
rwl
->
nExşusiveAcûssCouÁ
 == 0)

96 ià(
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 > 0)

98 
rwl
->
nSh¬edAcûssCouÁ
 -ğrwl->
nCom¶‘edSh¬edAcûssCouÁ
;

99 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = 0;

102 ià(
rwl
->
nSh¬edAcûssCouÁ
 > 0)

104 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 = -rwl->
nSh¬edAcûssCouÁ
;

110 
	`±h»ad_ş—nup_push
 (
±e_rwlock_ÿnûlwrwa™
, (*è
rwl
);

114 
»suÉ
 = 
	`±h»ad_cÚd_wa™
 (&(
rwl
->
údSh¬edAcûssCom¶‘ed
),

115 &(
rwl
->
mtxSh¬edAcûssCom¶‘ed
));

117 
»suÉ
 =ğ0 && 
rwl
->
nCom¶‘edSh¬edAcûssCouÁ
 < 0);

119 
	`±h»ad_ş—nup_pİ
 ((
»suÉ
 != 0) ? 1 : 0);

121 ià(
»suÉ
 == 0)

123 
rwl
->
nSh¬edAcûssCouÁ
 = 0;

128 ià(
»suÉ
 == 0)

130 
rwl
->
nExşusiveAcûssCouÁ
++;

133  
»suÉ
;

134 
	}
}

	@pthread_rwlockattr_destroy.c

46 
	~<Çutus/Çutus.h
>

47 
	~<Çutus/Çut_¡ršg.h
>

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

52 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
)

78 
»suÉ
 = 0;

80 ià(
©Œ
 =ğ
NULL
 || *attr == NULL)

82 
»suÉ
 = 
EINVAL
;

86 
±h»ad_rwlock©Œ_t
 
rwa
 = *
©Œ
;

88 *
©Œ
 = 
NULL
;

89 
	`ä“
 (
rwa
);

92  (
»suÉ
);

93 
	}
}

	@pthread_rwlockattr_getpshared.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 * 
©Œ
,

51 *
psh¬ed
)

90 
»suÉ
;

92 ià((
©Œ
 !ğ
NULL
 && *©Œ !ğNULLè&& (
psh¬ed
 != NULL))

94 *
psh¬ed
 = (*
©Œ
)->pshared;

95 
»suÉ
 = 0;

99 
»suÉ
 = 
EINVAL
;

102  (
»suÉ
);

104 
	}
}

	@pthread_rwlockattr_init.c

46 
	~<Çutus/Çutus.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

51 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
)

74 
»suÉ
 = 0;

75 
±h»ad_rwlock©Œ_t
 
rwa
;

77 
rwa
 = (
±h»ad_rwlock©Œ_t
è
	`ÿÎoc
 (1,  (*rwa));

79 ià(
rwa
 =ğ
NULL
)

81 
»suÉ
 = 
ENOMEM
;

85 
rwa
->
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

88 *
©Œ
 = 
rwa
;

90  (
»suÉ
);

91 
	}
}

	@pthread_rwlockattr_setpshared.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

50 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 * 
©Œ
, 
psh¬ed
)

92 
»suÉ
;

94 ià((
©Œ
 !ğ
NULL
 && *attr != NULL) &&

95 ((
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
) ||

96 (
psh¬ed
 =ğ
PTHREAD_PROCESS_PRIVATE
)))

98 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

101 #ià!
	`defšed
Ğ
_POSIX_THREAD_PROCESS_SHARED
 )

103 
»suÉ
 = 
ENOSYS
;

104 
psh¬ed
 = 
PTHREAD_PROCESS_PRIVATE
;

108 
»suÉ
 = 0;

115 
»suÉ
 = 0;

118 (*
©Œ
)->
psh¬ed
 =…shared;

122 
»suÉ
 = 
EINVAL
;

125  (
»suÉ
);

127 
	}
}

	@pthread_self.c

45 
	~<Çutus/Çutus.h
>

46 
	~"±h»ad.h
"

47 
	~"im¶em’t.h
"

49 
±h»ad_t


50 
	$±h»ad_£lf
 ()

71 
±h»ad_t
 
£lf
;

72 
±e_th»ad_t
 * 
¥
;

74 
¥
 = (
±e_th»ad_t
 *è
	`±h»ad_g‘¥ecific
 (
±e_£lfTh»adKey
);

76 ià(
¥
 !ğ
NULL
)

78 
£lf
 = 
¥
->
±HªdË
;

90 
£lf
 = 
	`±e_Ãw
 ();

91 
¥
 = (
±e_th»ad_t
 *è
£lf
.
p
;

93 ià(
¥
 !ğ
NULL
)

101 
¥
->
im¶ic™
 = 1;

102 
¥
->
d‘achS‹
 = 
PTHREAD_CREATE_DETACHED
;

104 
¥
->
th»adId
 = 
	`±e_osTh»adG‘HªdË
();

109 
¥
->
sched_´iÜ™y
 = 0;

111 
	`±h»ad_£t¥ecific
 (
±e_£lfTh»adKey
, (*è
¥
);

115  (
£lf
);

117 
	}
}

	@pthread_setcancelstate.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_£tÿnûl¡©e
 (
¡©e
, *
Şd¡©e
)

88 
»suÉ
 = 0;

89 
±h»ad_t
 
£lf
 = 
	`±h»ad_£lf
 ();

90 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
£lf
.
p
;

92 ià(
¥
 =ğ
NULL


93 || (
¡©e
 !ğ
PTHREAD_CANCEL_ENABLE
 && s‹ !ğ
PTHREAD_CANCEL_DISABLE
))

95  
EINVAL
;

101 (è
	`±h»ad_mu‹x_lock
 (&
¥
->
ÿnûlLock
);

103 ià(
Şd¡©e
 !ğ
NULL
)

105 *
Şd¡©e
 = 
¥
->
ÿnûlS‹
;

108 
¥
->
ÿnûlS‹
 = 
¡©e
;

113 ià(
¡©e
 =ğ
PTHREAD_CANCEL_ENABLE


114 && (
¥
->
ÿnûlTy³
 =ğ
PTHREAD_CANCEL_ASYNCHRONOUS
)

115 && (
	`±e_osTh»adCheckCªûl
(
¥
->
th»adId
è=ğ
PTE_OS_INTERRUPTED
) )

117 
¥
->
¡©e
 = 
PTh»adS‹Cªûlšg
;

118 
¥
->
ÿnûlS‹
 = 
PTHREAD_CANCEL_DISABLE
;

119 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

120 
	`±e_throw
 (
PTE_EPS_CANCEL
);

125 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

127  (
»suÉ
);

129 
	}
}

	@pthread_setcanceltype.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_£tÿnûÉy³
 (
ty³
, *
Şdty³
)

89 
»suÉ
 = 0;

90 
±h»ad_t
 
£lf
 = 
	`±h»ad_£lf
 ();

91 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
£lf
.
p
;

93 #iâdeà
PTE_SUPPORT_ASYNC_CANCEL


94 ià(
ty³
 =ğ
PTHREAD_CANCEL_ASYNCHRONOUS
)

99  
EPERM
;

103 ià(
¥
 =ğ
NULL


104 || (
ty³
 !ğ
PTHREAD_CANCEL_DEFERRED


105 && 
ty³
 !ğ
PTHREAD_CANCEL_ASYNCHRONOUS
))

107  
EINVAL
;

113 (è
	`±h»ad_mu‹x_lock
 (&
¥
->
ÿnûlLock
);

115 ià(
Şdty³
 !ğ
NULL
)

117 *
Şdty³
 = 
¥
->
ÿnûlTy³
;

120 
¥
->
ÿnûlTy³
 = 
ty³
;

126 ià(
¥
->
ÿnûlS‹
 =ğ
PTHREAD_CANCEL_ENABLE


127 && (
ty³
 =ğ
PTHREAD_CANCEL_ASYNCHRONOUS
)

128 && (
	`±e_osTh»adCheckCªûl
(
¥
->
th»adId
è=ğ
PTE_OS_INTERRUPTED
) )

130 
¥
->
¡©e
 = 
PTh»adS‹Cªûlšg
;

131 
¥
->
ÿnûlS‹
 = 
PTHREAD_CANCEL_DISABLE
;

132 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

133 
	`±e_throw
 (
PTE_EPS_CANCEL
);

138 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

140  (
»suÉ
);

142 
	}
}

	@pthread_setconcurrency.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_£tcÚcu¼’cy
 (
Ëv–
)

50 ià(
Ëv–
 < 0)

52  
EINVAL
;

56 
±e_cÚcu¼’cy
 = 
Ëv–
;

59 
	}
}

	@pthread_setschedparam.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
th»ad
, 
pŞicy
,

49 cÚ¡ 
sched_·¿m
 *
·¿m
)

51 
»suÉ
;

54 
»suÉ
 = 
	`±h»ad_kl
 (
th»ad
, 0);

55 ià(0 !ğ
»suÉ
)

57  
»suÉ
;

61 ià(
pŞicy
 < 
SCHED_MIN
 ||…Şicy > 
SCHED_MAX
)

63  
EINVAL
;

67 ià(
pŞicy
 !ğ
SCHED_OTHER
)

69  
ENOTSUP
;

72  (
	`±e_£‰h»ad´iÜ™y
 (
th»ad
, 
pŞicy
, 
·¿m
->
sched_´iÜ™y
));

73 
	}
}

77 
	$±e_£‰h»ad´iÜ™y
 (
±h»ad_t
 
th»ad
, 
pŞicy
, 
´iÜ™y
)

79 
´io
;

80 
»suÉ
;

81 
±e_th»ad_t
 * 

 = (±e_th»ad_ˆ*è
th»ad
.
p
;

83 
´io
 = 
´iÜ™y
;

86 ià(
´io
 < 
	`sched_g‘_´iÜ™y_mš
 (
pŞicy
) ||

87 
´io
 > 
	`sched_g‘_´iÜ™y_max
 (
pŞicy
))

89  
EINVAL
;

92 
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&

->
th»adLock
);

94 ià(0 =ğ
»suÉ
)

98 ià(0 !ğ
	`±e_osTh»adS‘PriÜ™y
(

->
th»adId
, 
´io
))

100 
»suÉ
 = 
EINVAL
;

108 

->
sched_´iÜ™y
 = 
´iÜ™y
;

111 (è
	`±h»ad_mu‹x_uÆock
 (&

->
th»adLock
);

114  
»suÉ
;

115 
	}
}

	@pthread_setspecific.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

50 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
key
, cÚ¡ *
v®ue
)

76 
±h»ad_t
 
£lf
;

77 
»suÉ
 = 0;

79 ià(
key
 !ğ
±e_£lfTh»adKey
)

86 
£lf
 = 
	`±h»ad_£lf
 ();

87 ià(
£lf
.
p
 =ğ
NULL
)

89  
ENOENT
;

98 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
	`±h»ad_g‘¥ecific
 (
±e_£lfTh»adKey
);

100 ià(
¥
 =ğ
NULL
)

102 ià(
v®ue
 =ğ
NULL
)

104  
ENOENT
;

107 
£lf
 = *((
±h»ad_t
 *è
v®ue
);

111 
£lf
 = 
¥
->
±HªdË
;

115 
»suÉ
 = 0;

117 ià(
key
 !ğ
NULL
)

119 ià(
£lf
.
p
 !ğ
NULL
 && 
key
->
de¡ruùÜ
 !ğNULL && 
v®ue
 != NULL)

130 
Th»adKeyAssoc
 *
assoc
;

132 ià(
	`±h»ad_mu‹x_lock
(&(
key
->
keyLock
)) == 0)

134 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
£lf
.
p
;

136 (è
	`±h»ad_mu‹x_lock
(&(
¥
->
th»adLock
));

138 
assoc
 = (
Th»adKeyAssoc
 *è
¥
->
keys
;

142 
assoc
 !ğ
NULL
)

144 ià(
assoc
->
key
 == key)

151 
assoc
 =‡ssoc->
ÃxtKey
;

157 ià(
assoc
 =ğ
NULL
)

159 
»suÉ
 = 
	`±e_tkAssocC»©e
 (
¥
, 
key
);

162 (è
	`±h»ad_mu‹x_uÆock
(&(
¥
->
th»adLock
));

164 (è
	`±h»ad_mu‹x_uÆock
(&(
key
->
keyLock
));

167 ià(
»suÉ
 == 0)

169 ià(
	`±e_osTlsS‘V®ue
 (
key
->key, (*è
v®ue
è!ğ
PTE_OS_OK
)

171 
»suÉ
 = 
EAGAIN
;

177  (
»suÉ
);

178 
	}
}

	@pthread_spin_destroy.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 * 
lock
)

52 
±h»ad_¥šlock_t
 
s
;

53 
»suÉ
 = 0;

55 ià(
lock
 =ğ
NULL
 || *lock == NULL)

57  
EINVAL
;

60 ià((
s
 = *
lock
è!ğ
PTHREAD_SPINLOCK_INITIALIZER
)

62 ià(
s
->
š‹¾ock
 =ğ
PTE_SPIN_USE_MUTEX
)

64 
»suÉ
 = 
	`±h»ad_mu‹x_de¡roy
 (&(
s
->
u
.
mu‹x
));

66 ià(
PTE_SPIN_UNLOCKED
 !=

67 
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (

68 & (
s
->
š‹¾ock
),

69 (è
PTE_OBJECT_INVALID
,

70 
PTE_SPIN_UNLOCKED
))

72 
»suÉ
 = 
EINVAL
;

75 ià(0 =ğ
»suÉ
)

81 *
lock
 = 
NULL
;

82 
	`ä“
(
s
);

92 
	`±e_osMu‹xLock
 (
±e_¥šlock_‹¡_š™_lock
);

97 ià(*
lock
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

105 *
lock
 = 
NULL
;

113 
»suÉ
 = 
EBUSY
;

116 
	`±e_osMu‹xUÆock
(
±e_¥šlock_‹¡_š™_lock
);

120  (
»suÉ
);

121 
	}
}

	@pthread_spin_init.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"im¶em’t.h
"

50 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 * 
lock
, 
psh¬ed
)

52 
±h»ad_¥šlock_t
 
s
;

53 
ıus
 = 0;

54 
»suÉ
 = 0;

56 ià(
lock
 =ğ
NULL
)

58  
EINVAL
;

61 ià(0 !ğ
	`±e_g‘´oûssÜs
 (&
ıus
))

63 
ıus
 = 1;

66 ià(
ıus
 > 1)

68 ià(
psh¬ed
 =ğ
PTHREAD_PROCESS_SHARED
)

74 #ià
_POSIX_THREAD_PROCESS_SHARED
 >= 0

80 #”rÜ 
ERROR
 [
__FILE__
, 
lše
 
__LINE__
]: 
Proûss
 
sh¬ed
 
¥š
 
locks
 
¬e
 
nÙ
 
suµÜ‹d
 
y‘
.

84  
ENOSYS
;

91 
s
 = (
±h»ad_¥šlock_t
è
	`ÿÎoc
 (1,  (*s));

93 ià(
s
 =ğ
NULL
)

95  
ENOMEM
;

98 ià(
ıus
 > 1)

100 
s
->
u
.
ıus
 = cpus;

101 
s
->
š‹¾ock
 = 
PTE_SPIN_UNLOCKED
;

105 
±h»ad_mu‹x©Œ_t
 
ma
;

106 
»suÉ
 = 
	`±h»ad_mu‹x©Œ_š™
 (&
ma
);

108 ià(0 =ğ
»suÉ
)

110 
ma
->
psh¬ed
 =…shared;

111 
»suÉ
 = 
	`±h»ad_mu‹x_š™
 (&(
s
->
u
.
mu‹x
), &
ma
);

112 ià(0 =ğ
»suÉ
)

114 
s
->
š‹¾ock
 = 
PTE_SPIN_USE_MUTEX
;

117 (è
	`±h»ad_mu‹x©Œ_de¡roy
 (&
ma
);

120 ià(0 =ğ
»suÉ
)

122 *
lock
 = 
s
;

126 
	`ä“
(
s
);

128 *
lock
 = 
NULL
;

131  (
»suÉ
);

132 
	}
}

	@pthread_spin_lock.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 * 
lock
)

50 
±h»ad_¥šlock_t
 
s
;

52 ià(
NULL
 =ğ
lock
 || NULL == *lock)

54  (
EINVAL
);

57 ià(*
lock
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

59 
»suÉ
;

61 ià((
»suÉ
 = 
	`±e_¥šlock_check_Ãed_š™
 (
lock
)) != 0)

63  (
»suÉ
);

67 
s
 = *
lock
;

69  
PTE_SPIN_LOCKED
 ==

70 
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (&(
s
->
š‹¾ock
),

71 
PTE_SPIN_LOCKED
,

72 
PTE_SPIN_UNLOCKED
))

76 ià(
s
->
š‹¾ock
 =ğ
PTE_SPIN_LOCKED
)

80 ià(
s
->
š‹¾ock
 =ğ
PTE_SPIN_USE_MUTEX
)

82  
	`±h»ad_mu‹x_lock
 (&(
s
->
u
.
mu‹x
));

85  
EINVAL
;

86 
	}
}

	@pthread_spin_trylock.c

44 
	~"±h»ad.h
"

45 
	~"im¶em’t.h
"

49 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 * 
lock
)

51 
±h»ad_¥šlock_t
 
s
;

53 ià(
NULL
 =ğ
lock
 || NULL == *lock)

55  (
EINVAL
);

58 ià(*
lock
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

60 
»suÉ
;

62 ià((
»suÉ
 = 
	`±e_¥šlock_check_Ãed_š™
 (
lock
)) != 0)

64  (
»suÉ
);

68 
s
 = *
lock
;

71 
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (&(
s
->
š‹¾ock
),

72 
PTE_SPIN_LOCKED
,

73 
PTE_SPIN_UNLOCKED
))

75 
PTE_SPIN_UNLOCKED
:

77 
PTE_SPIN_LOCKED
:

78  
EBUSY
;

79 
PTE_SPIN_USE_MUTEX
:

80  
	`±h»ad_mu‹x_Œylock
 (&(
s
->
u
.
mu‹x
));

83  
EINVAL
;

84 
	}
}

	@pthread_spin_unlock.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 * 
lock
)

50 
±h»ad_¥šlock_t
 
s
;

52 ià(
NULL
 =ğ
lock
 || NULL == *lock)

54  (
EINVAL
);

57 
s
 = *
lock
;

59 ià(
s
 =ğ
PTHREAD_SPINLOCK_INITIALIZER
)

61  
EPERM
;

65 
	`PTE_ATOMIC_COMPARE_EXCHANGE
 (&(
s
->
š‹¾ock
),

66 
PTE_SPIN_UNLOCKED
,

67 
PTE_SPIN_LOCKED
))

69 
PTE_SPIN_LOCKED
:

71 
PTE_SPIN_UNLOCKED
:

72  
EPERM
;

73 
PTE_SPIN_USE_MUTEX
:

74  
	`±h»ad_mu‹x_uÆock
 (&(
s
->
u
.
mu‹x
));

77  
EINVAL
;

78 
	}
}

	@pthread_terminate.c

45 
	~<Çutus/Çutus.h
>

46 
	~<Çutus/Çut_¡ršg.h
>

47 
	~"±h»ad.h
"

48 
	~"im¶em’t.h
"

51 
	$±h»ad_‹rmš©e
()

53 ià(
±e_´oûssIn™Ÿlized
)

55 
±e_th»ad_t
 * 

, * 
Next
;

57 ià(
±e_£lfTh»adKey
 !ğ
NULL
)

62 
	`±h»ad_key_d–‘e
 (
±e_£lfTh»adKey
);

64 
±e_£lfTh»adKey
 = 
NULL
;

67 ià(
±e_ş—nupKey
 !ğ
NULL
)

72 
	`±h»ad_key_d–‘e
 (
±e_ş—nupKey
);

74 
±e_ş—nupKey
 = 
NULL
;

77 
	`±e_osMu‹xLock
 (
±e_th»ad_»u£_lock
);

80 

 = 
±e_th»adReu£Tİ
;

81 

 !ğ
PTE_THREAD_REUSE_EMPTY
)

83 
Next
 = 

->
´evReu£
;

84 
	`ä“
 (

);

85 

 = 
Next
;

88 
	`±e_osMu‹xUÆock
(
±e_th»ad_»u£_lock
);

90 
±e_´oûssIn™Ÿlized
 = 
PTE_FALSE
;

93 
	}
}

	@pthread_testcancel.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

48 
	$±h»ad_‹¡ÿnûl
 ()

77 
±h»ad_t
 
£lf
 = 
	`±h»ad_£lf
 ();

78 
±e_th»ad_t
 * 
¥
 = (±e_th»ad_ˆ*è
£lf
.
p
;

80 ià(
¥
 =ğ
NULL
)

90 ià(
¥
->
¡©e
 !ğ
PTh»adS‹CªûlP’dšg
)

95 (è
	`±h»ad_mu‹x_lock
 (&
¥
->
ÿnûlLock
);

97 ià(
¥
->
ÿnûlS‹
 !ğ
PTHREAD_CANCEL_DISABLE
)

99 
¥
->
¡©e
 = 
PTh»adS‹Cªûlšg
;

100 
¥
->
ÿnûlS‹
 = 
PTHREAD_CANCEL_DISABLE
;

102 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

103 
	`±e_throw
 (
PTE_EPS_CANCEL
);

106 (è
	`±h»ad_mu‹x_uÆock
 (&
¥
->
ÿnûlLock
);

107 
	}
}

	@pthread_timechange_handler_np.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

71 
	$±h»ad_timechªge_hªdËr_Å
 (*
¬g
)

97 
»suÉ
 = 0;

98 
±h»ad_cÚd_t
 
cv
;

101 
	`±e_osMu‹xLock
 (
±e_cÚd_li¡_lock
);

103 
cv
 = 
±e_cÚd_li¡_h—d
;

105 
cv
 !ğ
NULL
 && 0 =ğ
»suÉ
)

107 
»suÉ
 = 
	`±h»ad_cÚd_brßdÿ¡
 (&
cv
);

108 
cv
 = cv->
Ãxt
;

111 
	`±e_osMu‹xUÆock
(
±e_cÚd_li¡_lock
);

113  (*è(
»suÉ
 !ğ0 ? 
EAGAIN
 : 0);

114 
	}
}

	@pthreadtest.c

1 
	~<Çutus/Çutus.h
>

2 
	~<Çutus/sh–l.h
>

3 
	~<Çutus/libccom·t.h
>

4 
	~"im¶em’t.h
"

5 #iâdeà
NAUT_CONFIG_DEBUG_GPUDEV


6 #undeà
DEBUG_PRINT


7 
	#DEBUG_PRINT
(
fmt
, 
¬gs
...)

	)

10 
	#ERROR
(
fmt
, 
¬gs
...è
	`ERROR_PRINT
("om±e¡: " fmt, ##¬gs)

	)

11 
	#DEBUG
(
fmt
, 
¬gs
...è
	`DEBUG_PRINT
("om±e¡: " fmt, ##¬gs)

	)

12 
	#INFO
(
fmt
, 
¬gs
...è
	`INFO_PRINT
("om±e¡: " fmt, ##¬gs)

	)

18 
	#MAXN
 100

	)

19 
	gN
;

20 
	g´ocs
;

23 vŞ©
	gA
[
MAXN
][MAXN], 
	gB
[MAXN], 
	gX
[MAXN];

28 
gauss
();

34 
	$š™Ÿlize_šputs
() {

35 
row
, 
cŞ
;

37 
	`´štf
("\nInitializing...\n");

38 
cŞ
 = 0; cŞ < 
N
; col++) {

39 
row
 = 0;„ow < 
N
;„ow++) {

40 
A
[
row
][
cŞ
] = () (col+row) / 32768.0;

42 
B
[
cŞ
] = ()(col)/ 32768.0;

43 
X
[
cŞ
] = 0.0;

46 
	}
}

49 
	$´št_šputs
() {

50 
row
, 
cŞ
;

52 ià(
N
 < 10) {

53 
	`´štf
("\nA =\n\t");

54 
row
 = 0;„ow < 
N
;„ow++) {

55 
cŞ
 = 0; cŞ < 
N
; col++) {

56 
	`´štf
("%5.2f%s", 
A
[
row
][
cŞ
], (cŞ < 
N
-1) ? ", " : ";\n\t");

59 
	`´štf
("\nB = [");

60 
cŞ
 = 0; cŞ < 
N
; col++) {

61 
	`´štf
("%5.2f%s", 
B
[
cŞ
], (cŞ < 
N
-1) ? "; " : "]\n");

64 
	}
}

68 
	gdÚeæag
[
MAXN
] = {0};

69 
±h»ad_mu‹x_t
 
	glock
;

70 *
ÿl_z”o
(* 
th»adid
);

74 
	$š™Ÿlize_šputs
() {

75 
row
, 
cŞ
;

77 
	`´štf
("\nInitializing...\n");

78 
cŞ
 = 0; cŞ < 
N
; col++) {

79 
row
 = 0;„ow < 
N
;„ow++) {

80 
A
[
row
][
cŞ
] = ()
	`¿nd
() / 32768.0;

82 
B
[
cŞ
] = ()
	`¿nd
() / 32768.0;

83 
X
[
cŞ
] = 0.0;

86 
	}
}

89 
	$´št_šputs
() {

90 
row
, 
cŞ
;

92 ià(
N
 < 10) {

93 
	`´štf
("\nA =\n\t");

94 
row
 = 0;„ow < 
N
;„ow++) {

95 
cŞ
 = 0; cŞ < 
N
; col++) {

96 
	`´štf
("%5.2f%s", 
A
[
row
][
cŞ
], (cŞ < 
N
-1) ? ", " : ";\n\t");

99 
	`´štf
("\nB = [");

100 
cŞ
 = 0; cŞ < 
N
; col++) {

101 
	`´štf
("%5.2f%s", 
B
[
cŞ
], (cŞ < 
N
-1) ? "; " : "]\n");

104 
	}
}

106 
	$gauss
() {

107 
nÜm
, 
row
, 
cŞ
;

109 
muÉl›r
;

110 
numth»ads
 = 
N
-1;

111 
dÚeæag
[0] = 1;

112 
±h»ad_t
 
th»ads
[
´ocs
];

113 
	`´štf
("Computing Using Pthread\n");

114 
	`±h»ad_mu‹x_š™
(&
lock
,
NULL
);;

118 
i
=0; i < 
´ocs
; i++)

120 
	`±h»ad_ü—‹
(&
th»ads
[
i
],
NULL
,&
ÿl_z”o
, (*)i);

123 
i
=0; i < 
´ocs
; i++)

125 
	`±h»ad_još
(
th»ads
[
i
], 
NULL
);

128 
row
 = 
N
 - 1;„ow >= 0;„ow--) {

129 
X
[
row
] = 
B
[row];

130 
cŞ
 = 
N
-1; cŞ > 
row
; col--) {

131 
X
[
row
] -ğ
A
[row][
cŞ
] * X[col];

133 
X
[
row
] /ğ
A
[row][row];

135 
	}
}

138 *
	$ÿl_z”o
(* 
th»adid
) {

139 
id
 = (è
th»adid
;

140 
muÉl›r
;

141 
nÜm
 = 0;‚Üm < 
N
-1 ;‚orm++){

145 
	`±h»ad_mu‹x_lock
(&
lock
);

147 ifĞ
dÚeæag
[
nÜm
] == 1){

148 
	`±h»ad_mu‹x_uÆock
(&
lock
);

151 
	`±h»ad_mu‹x_uÆock
(&
lock
);

152 
	`±h»ad_y›ld
();

155 
row
 = 
id
;„ow < 
N
;„ow+=
´ocs
){

156 if(
row
 <ğ
nÜm
)

158 
muÉl›r
 = 
A
[
row
][
nÜm
] / A[norm][‚orm];

159 
cŞ
 = 
nÜm
; cŞ < 
N
; col++) {

160 
A
[
row
][
cŞ
] -ğA[
nÜm
][cŞ] * 
muÉl›r
;

162 
B
[
row
] -ğB[
nÜm
] * 
muÉl›r
;

164 if(
row
 =ğ
nÜm
+1 ){

166 
	`±h»ad_mu‹x_lock
(&
lock
);

169 
dÚeæag
[
nÜm
+1] = 1;

170 
	`±h»ad_mu‹x_uÆock
(&
lock
);

174 
	}
}

178 
	$hªdË_om±e¡
 (* 
buf
, * 
´iv
)

182 
	}
}

185 
sh–l_cmd_im¶
 
	gom±e¡_im¶
 = {

186 .
cmd
 = "omptest",

187 .
	gh–p_¡r
 = "openmpest",

188 .
	ghªdËr
 = 
hªdË_om±e¡
,

190 
nk_»gi¡”_sh–l_cmd
(
om±e¡_im¶
);

	@sched.h

51 #iâdeà
_SCHED_H


52 
	#_SCHED_H


	)

54 
	~"nk/±e_ty³s.h
"

56 #undeà
PTE_LEVEL


58 #ià
defšed
(
_POSIX_SOURCE
)

59 
	#PTE_LEVEL
 0

	)

63 #ià
defšed
(
_POSIX_C_SOURCE
) && _POSIX_C_SOURCE >= 199309

64 #undeà
PTE_LEVEL


65 
	#PTE_LEVEL
 1

	)

69 #ià
defšed
(
INCLUDE_NP
)

70 #undeà
PTE_LEVEL


71 
	#PTE_LEVEL
 2

	)

75 
	#PTE_LEVEL_MAX
 3

	)

77 #ià!
defšed
(
PTE_LEVEL
)

78 
	#PTE_LEVEL
 
PTE_LEVEL_MAX


	)

90 
	mSCHED_OTHER
 = 0,

91 
	mSCHED_FIFO
,

92 
	mSCHED_RR
,

93 
	mSCHED_MIN
 = 
SCHED_OTHER
,

94 
	mSCHED_MAX
 = 
SCHED_RR


97 
	ssched_·¿m


99 
	msched_´iÜ™y
;

102 #ifdeà
__ılu¥lus


107 
sched_y›ld
 ();

109 
sched_g‘_´iÜ™y_mš
 (
pŞicy
);

111 
sched_g‘_´iÜ™y_max
 (
pŞicy
);

113 
sched_£tscheduËr
 (
pid_t
 
pid
, 
pŞicy
);

125 
	#sched_¼_g‘_š‹rv®
(
_pid
, 
_š‹rv®
) \

126 Ğ
”ºo
 = 
ENOTSUP
, (è-1 )

	)

129 #ifdeà
__ılu¥lus


133 #undeà
PTE_LEVEL


134 #undeà
PTE_LEVEL_MAX


	@sched_get_priority_max.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$sched_g‘_´iÜ™y_max
 (
pŞicy
)

50  
	`±e_osTh»adG‘MaxPriÜ™y
();

51 
	}
}

	@sched_get_priority_min.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$sched_g‘_´iÜ™y_mš
 (
pŞicy
)

50  
	`±e_osTh»adG‘MšPriÜ™y
();

51 
	}
}

	@sched_setscheduler.c

43 
	~"±h»ad.h
"

44 
	~"im¶em’t.h
"

45 
	~"sched.h
"

48 
	$sched_£tscheduËr
 (
pid_t
 
pid
, 
pŞicy
)

50 
”ºo
 = 
EPERM
;

52 
	}
}

	@sched_yield.c

45 
	~<Çutus/Çutus.h
>

46 
	~"nk/±e_o§l.h
"

48 
	~"±h»ad.h
"

49 
	~"im¶em’t.h
"

50 
	~"sched.h
"

53 
	$sched_y›ld
 ()

79 
	`±e_osTh»adSË•
 (1);

82 
	}
}

	@sem_close.c

50 
	~"±h»ad.h
"

51 
	~"£m­hÜe.h
"

52 
	~"im¶em’t.h
"

56 
	$£m_şo£
 (
£m_t
 * 
£m
)

58 
”ºo
 = 
ENOSYS
;

60 
	}
}

	@sem_destroy.c

52 
	~<Çutus/Çutus.h
>

53 
	~"nk/±e_o§l.h
"

55 
	~"±h»ad.h
"

56 
	~"£m­hÜe.h
"

57 
	~"im¶em’t.h
"

61 
	$£m_de¡roy
 (
£m_t
 * 
£m
)

86 
»suÉ
 = 0;

87 
£m_t
 
s
 = 
NULL
;

89 ià(
£m
 =ğ
NULL
 || *sem == NULL)

91 
»suÉ
 = 
EINVAL
;

95 
s
 = *
£m
;

97 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&
s
->
lock
)) == 0)

99 ià(
s
->
v®ue
 < 0)

101 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

102 
»suÉ
 = 
EBUSY
;

107 
±e_osResuÉ
 
osResuÉ
 = 
	`±e_osSem­hÜeD–‘e
(
s
->
£m
);

109 ià(
osResuÉ
 !ğ
PTE_OS_OK
)

111 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

112 
»suÉ
 = 
EINVAL
;

124 *
£m
 = 
NULL
;

128 
s
->
v®ue
 = 
SEM_VALUE_MAX
;

130 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

138 
	`±e_osTh»adSË•
(1);

140 
	`±h»ad_mu‹x_de¡roy
 (&
s
->
lock
è=ğ
EBUSY
);

146 ià(
»suÉ
 != 0)

148 
”ºo
 = 
»suÉ
;

152 
	`ä“
 (
s
);

156 
	}
}

	@sem_getvalue.c

50 
	~"±h»ad.h
"

51 
	~"£m­hÜe.h
"

52 
	~"im¶em’t.h
"

56 
	$£m_g‘v®ue
 (
£m_t
 * 
£m
, *
sv®
)

86 ià(
£m
 =ğ
NULL
 || *£m =ğNULL || 
sv®
 == NULL)

88 
”ºo
 = 
EINVAL
;

93 
v®ue
;

94 
£m_t
 
s
 = *
£m
;

95 
»suÉ
 = 0;

97 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
(&
s
->
lock
)) == 0)

101 ià(*
£m
 =ğ
NULL
)

103 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

104 
”ºo
 = 
EINVAL
;

108 
v®ue
 = 
s
->value;

109 (è
	`±h»ad_mu‹x_uÆock
(&
s
->
lock
);

110 *
sv®
 = 
v®ue
;

113  
»suÉ
;

116 
	}
}

	@sem_init.c

44 
	~<Çutus/Çutus.h
>

45 
	~"±h»ad.h
"

46 
	~"£m­hÜe.h
"

47 
	~"im¶em’t.h
"

51 
	$£m_š™
 (
£m_t
 * 
£m
, 
psh¬ed
, 
v®ue
)

89 
»suÉ
 = 0;

90 
£m_t
 
s
 = 
NULL
;

93 ià(
psh¬ed
 != 0)

99 
»suÉ
 = 
EPERM
;

101 ià(
v®ue
 > ()
SEM_VALUE_MAX
)

103 
»suÉ
 = 
EINVAL
;

107 
s
 = (
£m_t
è
	`ÿÎoc
 (1,  (*s));

109 ià(
NULL
 =ğ
s
)

111 
»suÉ
 = 
ENOMEM
;

116 
s
->
v®ue
 = value;

117 ià(
	`±h»ad_mu‹x_š™
(&
s
->
lock
, 
NULL
) == 0)

120 
±e_osResuÉ
 
osResuÉ
 = 
	`±e_osSem­hÜeC»©e
(0, &
s
->
£m
);

124 ià(
osResuÉ
 !ğ
PTE_OS_OK
)

126 (è
	`±h»ad_mu‹x_de¡roy
(&
s
->
lock
);

127 
»suÉ
 = 
ENOSPC
;

133 
»suÉ
 = 
ENOSPC
;

136 ià(
»suÉ
 != 0)

138 
	`ä“
(
s
);

143 ià(
»suÉ
 != 0)

145 
”ºo
 = 
»suÉ
;

149 *
£m
 = 
s
;

153 
	}
}

	@sem_open.c

50 
	~"±h»ad.h
"

51 
	~"£m­hÜe.h
"

52 
	~"im¶em’t.h
"

56 
	$£m_İ’
 (cÚ¡ *
Çme
, 
oæag
, 
mode_t
 
mode
, 
v®ue
)

58 
”ºo
 = 
ENOSYS
;

60 
	}
}

	@sem_post.c

52 
	~<Çutus/Çutus.h
>

53 
	~"±h»ad.h
"

54 
	~"£m­hÜe.h
"

55 
	~"im¶em’t.h
"

59 
	$£m_po¡
 (
£m_t
 * 
£m
)

85 
»suÉ
 = 0;

86 
£m_t
 
s
 = *
£m
;

88 ià(
s
 =ğ
NULL
)

90 
»suÉ
 = 
EINVAL
;

92 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&
s
->
lock
)) == 0)

96 ià(*
£m
 =ğ
NULL
)

98 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

99 
»suÉ
 = 
EINVAL
;

103 ià(
s
->
v®ue
 < 
SEM_VALUE_MAX
)

105 
±e_osResuÉ
 
osResuÉ
 = 
	`±e_osSem­hÜePo¡
(
s
->
£m
, 1);

107 ià(++
s
->
v®ue
 <= 0

108 && (
osResuÉ
 !ğ
PTE_OS_OK
))

110 
s
->
v®ue
--;

111 
»suÉ
 = 
EINVAL
;

117 
»suÉ
 = 
ERANGE
;

120 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

123 ià(
»suÉ
 != 0)

125 
”ºo
 = 
»suÉ
;

131 
	}
}

	@sem_post_multiple.c

52 
	~<Çutus/Çutus.h
>

53 
	~"±h»ad.h
"

54 
	~"£m­hÜe.h
"

55 
	~"im¶em’t.h
"

59 
	$£m_po¡_muÉË
 (
£m_t
 * 
£m
, 
couÁ
)

88 
»suÉ
 = 0;

89 
wa™”s
;

90 
£m_t
 
s
 = *
£m
;

92 ià(
s
 =ğ
NULL
 || 
couÁ
 <= 0)

94 
»suÉ
 = 
EINVAL
;

96 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&
s
->
lock
)) == 0)

100 ià(*
£m
 =ğ
NULL
)

102 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

103 
»suÉ
 = 
EINVAL
;

107 ià(
s
->
v®ue
 <ğ(
SEM_VALUE_MAX
 - 
couÁ
))

109 
wa™”s
 = -
s
->
v®ue
;

110 
s
->
v®ue
 +ğ
couÁ
;

111 ià(
wa™”s
 > 0)

114 
	`±e_osSem­hÜePo¡
(
s
->
£m
, (
wa™”s
<=
couÁ
)?waiters:count);

115 
»suÉ
 = 0;

127 
»suÉ
 = 
ERANGE
;

130 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

133 ià(
»suÉ
 != 0)

135 
”ºo
 = 
»suÉ
;

141 
	}
}

	@sem_timedwait.c

52 
	~<Çutus/Çutus.h
>

53 
	~"±h»ad.h
"

54 
	~"£m­hÜe.h
"

55 
	~"im¶em’t.h
"

59 
£m_t
 
	m£m
;

60 * 
	m»suÉPŒ
;

61 } 
	t£m_timedwa™_ş—nup_¬gs_t
;

64 
	$±e_£m_timedwa™_ş—nup
 (* 
¬gs
)

66 
£m_timedwa™_ş—nup_¬gs_t
 * 
a
 = (£m_timedwa™_ş—nup_¬gs_ˆ*)
¬gs
;

67 
£m_t
 
s
 = 
a
->
£m
;

69 ià(
	`±h»ad_mu‹x_lock
 (&
s
->
lock
) == 0)

79 
timeout
 = 0;

80 ià(
	`±e_osSem­hÜeP’d
(
s
->
£m
, &
timeout
è=ğ
PTE_OS_OK
)

83 *(
a
->
»suÉPŒ
) = 0;

88 
s
->
v®ue
++;

96 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

98 
	}
}

102 
	$£m_timedwa™
 (
£m_t
 * 
£m
, cÚ¡ 
time¥ec
 *
ab¡ime
)

141 
»suÉ
 = 0;

142 
£m_t
 
s
 = *
£m
;

145 
	`±h»ad_‹¡ÿnûl
();

147 ià(
£m
 =ğ
NULL
)

149 
»suÉ
 = 
EINVAL
;

153 
mli£cÚds
;

154 *
pTimeout
;

156 ià(
ab¡ime
 =ğ
NULL
)

158 
pTimeout
 = 
NULL
;

165 
mli£cÚds
 = 
	`±e_»lmli£cs
 (
ab¡ime
);

166 
pTimeout
 = &
mli£cÚds
;

169 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&
s
->
lock
)) == 0)

171 
v
;

175 ià(*
£m
 =ğ
NULL
)

177 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

178 
”ºo
 = 
EINVAL
;

182 
v
 = --
s
->
v®ue
;

183 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

185 ià(
v
 < 0)

189 
£m_timedwa™_ş—nup_¬gs_t
 
ş—nup_¬gs
;

191 
ş—nup_¬gs
.
£m
 = 
s
;

192 
ş—nup_¬gs
.
»suÉPŒ
 = &
»suÉ
;

195 
	`±h»ad_ş—nup_push
(
±e_£m_timedwa™_ş—nup
, (*è&
ş—nup_¬gs
);

197 
»suÉ
 = 
	`±e_ÿnûÎabË_wa™
(
s
->
£m
,
pTimeout
);

199 
	`±h»ad_ş—nup_pİ
(
»suÉ
);

206 ià(
»suÉ
 != 0)

209 
”ºo
 = 
»suÉ
;

216 
	}
}

	@sem_trywait.c

50 
	~"±h»ad.h
"

51 
	~"£m­hÜe.h
"

52 
	~"im¶em’t.h
"

56 
	$£m_Œywa™
 (
£m_t
 * 
£m
)

85 
»suÉ
 = 0;

86 
£m_t
 
s
 = *
£m
;

88 ià(
s
 =ğ
NULL
)

90 
»suÉ
 = 
EINVAL
;

92 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&
s
->
lock
)) == 0)

96 ià(*
£m
 =ğ
NULL
)

98 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

99 
”ºo
 = 
EINVAL
;

103 ià(
s
->
v®ue
 > 0)

105 
s
->
v®ue
--;

109 
»suÉ
 = 
EAGAIN
;

112 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

115 ià(
»suÉ
 != 0)

117 
”ºo
 = 
»suÉ
;

123 
	}
}

	@sem_unlink.c

50 
	~"±h»ad.h
"

51 
	~"£m­hÜe.h
"

52 
	~"im¶em’t.h
"

56 
	$£m_uÆšk
 (cÚ¡ *
Çme
)

58 
”ºo
 = 
ENOSYS
;

60 
	}
}

	@sem_wait.c

52 
	~<Çutus/Çutus.h
>

53 
	~"±h»ad.h
"

54 
	~"£m­hÜe.h
"

55 
	~"im¶em’t.h
"

59 
	$±e_£m_wa™_ş—nup
(* 
£m
)

61 
£m_t
 
s
 = (£m_tè
£m
;

62 
timeout
;

64 ià(
	`±h»ad_mu‹x_lock
 (&
s
->
lock
) == 0)

73 
timeout
 = 0;

74 ià(
	`±e_osSem­hÜeP’d
(
s
->
£m
, &
timeout
è!ğ
PTE_OS_OK
)

76 ++
s
->
v®ue
;

84 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

86 
	}
}

90 
	$£m_wa™
 (
£m_t
 * 
£m
)

120 
»suÉ
 = 0;

121 
£m_t
 
s
 = *
£m
;

123 
	`±h»ad_‹¡ÿnûl
();

125 ià(
s
 =ğ
NULL
)

127 
»suÉ
 = 
EINVAL
;

131 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&
s
->
lock
)) == 0)

133 
v
;

137 ià(*
£m
 =ğ
NULL
)

139 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

140 
”ºo
 = 
EINVAL
;

144 
v
 = --
s
->
v®ue
;

145 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

147 ià(
v
 < 0)

150 
	`±h»ad_ş—nup_push
(
±e_£m_wa™_ş—nup
, (*è
s
);

151 
»suÉ
 = 
	`±e_ÿnûÎabË_wa™
(
s
->
£m
,
NULL
);

153 
	`±h»ad_ş—nup_pİ
(
»suÉ
);

168 ià(
»suÉ
 != 0)

170 
”ºo
 = 
»suÉ
;

176 
	}
}

180 
	$£m_wa™_noÿnûl
 (
£m_t
 * 
£m
)

211 
»suÉ
 = 0;

212 
£m_t
 
s
 = *
£m
;

214 
	`±h»ad_‹¡ÿnûl
();

216 ià(
s
 =ğ
NULL
)

218 
»suÉ
 = 
EINVAL
;

222 ià((
»suÉ
 = 
	`±h»ad_mu‹x_lock
 (&
s
->
lock
)) == 0)

224 
v
;

228 ià(*
£m
 =ğ
NULL
)

230 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

231 
”ºo
 = 
EINVAL
;

235 
v
 = --
s
->
v®ue
;

236 (è
	`±h»ad_mu‹x_uÆock
 (&
s
->
lock
);

238 ià(
v
 < 0)

240 
	`±e_osSem­hÜeP’d
(
s
->
£m
, 
NULL
);

246 ià(
»suÉ
 != 0)

248 
”ºo
 = 
»suÉ
;

254 
	}
}

	@semaphore.h

52 #ià!
defšed
Ğ
SEMAPHORE_H
 )

53 
	#SEMAPHORE_H


	)

55 #ià
defšed
(
_POSIX_SOURCE
)

56 
	#PTE_LEVEL
 0

	)

60 #ià
defšed
(
INCLUDE_NP
)

61 #undeà
PTE_LEVEL


62 
	#PTE_LEVEL
 2

	)

70 
	#_POSIX_SEMAPHORES


	)

72 #ifdeà
__ılu¥lus


78 
£m_t_
 * 
	t£m_t
;

80 
£m_š™
 (
£m_t
 * 
£m
,

81 
psh¬ed
,

82 
v®ue
);

84 
£m_de¡roy
 (
£m_t
 * 
£m
);

86 
£m_Œywa™
 (
£m_t
 * 
£m
);

88 
£m_wa™
 (
£m_t
 * 
£m
);

90 
£m_timedwa™
 (
£m_t
 * 
£m
,

91 cÚ¡ 
time¥ec
 * 
ab¡ime
);

93 
£m_po¡
 (
£m_t
 * 
£m
);

95 
£m_po¡_muÉË
 (
£m_t
 * 
£m
,

96 
couÁ
);

98 
£m_İ’
 (cÚ¡ * 
Çme
,

99 
oæag
,

100 
mode_t
 
mode
,

101 
v®ue
);

103 
£m_şo£
 (
£m_t
 * 
£m
);

105 
£m_uÆšk
 (cÚ¡ * 
Çme
);

107 
£m_g‘v®ue
 (
£m_t
 * 
£m
,

108 * 
sv®
);

110 #ifdeà
__ılu¥lus


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

42 #iâdeà
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<b™s/wÜdsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifdeà
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #ià
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #ià
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifdeà
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


124 #šşude_Ãxˆ<
lim™s
.
h
>

130 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


131 #iâdeà
LLONG_MIN


132 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

134 #iâdeà
LLONG_MAX


135 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

137 #iâdeà
ULLONG_MAX


138 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

145 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

146 #iâdeà
CHAR_WIDTH


147 
	#CHAR_WIDTH
 8

	)

149 #iâdeà
SCHAR_WIDTH


150 
	#SCHAR_WIDTH
 8

	)

152 #iâdeà
UCHAR_WIDTH


153 
	#UCHAR_WIDTH
 8

	)

155 #iâdeà
SHRT_WIDTH


156 
	#SHRT_WIDTH
 16

	)

158 #iâdeà
USHRT_WIDTH


159 
	#USHRT_WIDTH
 16

	)

161 #iâdeà
INT_WIDTH


162 
	#INT_WIDTH
 32

	)

164 #iâdeà
UINT_WIDTH


165 
	#UINT_WIDTH
 32

	)

167 #iâdeà
LONG_WIDTH


168 
	#LONG_WIDTH
 
__WORDSIZE


	)

170 #iâdeà
ULONG_WIDTH


171 
	#ULONG_WIDTH
 
__WORDSIZE


	)

173 #iâdeà
LLONG_WIDTH


174 
	#LLONG_WIDTH
 64

	)

176 #iâdeà
ULLONG_WIDTH


177 
	#ULLONG_WIDTH
 64

	)

181 #ifdef 
__USE_POSIX


183 
	~<b™s/posix1_lim.h
>

186 #ifdef 
__USE_POSIX2


187 
	~<b™s/posix2_lim.h
>

190 #ifdef 
__USE_XOPEN


191 
	~<b™s/xİ’_lim.h
>

	@
1
.
1
/usr/include
139
3038
cleanup.c
create.c
global.c
implement.h
need_errno.h
nk/nk_osal.c
nk/pte_generic_osal.h
nk/pte_osal.h
nk/pte_types.h
nk_generic_oasl.c
omptest.c
pte_callUserDestroyRoutines.c
pte_cancellable_wait.c
pte_cond_check_need_init.c
pte_detach.c
pte_generic_osal.h
pte_getprocessors.c
pte_is_attr.c
pte_mutex_check_need_init.c
pte_new.c
pte_relmillisecs.c
pte_reuse.c
pte_rwlock_cancelwrwait.c
pte_rwlock_check_need_init.c
pte_spinlock_check_need_init.c
pte_threadDestroy.c
pte_threadStart.c
pte_throw.c
pte_tkAssocCreate.c
pte_tkAssocDestroy.c
pthread.h
pthread_attr_destroy.c
pthread_attr_getdetachstate.c
pthread_attr_getinheritsched.c
pthread_attr_getschedparam.c
pthread_attr_getschedpolicy.c
pthread_attr_getscope.c
pthread_attr_getstack.c
pthread_attr_getstackaddr.c
pthread_attr_getstacksize.c
pthread_attr_init.c
pthread_attr_setdetachstate.c
pthread_attr_setinheritsched.c
pthread_attr_setschedparam.c
pthread_attr_setschedpolicy.c
pthread_attr_setscope.c
pthread_attr_setstackaddr.c
pthread_attr_setstacksize.c
pthread_barrier_destroy.c
pthread_barrier_init.c
pthread_barrier_wait.c
pthread_barrierattr_destroy.c
pthread_barrierattr_getpshared.c
pthread_barrierattr_init.c
pthread_barrierattr_setpshared.c
pthread_cancel.c
pthread_cond_destroy.c
pthread_cond_init.c
pthread_cond_signal.c
pthread_cond_wait.c
pthread_condattr_destroy.c
pthread_condattr_getpshared.c
pthread_condattr_init.c
pthread_condattr_setpshared.c
pthread_delay_np.c
pthread_detach.c
pthread_equal.c
pthread_exit.c
pthread_getattr_np.c
pthread_getconcurrency.c
pthread_getschedparam.c
pthread_getspecific.c
pthread_init.c
pthread_join.c
pthread_key_create.c
pthread_key_delete.c
pthread_kill.c
pthread_mutex_destroy.c
pthread_mutex_init.c
pthread_mutex_lock.c
pthread_mutex_timedlock.c
pthread_mutex_trylock.c
pthread_mutex_unlock.c
pthread_mutexattr_destroy.c
pthread_mutexattr_getkind_np.c
pthread_mutexattr_getpshared.c
pthread_mutexattr_gettype.c
pthread_mutexattr_init.c
pthread_mutexattr_setkind_np.c
pthread_mutexattr_setpshared.c
pthread_mutexattr_settype.c
pthread_num_processors_np.c
pthread_once.c
pthread_rwlock_destroy.c
pthread_rwlock_init.c
pthread_rwlock_rdlock.c
pthread_rwlock_timedrdlock.c
pthread_rwlock_timedwrlock.c
pthread_rwlock_tryrdlock.c
pthread_rwlock_trywrlock.c
pthread_rwlock_unlock.c
pthread_rwlock_wrlock.c
pthread_rwlockattr_destroy.c
pthread_rwlockattr_getpshared.c
pthread_rwlockattr_init.c
pthread_rwlockattr_setpshared.c
pthread_self.c
pthread_setcancelstate.c
pthread_setcanceltype.c
pthread_setconcurrency.c
pthread_setschedparam.c
pthread_setspecific.c
pthread_spin_destroy.c
pthread_spin_init.c
pthread_spin_lock.c
pthread_spin_trylock.c
pthread_spin_unlock.c
pthread_terminate.c
pthread_testcancel.c
pthread_timechange_handler_np.c
pthreadtest.c
sched.h
sched_get_priority_max.c
sched_get_priority_min.c
sched_setscheduler.c
sched_yield.c
sem_close.c
sem_destroy.c
sem_getvalue.c
sem_init.c
sem_open.c
sem_post.c
sem_post_multiple.c
sem_timedwait.c
sem_trywait.c
sem_unlink.c
sem_wait.c
semaphore.h
/usr/include/limits.h
